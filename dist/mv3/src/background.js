!function(){"use strict";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function n(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var t={exports:{}};t.exports=function(){
/*! *****************************************************************************
	    Copyright (c) Microsoft Corporation.
	    Permission to use, copy, modify, and/or distribute this software for any
	    purpose with or without fee is hereby granted.
	    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	    PERFORMANCE OF THIS SOFTWARE.
	    ***************************************************************************** */
var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])},n(e,t)};function t(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var r=function(){return r=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},r.apply(this,arguments)};function i(e,n,t){if(t||2===arguments.length)for(var r,i=0,o=n.length;i<o;i++)!r&&i in n||(r||(r=Array.prototype.slice.call(n,0,i)),r[i]=n[i]);return e.concat(r||Array.prototype.slice.call(n))}var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:e,a=Object.keys,u=Array.isArray;function s(e,n){return"object"!=typeof n||a(n).forEach((function(t){e[t]=n[t]})),e}"undefined"==typeof Promise||o.Promise||(o.Promise=Promise);var c=Object.getPrototypeOf,l={}.hasOwnProperty;function f(e,n){return l.call(e,n)}function h(e,n){"function"==typeof n&&(n=n(c(e))),("undefined"==typeof Reflect?a:Reflect.ownKeys)(n).forEach((function(t){d(e,t,n[t])}))}var p=Object.defineProperty;function d(e,n,t,r){p(e,n,s(t&&f(t,"get")&&"function"==typeof t.get?{get:t.get,set:t.set,configurable:!0}:{value:t,configurable:!0,writable:!0},r))}function v(e){return{from:function(n){return e.prototype=Object.create(n.prototype),d(e.prototype,"constructor",e),{extend:h.bind(null,e.prototype)}}}}var y=Object.getOwnPropertyDescriptor;function m(e,n){var t;return y(e,n)||(t=c(e))&&m(t,n)}var g=[].slice;function b(e,n,t){return g.call(e,n,t)}function w(e,n){return n(e)}function _(e){if(!e)throw new Error("Assertion Failed")}function x(e){o.setImmediate?setImmediate(e):setTimeout(e,0)}function k(e,n){return e.reduce((function(e,t,r){var i=n(t,r);return i&&(e[i[0]]=i[1]),e}),{})}function C(e,n){if("string"==typeof n&&f(e,n))return e[n];if(!n)return e;if("string"!=typeof n){for(var t=[],r=0,i=n.length;r<i;++r){var o=C(e,n[r]);t.push(o)}return t}var a=n.indexOf(".");if(-1!==a){var u=e[n.substr(0,a)];return null==u?void 0:C(u,n.substr(a+1))}}function S(e,n,t){if(e&&void 0!==n&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if("string"!=typeof n&&"length"in n){_("string"!=typeof t&&"length"in t);for(var r=0,i=n.length;r<i;++r)S(e,n[r],t[r])}else{var o=n.indexOf(".");if(-1!==o){var a=n.substr(0,o),s=n.substr(o+1);if(""===s)void 0===t?u(e)&&!isNaN(parseInt(a))?e.splice(a,1):delete e[a]:e[a]=t;else{var c=e[a];c&&f(e,a)||(c=e[a]={}),S(c,s,t)}}else void 0===t?u(e)&&!isNaN(parseInt(n))?e.splice(n,1):delete e[n]:e[n]=t}}function O(e,n){"string"==typeof n?S(e,n,void 0):"length"in n&&[].map.call(n,(function(n){S(e,n,void 0)}))}function A(e){var n={};for(var t in e)f(e,t)&&(n[t]=e[t]);return n}var P=[].concat;function E(e){return P.apply([],e)}var j="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(E([8,16,32,64].map((function(e){return["Int","Uint","Float"].map((function(n){return n+e+"Array"}))})))).filter((function(e){return o[e]})),T=new Set(j.map((function(e){return o[e]})));function K(e){var n={};for(var t in e)if(f(e,t)){var r=e[t];n[t]=!r||"object"!=typeof r||T.has(r.constructor)?r:K(r)}return n}function N(e){for(var n in e)if(f(e,n))return!1;return!0}var M=null;function D(e){M=new WeakMap;var n=q(e);return M=null,n}function q(e){if(!e||"object"!=typeof e)return e;var n=M.get(e);if(n)return n;if(u(e)){n=[],M.set(e,n);for(var t=0,r=e.length;t<r;++t)n.push(q(e[t]))}else if(T.has(e.constructor))n=e;else{var i=c(e);for(var o in n=i===Object.prototype?{}:Object.create(i),M.set(e,n),e)f(e,o)&&(n[o]=q(e[o]))}return n}var I={}.toString;function F(e){return I.call(e).slice(8,-1)}var R="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator",L="symbol"==typeof R?function(e){var n;return null!=e&&(n=e[R])&&n.apply(e)}:function(){return null};function z(e,n){var t=e.indexOf(n);return t>=0&&e.splice(t,1),t>=0}var B={};function U(e){var n,t,r,i;if(1===arguments.length){if(u(e))return e.slice();if(this===B&&"string"==typeof e)return[e];if(i=L(e)){for(t=[];!(r=i.next()).done;)t.push(r.value);return t}if(null==e)return[e];if("number"==typeof(n=e.length)){for(t=new Array(n);n--;)t[n]=e[n];return t}return[e]}for(n=arguments.length,t=new Array(n);n--;)t[n]=arguments[n];return t}var H="undefined"!=typeof Symbol?function(e){return"AsyncFunction"===e[Symbol.toStringTag]}:function(){return!1},$=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],W=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat($),V={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function J(e,n){this.name=e,this.message=n}function Y(e,n){return e+". Errors: "+Object.keys(n).map((function(e){return n[e].toString()})).filter((function(e,n,t){return t.indexOf(e)===n})).join("\n")}function G(e,n,t,r){this.failures=n,this.failedKeys=r,this.successCount=t,this.message=Y(e,n)}function Q(e,n){this.name="BulkError",this.failures=Object.keys(n).map((function(e){return n[e]})),this.failuresByPos=n,this.message=Y(e,this.failures)}v(J).from(Error).extend({toString:function(){return this.name+": "+this.message}}),v(G).from(J),v(Q).from(J);var X=W.reduce((function(e,n){return e[n]=n+"Error",e}),{}),Z=J,ee=W.reduce((function(e,n){var t=n+"Error";function r(e,r){this.name=t,e?"string"==typeof e?(this.message="".concat(e).concat(r?"\n "+r:""),this.inner=r||null):"object"==typeof e&&(this.message="".concat(e.name," ").concat(e.message),this.inner=e):(this.message=V[n]||t,this.inner=null)}return v(r).from(Z),e[n]=r,e}),{});ee.Syntax=SyntaxError,ee.Type=TypeError,ee.Range=RangeError;var ne=$.reduce((function(e,n){return e[n+"Error"]=ee[n],e}),{});function te(e,n){if(!e||e instanceof J||e instanceof TypeError||e instanceof SyntaxError||!e.name||!ne[e.name])return e;var t=new ne[e.name](n||e.message,e);return"stack"in e&&d(t,"stack",{get:function(){return this.inner.stack}}),t}var re=W.reduce((function(e,n){return-1===["Syntax","Type","Range"].indexOf(n)&&(e[n+"Error"]=ee[n]),e}),{});function ie(){}function oe(e){return e}function ae(e,n){return null==e||e===oe?n:function(t){return n(e(t))}}function ue(e,n){return function(){e.apply(this,arguments),n.apply(this,arguments)}}function se(e,n){return e===ie?n:function(){var t=e.apply(this,arguments);void 0!==t&&(arguments[0]=t);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=n.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?ue(r,this.onsuccess):r),i&&(this.onerror=this.onerror?ue(i,this.onerror):i),void 0!==o?o:t}}function ce(e,n){return e===ie?n:function(){e.apply(this,arguments);var t=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,n.apply(this,arguments),t&&(this.onsuccess=this.onsuccess?ue(t,this.onsuccess):t),r&&(this.onerror=this.onerror?ue(r,this.onerror):r)}}function le(e,n){return e===ie?n:function(t){var r=e.apply(this,arguments);s(t,r);var i=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var a=n.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?ue(i,this.onsuccess):i),o&&(this.onerror=this.onerror?ue(o,this.onerror):o),void 0===r?void 0===a?void 0:a:s(r,a)}}function fe(e,n){return e===ie?n:function(){return!1!==n.apply(this,arguments)&&e.apply(this,arguments)}}function he(e,n){return e===ie?n:function(){var t=e.apply(this,arguments);if(t&&"function"==typeof t.then){for(var r=this,i=arguments.length,o=new Array(i);i--;)o[i]=arguments[i];return t.then((function(){return n.apply(r,o)}))}return n.apply(this,arguments)}}re.ModifyError=G,re.DexieError=J,re.BulkError=Q;var pe="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function de(e,n){pe=e}var ve={},ye=100,me="undefined"==typeof Promise?[]:function(){var e=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[e,c(e),e];var n=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[n,c(n),e]}(),ge=me[0],be=me[1],we=me[2],_e=be&&be.then,xe=ge&&ge.constructor,ke=!!we;function Ce(){queueMicrotask(He)}var Se=function(e,n){Ne.push([e,n]),Ae&&(Ce(),Ae=!1)},Oe=!0,Ae=!0,Pe=[],Ee=[],je=oe,Te={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ie,pgp:!1,env:{},finalize:ie},Ke=Te,Ne=[],Me=0,De=[];function qe(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var n=this._PSD=Ke;if("function"!=typeof e){if(e!==ve)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&Le(this,this._value))}this._state=null,this._value=null,++n.ref,Re(this,e)}var Ie={get:function(){var e=Ke,n=rn;function t(t,r){var i=this,o=!e.global&&(e!==Ke||n!==rn),a=o&&!sn(),u=new qe((function(n,u){Be(i,new Fe(vn(t,e,o,a),vn(r,e,o,a),n,u,e))}));return this._consoleTask&&(u._consoleTask=this._consoleTask),u}return t.prototype=ve,t},set:function(e){d(this,"then",e&&e.prototype===ve?Ie:{get:function(){return e},set:Ie.set})}};function Fe(e,n,t,r,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof n?n:null,this.resolve=t,this.reject=r,this.psd=i}function Re(e,n){try{n((function(n){if(null===e._state){if(n===e)throw new TypeError("A promise cannot be resolved with itself.");var t=e._lib&&$e();n&&"function"==typeof n.then?Re(e,(function(e,t){n instanceof qe?n._then(e,t):n.then(e,t)})):(e._state=!0,e._value=n,ze(e)),t&&We()}}),Le.bind(null,e))}catch(n){Le(e,n)}}function Le(e,n){if(Ee.push(n),null===e._state){var t=e._lib&&$e();n=je(n),e._state=!1,e._value=n,Ye(e),ze(e),t&&We()}}function ze(e){var n=e._listeners;e._listeners=[];for(var t=0,r=n.length;t<r;++t)Be(e,n[t]);var i=e._PSD;--i.ref||i.finalize(),0===Me&&(++Me,Se((function(){0==--Me&&Ve()}),[]))}function Be(e,n){if(null!==e._state){var t=e._state?n.onFulfilled:n.onRejected;if(null===t)return(e._state?n.resolve:n.reject)(e._value);++n.psd.ref,++Me,Se(Ue,[t,e,n])}else e._listeners.push(n)}function Ue(e,n,t){try{var r,i=n._value;!n._state&&Ee.length&&(Ee=[]),r=pe&&n._consoleTask?n._consoleTask.run((function(){return e(i)})):e(i),n._state||-1!==Ee.indexOf(i)||Ge(n),t.resolve(r)}catch(e){t.reject(e)}finally{0==--Me&&Ve(),--t.psd.ref||t.psd.finalize()}}function He(){dn(Te,(function(){$e()&&We()}))}function $e(){var e=Oe;return Oe=!1,Ae=!1,e}function We(){var e,n,t;do{for(;Ne.length>0;)for(e=Ne,Ne=[],t=e.length,n=0;n<t;++n){var r=e[n];r[0].apply(null,r[1])}}while(Ne.length>0);Oe=!0,Ae=!0}function Ve(){var e=Pe;Pe=[],e.forEach((function(e){e._PSD.onunhandled.call(null,e._value,e)}));for(var n=De.slice(0),t=n.length;t;)n[--t]()}function Je(e){function n(){e(),De.splice(De.indexOf(n),1)}De.push(n),++Me,Se((function(){0==--Me&&Ve()}),[])}function Ye(e){Pe.some((function(n){return n._value===e._value}))||Pe.push(e)}function Ge(e){for(var n=Pe.length;n;)if(Pe[--n]._value===e._value)return void Pe.splice(n,1)}function Qe(e){return new qe(ve,!1,e)}function Xe(e,n){var t=Ke;return function(){var r=$e(),i=Ke;try{return hn(t,!0),e.apply(this,arguments)}catch(e){n&&n(e)}finally{hn(i,!1),r&&We()}}}h(qe.prototype,{then:Ie,_then:function(e,n){Be(this,new Fe(null,null,e,n,Ke))},catch:function(e){if(1===arguments.length)return this.then(null,e);var n=arguments[0],t=arguments[1];return"function"==typeof n?this.then(null,(function(e){return e instanceof n?t(e):Qe(e)})):this.then(null,(function(e){return e&&e.name===n?t(e):Qe(e)}))},finally:function(e){return this.then((function(n){return qe.resolve(e()).then((function(){return n}))}),(function(n){return qe.resolve(e()).then((function(){return Qe(n)}))}))},timeout:function(e,n){var t=this;return e<1/0?new qe((function(r,i){var o=setTimeout((function(){return i(new ee.Timeout(n))}),e);t.then(r,i).finally(clearTimeout.bind(null,o))})):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&d(qe.prototype,Symbol.toStringTag,"Dexie.Promise"),Te.env=pn(),h(qe,{all:function(){var e=U.apply(null,arguments).map(cn);return new qe((function(n,t){0===e.length&&n([]);var r=e.length;e.forEach((function(i,o){return qe.resolve(i).then((function(t){e[o]=t,--r||n(e)}),t)}))}))},resolve:function(e){return e instanceof qe?e:e&&"function"==typeof e.then?new qe((function(n,t){e.then(n,t)})):new qe(ve,!0,e)},reject:Qe,race:function(){var e=U.apply(null,arguments).map(cn);return new qe((function(n,t){e.map((function(e){return qe.resolve(e).then(n,t)}))}))},PSD:{get:function(){return Ke},set:function(e){return Ke=e}},totalEchoes:{get:function(){return rn}},newPSD:an,usePSD:dn,scheduler:{get:function(){return Se},set:function(e){Se=e}},rejectionMapper:{get:function(){return je},set:function(e){je=e}},follow:function(e,n){return new qe((function(t,r){return an((function(n,t){var r=Ke;r.unhandleds=[],r.onunhandled=t,r.finalize=ue((function(){var e=this;Je((function(){0===e.unhandleds.length?n():t(e.unhandleds[0])}))}),r.finalize),e()}),n,t,r)}))}}),xe&&(xe.allSettled&&d(qe,"allSettled",(function(){var e=U.apply(null,arguments).map(cn);return new qe((function(n){0===e.length&&n([]);var t=e.length,r=new Array(t);e.forEach((function(e,i){return qe.resolve(e).then((function(e){return r[i]={status:"fulfilled",value:e}}),(function(e){return r[i]={status:"rejected",reason:e}})).then((function(){return--t||n(r)}))}))}))})),xe.any&&"undefined"!=typeof AggregateError&&d(qe,"any",(function(){var e=U.apply(null,arguments).map(cn);return new qe((function(n,t){0===e.length&&t(new AggregateError([]));var r=e.length,i=new Array(r);e.forEach((function(e,o){return qe.resolve(e).then((function(e){return n(e)}),(function(e){i[o]=e,--r||t(new AggregateError(i))}))}))}))})));var Ze={awaits:0,echoes:0,id:0},en=0,nn=[],tn=0,rn=0,on=0;function an(e,n,t,r){var i=Ke,o=Object.create(i);o.parent=i,o.ref=0,o.global=!1,o.id=++on,Te.env,o.env=ke?{Promise:qe,PromiseProp:{value:qe,configurable:!0,writable:!0},all:qe.all,race:qe.race,allSettled:qe.allSettled,any:qe.any,resolve:qe.resolve,reject:qe.reject}:{},n&&s(o,n),++i.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()};var a=dn(o,e,t,r);return 0===o.ref&&o.finalize(),a}function un(){return Ze.id||(Ze.id=++en),++Ze.awaits,Ze.echoes+=ye,Ze.id}function sn(){return!!Ze.awaits&&(0==--Ze.awaits&&(Ze.id=0),Ze.echoes=Ze.awaits*ye,!0)}function cn(e){return Ze.echoes&&e&&e.constructor===xe?(un(),e.then((function(e){return sn(),e}),(function(e){return sn(),mn(e)}))):e}function ln(e){++rn,Ze.echoes&&0!=--Ze.echoes||(Ze.echoes=Ze.awaits=Ze.id=0),nn.push(Ke),hn(e,!0)}function fn(){var e=nn[nn.length-1];nn.pop(),hn(e,!1)}function hn(e,n){var t=Ke;if((n?!Ze.echoes||tn++&&e===Ke:!tn||--tn&&e===Ke)||queueMicrotask(n?ln.bind(null,e):fn),e!==Ke&&(Ke=e,t===Te&&(Te.env=pn()),ke)){var r=Te.env.Promise,i=e.env;(t.global||e.global)&&(Object.defineProperty(o,"Promise",i.PromiseProp),r.all=i.all,r.race=i.race,r.resolve=i.resolve,r.reject=i.reject,i.allSettled&&(r.allSettled=i.allSettled),i.any&&(r.any=i.any))}}function pn(){var e=o.Promise;return ke?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(o,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function dn(e,n,t,r,i){var o=Ke;try{return hn(e,!0),n(t,r,i)}finally{hn(o,!1)}}function vn(e,n,t,r){return"function"!=typeof e?e:function(){var i=Ke;t&&un(),hn(n,!0);try{return e.apply(this,arguments)}finally{hn(i,!1),r&&queueMicrotask(sn)}}}function yn(e){Promise===xe&&0===Ze.echoes?0===tn?e():enqueueNativeMicroTask(e):setTimeout(e,0)}-1===(""+_e).indexOf("[native code]")&&(un=sn=ie);var mn=qe.reject;function gn(e,n,t,r){if(e.idbdb&&(e._state.openComplete||Ke.letThrough||e._vip)){var i=e._createTransaction(n,t,e._dbSchema);try{i.create(),e._state.PR1398_maxLoop=3}catch(i){return i.name===X.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then((function(){return gn(e,n,t,r)}))):mn(i)}return i._promise(n,(function(e,n){return an((function(){return Ke.trans=i,r(e,n,i)}))})).then((function(e){if("readwrite"===n)try{i.idbtrans.commit()}catch(e){}return"readonly"===n?e:i._completion.then((function(){return e}))}))}if(e._state.openComplete)return mn(new ee.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._state.autoOpen)return mn(new ee.DatabaseClosed);e.open().catch(ie)}return e._state.dbReadyPromise.then((function(){return gn(e,n,t,r)}))}var bn="4.0.1",wn=String.fromCharCode(65535),_n=-1/0,xn="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",kn="String expected.",Cn=[],Sn="__dbnames",On="readonly",An="readwrite";function Pn(e,n){return e?n?function(){return e.apply(this,arguments)&&n.apply(this,arguments)}:e:n}var En={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function jn(e){return"string"!=typeof e||/\./.test(e)?function(e){return e}:function(n){return void 0===n[e]&&e in n&&delete(n=D(n))[e],n}}function Tn(){throw ee.Type()}function Kn(e,n){try{var t=Dn(e),r=Dn(n);if(t!==r)return"Array"===t?1:"Array"===r?-1:"binary"===t?1:"binary"===r?-1:"string"===t?1:"string"===r?-1:"Date"===t?1:"Date"!==r?NaN:-1;switch(t){case"number":case"Date":case"string":return e>n?1:e<n?-1:0;case"binary":return Mn(qn(e),qn(n));case"Array":return Nn(e,n)}}catch(e){}return NaN}function Nn(e,n){for(var t=e.length,r=n.length,i=t<r?t:r,o=0;o<i;++o){var a=Kn(e[o],n[o]);if(0!==a)return a}return t===r?0:t<r?-1:1}function Mn(e,n){for(var t=e.length,r=n.length,i=t<r?t:r,o=0;o<i;++o)if(e[o]!==n[o])return e[o]<n[o]?-1:1;return t===r?0:t<r?-1:1}function Dn(e){var n=typeof e;if("object"!==n)return n;if(ArrayBuffer.isView(e))return"binary";var t=F(e);return"ArrayBuffer"===t?"binary":t}function qn(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var In=function(){function e(){}return e.prototype._trans=function(e,n,t){var r=this._tx||Ke.trans,i=this.name,o=pe&&"undefined"!=typeof console&&console.createTask&&console.createTask("Dexie: ".concat("readonly"===e?"read":"write"," ").concat(this.name));function a(e,t,r){if(!r.schema[i])throw new ee.NotFound("Table "+i+" not part of transaction");return n(r.idbtrans,r)}var u=$e();try{var s=r&&r.db._novip===this.db._novip?r===Ke.trans?r._promise(e,a,t):an((function(){return r._promise(e,a,t)}),{trans:r,transless:Ke.transless||Ke}):gn(this.db,e,[this.name],a);return o&&(s._consoleTask=o,s=s.catch((function(e){return console.trace(e),mn(e)}))),s}finally{u&&We()}},e.prototype.get=function(e,n){var t=this;return e&&e.constructor===Object?this.where(e).first(n):null==e?mn(new ee.Type("Invalid argument to Table.get()")):this._trans("readonly",(function(n){return t.core.get({trans:n,key:e}).then((function(e){return t.hook.reading.fire(e)}))})).then(n)},e.prototype.where=function(e){if("string"==typeof e)return new this.db.WhereClause(this,e);if(u(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var n=a(e);if(1===n.length)return this.where(n[0]).equals(e[n[0]]);var t=this.schema.indexes.concat(this.schema.primKey).filter((function(e){if(e.compound&&n.every((function(n){return e.keyPath.indexOf(n)>=0}))){for(var t=0;t<n.length;++t)if(-1===n.indexOf(e.keyPath[t]))return!1;return!0}return!1})).sort((function(e,n){return e.keyPath.length-n.keyPath.length}))[0];if(t&&this.db._maxKey!==wn){var r=t.keyPath.slice(0,n.length);return this.where(r).equals(r.map((function(n){return e[n]})))}!t&&pe&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(n.join("+"),"]"));var i=this.schema.idxByName,o=this.db._deps.indexedDB;function s(e,n){return 0===o.cmp(e,n)}var c=n.reduce((function(n,t){var r=n[0],o=n[1],a=i[t],c=e[t];return[r||a,r||!a?Pn(o,a&&a.multi?function(e){var n=C(e,t);return u(n)&&n.some((function(e){return s(c,e)}))}:function(e){return s(c,C(e,t))}):o]}),[null,null]),l=c[0],f=c[1];return l?this.where(l.name).equals(e[l.keyPath]).filter(f):t?this.filter(f):this.where(n).equals("")},e.prototype.filter=function(e){return this.toCollection().and(e)},e.prototype.count=function(e){return this.toCollection().count(e)},e.prototype.offset=function(e){return this.toCollection().offset(e)},e.prototype.limit=function(e){return this.toCollection().limit(e)},e.prototype.each=function(e){return this.toCollection().each(e)},e.prototype.toArray=function(e){return this.toCollection().toArray(e)},e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},e.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,u(e)?"[".concat(e.join("+"),"]"):e))},e.prototype.reverse=function(){return this.toCollection().reverse()},e.prototype.mapToClass=function(e){var n=this,r=n.db,i=n.name;this.schema.mappedClass=e,e.prototype instanceof Tn&&(e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),Object.defineProperty(n.prototype,"db",{get:function(){return r},enumerable:!1,configurable:!0}),n.prototype.table=function(){return i},n}(e));for(var o=new Set,a=e.prototype;a;a=c(a))Object.getOwnPropertyNames(a).forEach((function(e){return o.add(e)}));var u=function(n){if(!n)return n;var t=Object.create(e.prototype);for(var r in n)if(!o.has(r))try{t[r]=n[r]}catch(e){}return t};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=u,this.hook("reading",u),e},e.prototype.defineClass=function(){function e(e){s(this,e)}return this.mapToClass(e)},e.prototype.add=function(e,n){var t=this,r=this.schema.primKey,i=r.auto,o=r.keyPath,a=e;return o&&i&&(a=jn(o)(e)),this._trans("readwrite",(function(e){return t.core.mutate({trans:e,type:"add",keys:null!=n?[n]:null,values:[a]})})).then((function(e){return e.numFailures?qe.reject(e.failures[0]):e.lastResult})).then((function(n){if(o)try{S(e,o,n)}catch(e){}return n}))},e.prototype.update=function(e,n){if("object"!=typeof e||u(e))return this.where(":id").equals(e).modify(n);var t=C(e,this.schema.primKey.keyPath);return void 0===t?mn(new ee.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(t).modify(n)},e.prototype.put=function(e,n){var t=this,r=this.schema.primKey,i=r.auto,o=r.keyPath,a=e;return o&&i&&(a=jn(o)(e)),this._trans("readwrite",(function(e){return t.core.mutate({trans:e,type:"put",values:[a],keys:null!=n?[n]:null})})).then((function(e){return e.numFailures?qe.reject(e.failures[0]):e.lastResult})).then((function(n){if(o)try{S(e,o,n)}catch(e){}return n}))},e.prototype.delete=function(e){var n=this;return this._trans("readwrite",(function(t){return n.core.mutate({trans:t,type:"delete",keys:[e]})})).then((function(e){return e.numFailures?qe.reject(e.failures[0]):void 0}))},e.prototype.clear=function(){var e=this;return this._trans("readwrite",(function(n){return e.core.mutate({trans:n,type:"deleteRange",range:En})})).then((function(e){return e.numFailures?qe.reject(e.failures[0]):void 0}))},e.prototype.bulkGet=function(e){var n=this;return this._trans("readonly",(function(t){return n.core.getMany({keys:e,trans:t}).then((function(e){return e.map((function(e){return n.hook.reading.fire(e)}))}))}))},e.prototype.bulkAdd=function(e,n,t){var r=this,i=Array.isArray(n)?n:void 0,o=(t=t||(i?void 0:n))?t.allKeys:void 0;return this._trans("readwrite",(function(n){var t=r.schema.primKey,a=t.auto,u=t.keyPath;if(u&&i)throw new ee.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new ee.InvalidArgument("Arguments objects and keys must have the same length");var s=e.length,c=u&&a?e.map(jn(u)):e;return r.core.mutate({trans:n,type:"add",keys:i,values:c,wantResults:o}).then((function(e){var n=e.numFailures,t=e.results,i=e.lastResult,a=e.failures;if(0===n)return o?t:i;throw new Q("".concat(r.name,".bulkAdd(): ").concat(n," of ").concat(s," operations failed"),a)}))}))},e.prototype.bulkPut=function(e,n,t){var r=this,i=Array.isArray(n)?n:void 0,o=(t=t||(i?void 0:n))?t.allKeys:void 0;return this._trans("readwrite",(function(n){var t=r.schema.primKey,a=t.auto,u=t.keyPath;if(u&&i)throw new ee.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new ee.InvalidArgument("Arguments objects and keys must have the same length");var s=e.length,c=u&&a?e.map(jn(u)):e;return r.core.mutate({trans:n,type:"put",keys:i,values:c,wantResults:o}).then((function(e){var n=e.numFailures,t=e.results,i=e.lastResult,a=e.failures;if(0===n)return o?t:i;throw new Q("".concat(r.name,".bulkPut(): ").concat(n," of ").concat(s," operations failed"),a)}))}))},e.prototype.bulkUpdate=function(e){var n=this,t=this.core,r=e.map((function(e){return e.key})),i=e.map((function(e){return e.changes})),o=[];return this._trans("readwrite",(function(a){return t.getMany({trans:a,keys:r,cache:"clone"}).then((function(u){var s=[],c=[];e.forEach((function(e,t){var r=e.key,i=e.changes,a=u[t];if(a){for(var l=0,f=Object.keys(i);l<f.length;l++){var h=f[l],p=i[h];if(h===n.schema.primKey.keyPath){if(0!==Kn(p,r))throw new ee.Constraint("Cannot update primary key in bulkUpdate()")}else S(a,h,p)}o.push(t),s.push(r),c.push(a)}}));var l=s.length;return t.mutate({trans:a,type:"put",keys:s,values:c,updates:{keys:r,changeSpecs:i}}).then((function(e){var t=e.numFailures,r=e.failures;if(0===t)return l;for(var i=0,a=Object.keys(r);i<a.length;i++){var u=a[i],s=o[Number(u)];if(null!=s){var c=r[u];delete r[u],r[s]=c}}throw new Q("".concat(n.name,".bulkUpdate(): ").concat(t," of ").concat(l," operations failed"),r)}))}))}))},e.prototype.bulkDelete=function(e){var n=this,t=e.length;return this._trans("readwrite",(function(t){return n.core.mutate({trans:t,type:"delete",keys:e})})).then((function(e){var r=e.numFailures,i=e.lastResult,o=e.failures;if(0===r)return i;throw new Q("".concat(n.name,".bulkDelete(): ").concat(r," of ").concat(t," operations failed"),o)}))},e}();function Fn(e){var n={},t=function(t,r){if(r){for(var i=arguments.length,o=new Array(i-1);--i;)o[i-1]=arguments[i];return n[t].subscribe.apply(null,o),e}if("string"==typeof t)return n[t]};t.addEventType=o;for(var r=1,i=arguments.length;r<i;++r)o(arguments[r]);return t;function o(e,r,i){if("object"==typeof e)return s(e);r||(r=fe),i||(i=ie);var o={subscribers:[],fire:i,subscribe:function(e){-1===o.subscribers.indexOf(e)&&(o.subscribers.push(e),o.fire=r(o.fire,e))},unsubscribe:function(e){o.subscribers=o.subscribers.filter((function(n){return n!==e})),o.fire=o.subscribers.reduce(r,i)}};return n[e]=t[e]=o,o}function s(e){a(e).forEach((function(n){var t=e[n];if(u(t))o(n,e[n][0],e[n][1]);else{if("asap"!==t)throw new ee.InvalidArgument("Invalid event config");var r=o(n,oe,(function(){for(var e=arguments.length,n=new Array(e);e--;)n[e]=arguments[e];r.subscribers.forEach((function(e){x((function(){e.apply(null,n)}))}))}))}}))}}function Rn(e,n){return v(n).from({prototype:e}),n}function Ln(e){return Rn(In.prototype,(function(n,t,r){this.db=e,this._tx=r,this.name=n,this.schema=t,this.hook=e._allTables[n]?e._allTables[n].hook:Fn(null,{creating:[se,ie],reading:[ae,oe],updating:[le,ie],deleting:[ce,ie]})}))}function zn(e,n){return!(e.filter||e.algorithm||e.or)&&(n?e.justLimit:!e.replayFilter)}function Bn(e,n){e.filter=Pn(e.filter,n)}function Un(e,n,t){var r=e.replayFilter;e.replayFilter=r?function(){return Pn(r(),n())}:n,e.justLimit=t&&!r}function Hn(e,n){e.isMatch=Pn(e.isMatch,n)}function $n(e,n){if(e.isPrimKey)return n.primaryKey;var t=n.getIndexByKeyPath(e.index);if(!t)throw new ee.Schema("KeyPath "+e.index+" on object store "+n.name+" is not indexed");return t}function Wn(e,n,t){var r=$n(e,n.schema);return n.openCursor({trans:t,values:!e.keysOnly,reverse:"prev"===e.dir,unique:!!e.unique,query:{index:r,range:e.range}})}function Vn(e,n,t,r){var i=e.replayFilter?Pn(e.filter,e.replayFilter()):e.filter;if(e.or){var o={},a=function(e,t,r){if(!i||i(t,r,(function(e){return t.stop(e)}),(function(e){return t.fail(e)}))){var a=t.primaryKey,u=""+a;"[object ArrayBuffer]"===u&&(u=""+new Uint8Array(a)),f(o,u)||(o[u]=!0,n(e,t,r))}};return Promise.all([e.or._iterate(a,t),Jn(Wn(e,r,t),e.algorithm,a,!e.keysOnly&&e.valueMapper)])}return Jn(Wn(e,r,t),Pn(e.algorithm,i),n,!e.keysOnly&&e.valueMapper)}function Jn(e,n,t,r){var i=Xe(r?function(e,n,i){return t(r(e),n,i)}:t);return e.then((function(e){if(e)return e.start((function(){var t=function(){return e.continue()};n&&!n(e,(function(e){return t=e}),(function(n){e.stop(n),t=ie}),(function(n){e.fail(n),t=ie}))||i(e.value,e,(function(e){return t=e})),t()}))}))}var Yn=Symbol(),Gn=function(){function e(e){Object.assign(this,e)}return e.prototype.execute=function(e){var n,t=null===(n=this.replacePrefix)||void 0===n?void 0:n[0];return t&&"string"==typeof e&&e.startsWith(t)?this.replacePrefix[1]+e.substring(t.length):e},e}(),Qn=function(){function e(){}return e.prototype._read=function(e,n){var t=this._ctx;return t.error?t.table._trans(null,mn.bind(null,t.error)):t.table._trans("readonly",e).then(n)},e.prototype._write=function(e){var n=this._ctx;return n.error?n.table._trans(null,mn.bind(null,n.error)):n.table._trans("readwrite",e,"locked")},e.prototype._addAlgorithm=function(e){var n=this._ctx;n.algorithm=Pn(n.algorithm,e)},e.prototype._iterate=function(e,n){return Vn(this._ctx,e,n,this._ctx.table.core)},e.prototype.clone=function(e){var n=Object.create(this.constructor.prototype),t=Object.create(this._ctx);return e&&s(t,e),n._ctx=t,n},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(e){var n=this._ctx;return this._read((function(t){return Vn(n,e,t,n.table.core)}))},e.prototype.count=function(e){var n=this;return this._read((function(e){var t=n._ctx,r=t.table.core;if(zn(t,!0))return r.count({trans:e,query:{index:$n(t,r.schema),range:t.range}}).then((function(e){return Math.min(e,t.limit)}));var i=0;return Vn(t,(function(){return++i,!1}),e,r).then((function(){return i}))})).then(e)},e.prototype.sortBy=function(e,n){var t=e.split(".").reverse(),r=t[0],i=t.length-1;function o(e,n){return n?o(e[t[n]],n-1):e[r]}var a="next"===this._ctx.dir?1:-1;function u(e,n){var t=o(e,i),r=o(n,i);return t<r?-a:t>r?a:0}return this.toArray((function(e){return e.sort(u)})).then(n)},e.prototype.toArray=function(e){var n=this;return this._read((function(e){var t=n._ctx;if("next"===t.dir&&zn(t,!0)&&t.limit>0){var r=t.valueMapper,i=$n(t,t.table.core.schema);return t.table.core.query({trans:e,limit:t.limit,values:!0,query:{index:i,range:t.range}}).then((function(e){var n=e.result;return r?n.map(r):n}))}var o=[];return Vn(t,(function(e){return o.push(e)}),e,t.table.core).then((function(){return o}))}),e)},e.prototype.offset=function(e){var n=this._ctx;return e<=0||(n.offset+=e,zn(n)?Un(n,(function(){var n=e;return function(e,t){return 0===n||(1===n?(--n,!1):(t((function(){e.advance(n),n=0})),!1))}})):Un(n,(function(){var n=e;return function(){return--n<0}}))),this},e.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Un(this._ctx,(function(){var n=e;return function(e,t,r){return--n<=0&&t(r),n>=0}}),!0),this},e.prototype.until=function(e,n){return Bn(this._ctx,(function(t,r,i){return!e(t.value)||(r(i),n)})),this},e.prototype.first=function(e){return this.limit(1).toArray((function(e){return e[0]})).then(e)},e.prototype.last=function(e){return this.reverse().first(e)},e.prototype.filter=function(e){return Bn(this._ctx,(function(n){return e(n.value)})),Hn(this._ctx,e),this},e.prototype.and=function(e){return this.filter(e)},e.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},e.prototype.reverse=function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each((function(n,t){e(t.key,t)}))},e.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},e.prototype.eachPrimaryKey=function(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each((function(n,t){e(t.primaryKey,t)}))},e.prototype.keys=function(e){var n=this._ctx;n.keysOnly=!n.isMatch;var t=[];return this.each((function(e,n){t.push(n.key)})).then((function(){return t})).then(e)},e.prototype.primaryKeys=function(e){var n=this._ctx;if("next"===n.dir&&zn(n,!0)&&n.limit>0)return this._read((function(e){var t=$n(n,n.table.core.schema);return n.table.core.query({trans:e,values:!1,limit:n.limit,query:{index:t,range:n.range}})})).then((function(e){return e.result})).then(e);n.keysOnly=!n.isMatch;var t=[];return this.each((function(e,n){t.push(n.primaryKey)})).then((function(){return t})).then(e)},e.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},e.prototype.firstKey=function(e){return this.limit(1).keys((function(e){return e[0]})).then(e)},e.prototype.lastKey=function(e){return this.reverse().firstKey(e)},e.prototype.distinct=function(){var e=this._ctx,n=e.index&&e.table.schema.idxByName[e.index];if(!n||!n.multi)return this;var t={};return Bn(this._ctx,(function(e){var n=e.primaryKey.toString(),r=f(t,n);return t[n]=!0,!r})),this},e.prototype.modify=function(e){var n=this,t=this._ctx;return this._write((function(r){var i;if("function"==typeof e)i=e;else{var o=a(e),u=o.length;i=function(n){for(var t=!1,r=0;r<u;++r){var i=o[r],a=e[i],s=C(n,i);a instanceof Gn?(S(n,i,a.execute(s)),t=!0):s!==a&&(S(n,i,a),t=!0)}return t}}var s=t.table.core,c=s.schema.primaryKey,l=c.outbound,f=c.extractKey,h=n.db._options.modifyChunkSize||200,p=[],d=0,v=[],y=function(e,n){var t=n.failures,r=n.numFailures;d+=e-r;for(var i=0,o=a(t);i<o.length;i++){var u=o[i];p.push(t[u])}};return n.clone().primaryKeys().then((function(n){var o=function(a){var u=Math.min(h,n.length-a);return s.getMany({trans:r,keys:n.slice(a,a+u),cache:"immutable"}).then((function(c){for(var p=[],d=[],v=l?[]:null,m=[],g=0;g<u;++g){var b=c[g],w={value:D(b),primKey:n[a+g]};!1!==i.call(w,w.value,w)&&(null==w.value?m.push(n[a+g]):l||0===Kn(f(b),f(w.value))?(d.push(w.value),l&&v.push(n[a+g])):(m.push(n[a+g]),p.push(w.value)))}var _=zn(t)&&t.limit===1/0&&("function"!=typeof e||e===Xn)&&{index:t.index,range:t.range};return Promise.resolve(p.length>0&&s.mutate({trans:r,type:"add",values:p}).then((function(e){for(var n in e.failures)m.splice(parseInt(n),1);y(p.length,e)}))).then((function(){return(d.length>0||_&&"object"==typeof e)&&s.mutate({trans:r,type:"put",keys:v,values:d,criteria:_,changeSpec:"function"!=typeof e&&e}).then((function(e){return y(d.length,e)}))})).then((function(){return(m.length>0||_&&e===Xn)&&s.mutate({trans:r,type:"delete",keys:m,criteria:_}).then((function(e){return y(m.length,e)}))})).then((function(){return n.length>a+u&&o(a+h)}))}))};return o(0).then((function(){if(p.length>0)throw new G("Error modifying one or more objects",p,d,v);return n.length}))}))}))},e.prototype.delete=function(){var e=this._ctx,n=e.range;return zn(e)&&(e.isPrimKey||3===n.type)?this._write((function(t){var r=e.table.core.schema.primaryKey,i=n;return e.table.core.count({trans:t,query:{index:r,range:i}}).then((function(n){return e.table.core.mutate({trans:t,type:"deleteRange",range:i}).then((function(e){var t=e.failures;e.lastResult,e.results;var r=e.numFailures;if(r)throw new G("Could not delete some values",Object.keys(t).map((function(e){return t[e]})),n-r);return n-r}))}))})):this.modify(Xn)},e}(),Xn=function(e,n){return n.value=null};function Zn(e){return Rn(Qn.prototype,(function(n,t){this.db=e;var r=En,i=null;if(t)try{r=t()}catch(e){i=e}var o=n._ctx,a=o.table,u=a.hook.reading.fire;this._ctx={table:a,index:o.index,isPrimKey:!o.index||a.schema.primKey.keyPath&&o.index===a.schema.primKey.name,range:r,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:i,or:o.or,valueMapper:u!==oe?u:null}}))}function et(e,n){return e<n?-1:e===n?0:1}function nt(e,n){return e>n?-1:e===n?0:1}function tt(e,n,t){var r=e instanceof lt?new e.Collection(e):e;return r._ctx.error=t?new t(n):new TypeError(n),r}function rt(e){return new e.Collection(e,(function(){return ct("")})).limit(0)}function it(e){return"next"===e?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}function ot(e){return"next"===e?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}function at(e,n,t,r,i,o){for(var a=Math.min(e.length,r.length),u=-1,s=0;s<a;++s){var c=n[s];if(c!==r[s])return i(e[s],t[s])<0?e.substr(0,s)+t[s]+t.substr(s+1):i(e[s],r[s])<0?e.substr(0,s)+r[s]+t.substr(s+1):u>=0?e.substr(0,u)+n[u]+t.substr(u+1):null;i(e[s],c)<0&&(u=s)}return a<r.length&&"next"===o?e+t.substr(e.length):a<e.length&&"prev"===o?e.substr(0,t.length):u<0?null:e.substr(0,u)+r[u]+t.substr(u+1)}function ut(e,n,t,r){var i,o,a,u,s,c,l,f=t.length;if(!t.every((function(e){return"string"==typeof e})))return tt(e,kn);function h(e){i=it(e),o=ot(e),a="next"===e?et:nt;var n=t.map((function(e){return{lower:o(e),upper:i(e)}})).sort((function(e,n){return a(e.lower,n.lower)}));u=n.map((function(e){return e.upper})),s=n.map((function(e){return e.lower})),c=e,l="next"===e?"":r}h("next");var p=new e.Collection(e,(function(){return st(u[0],s[f-1]+r)}));p._ondirectionchange=function(e){h(e)};var d=0;return p._addAlgorithm((function(e,t,r){var i=e.key;if("string"!=typeof i)return!1;var h=o(i);if(n(h,s,d))return!0;for(var p=null,v=d;v<f;++v){var y=at(i,h,u[v],s[v],a,c);null===y&&null===p?d=v+1:(null===p||a(p,y)>0)&&(p=y)}return t(null!==p?function(){e.continue(p+l)}:r),!1})),p}function st(e,n,t,r){return{type:2,lower:e,upper:n,lowerOpen:t,upperOpen:r}}function ct(e){return{type:1,lower:e,upper:e}}var lt=function(){function e(){}return Object.defineProperty(e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),e.prototype.between=function(e,n,t,r){t=!1!==t,r=!0===r;try{return this._cmp(e,n)>0||0===this._cmp(e,n)&&(t||r)&&(!t||!r)?rt(this):new this.Collection(this,(function(){return st(e,n,!t,!r)}))}catch(e){return tt(this,xn)}},e.prototype.equals=function(e){return null==e?tt(this,xn):new this.Collection(this,(function(){return ct(e)}))},e.prototype.above=function(e){return null==e?tt(this,xn):new this.Collection(this,(function(){return st(e,void 0,!0)}))},e.prototype.aboveOrEqual=function(e){return null==e?tt(this,xn):new this.Collection(this,(function(){return st(e,void 0,!1)}))},e.prototype.below=function(e){return null==e?tt(this,xn):new this.Collection(this,(function(){return st(void 0,e,!1,!0)}))},e.prototype.belowOrEqual=function(e){return null==e?tt(this,xn):new this.Collection(this,(function(){return st(void 0,e)}))},e.prototype.startsWith=function(e){return"string"!=typeof e?tt(this,kn):this.between(e,e+wn,!0,!0)},e.prototype.startsWithIgnoreCase=function(e){return""===e?this.startsWith(e):ut(this,(function(e,n){return 0===e.indexOf(n[0])}),[e],wn)},e.prototype.equalsIgnoreCase=function(e){return ut(this,(function(e,n){return e===n[0]}),[e],"")},e.prototype.anyOfIgnoreCase=function(){var e=U.apply(B,arguments);return 0===e.length?rt(this):ut(this,(function(e,n){return-1!==n.indexOf(e)}),e,"")},e.prototype.startsWithAnyOfIgnoreCase=function(){var e=U.apply(B,arguments);return 0===e.length?rt(this):ut(this,(function(e,n){return n.some((function(n){return 0===e.indexOf(n)}))}),e,wn)},e.prototype.anyOf=function(){var e=this,n=U.apply(B,arguments),t=this._cmp;try{n.sort(t)}catch(e){return tt(this,xn)}if(0===n.length)return rt(this);var r=new this.Collection(this,(function(){return st(n[0],n[n.length-1])}));r._ondirectionchange=function(r){t="next"===r?e._ascending:e._descending,n.sort(t)};var i=0;return r._addAlgorithm((function(e,r,o){for(var a=e.key;t(a,n[i])>0;)if(++i===n.length)return r(o),!1;return 0===t(a,n[i])||(r((function(){e.continue(n[i])})),!1)})),r},e.prototype.notEqual=function(e){return this.inAnyRange([[_n,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var e=U.apply(B,arguments);if(0===e.length)return new this.Collection(this);try{e.sort(this._ascending)}catch(e){return tt(this,xn)}var n=e.reduce((function(e,n){return e?e.concat([[e[e.length-1][1],n]]):[[_n,n]]}),null);return n.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(e,n){var t=this,r=this._cmp,i=this._ascending,o=this._descending,a=this._min,u=this._max;if(0===e.length)return rt(this);if(!e.every((function(e){return void 0!==e[0]&&void 0!==e[1]&&i(e[0],e[1])<=0})))return tt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ee.InvalidArgument);var s=!n||!1!==n.includeLowers,c=n&&!0===n.includeUppers;function l(e,n){for(var t=0,i=e.length;t<i;++t){var o=e[t];if(r(n[0],o[1])<0&&r(n[1],o[0])>0){o[0]=a(o[0],n[0]),o[1]=u(o[1],n[1]);break}}return t===i&&e.push(n),e}var f,h=i;function p(e,n){return h(e[0],n[0])}try{(f=e.reduce(l,[])).sort(p)}catch(e){return tt(this,xn)}var d=0,v=c?function(e){return i(e,f[d][1])>0}:function(e){return i(e,f[d][1])>=0},y=s?function(e){return o(e,f[d][0])>0}:function(e){return o(e,f[d][0])>=0};function m(e){return!v(e)&&!y(e)}var g=v,b=new this.Collection(this,(function(){return st(f[0][0],f[f.length-1][1],!s,!c)}));return b._ondirectionchange=function(e){"next"===e?(g=v,h=i):(g=y,h=o),f.sort(p)},b._addAlgorithm((function(e,n,r){for(var o=e.key;g(o);)if(++d===f.length)return n(r),!1;return!!m(o)||(0===t._cmp(o,f[d][1])||0===t._cmp(o,f[d][0])||n((function(){h===i?e.continue(f[d][0]):e.continue(f[d][1])})),!1)})),b},e.prototype.startsWithAnyOf=function(){var e=U.apply(B,arguments);return e.every((function(e){return"string"==typeof e}))?0===e.length?rt(this):this.inAnyRange(e.map((function(e){return[e,e+wn]}))):tt(this,"startsWithAnyOf() only works with strings")},e}();function ft(e){return Rn(lt.prototype,(function(n,t,r){if(this.db=e,this._ctx={table:n,index:":id"===t?null:t,or:r},this._cmp=this._ascending=Kn,this._descending=function(e,n){return Kn(n,e)},this._max=function(e,n){return Kn(e,n)>0?e:n},this._min=function(e,n){return Kn(e,n)<0?e:n},this._IDBKeyRange=e._deps.IDBKeyRange,!this._IDBKeyRange)throw new ee.MissingAPI}))}function ht(e){return Xe((function(n){return pt(n),e(n.target.error),!1}))}function pt(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var dt="storagemutated",vt="x-storagemutated-1",yt=Fn(null,dt),mt=function(){function e(){}return e.prototype._lock=function(){return _(!Ke.global),++this._reculock,1!==this._reculock||Ke.global||(Ke.lockOwnerFor=this),this},e.prototype._unlock=function(){if(_(!Ke.global),0==--this._reculock)for(Ke.global||(Ke.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{dn(e[1],e[0])}catch(e){}}return this},e.prototype._locked=function(){return this._reculock&&Ke.lockOwnerFor!==this},e.prototype.create=function(e){var n=this;if(!this.mode)return this;var t=this.db.idbdb,r=this.db._state.dbOpenError;if(_(!this.idbtrans),!e&&!t)switch(r&&r.name){case"DatabaseClosedError":throw new ee.DatabaseClosed(r);case"MissingAPIError":throw new ee.MissingAPI(r.message,r);default:throw new ee.OpenFailed(r)}if(!this.active)throw new ee.TransactionInactive;return _(null===this._completion._state),(e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):t.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=Xe((function(t){pt(t),n._reject(e.error)})),e.onabort=Xe((function(t){pt(t),n.active&&n._reject(new ee.Abort(e.error)),n.active=!1,n.on("abort").fire(t)})),e.oncomplete=Xe((function(){n.active=!1,n._resolve(),"mutatedParts"in e&&yt.storagemutated.fire(e.mutatedParts)})),this},e.prototype._promise=function(e,n,t){var r=this;if("readwrite"===e&&"readwrite"!==this.mode)return mn(new ee.ReadOnly("Transaction is readonly"));if(!this.active)return mn(new ee.TransactionInactive);if(this._locked())return new qe((function(i,o){r._blockedFuncs.push([function(){r._promise(e,n,t).then(i,o)},Ke])}));if(t)return an((function(){var e=new qe((function(e,t){r._lock();var i=n(e,t,r);i&&i.then&&i.then(e,t)}));return e.finally((function(){return r._unlock()})),e._lib=!0,e}));var i=new qe((function(e,t){var i=n(e,t,r);i&&i.then&&i.then(e,t)}));return i._lib=!0,i},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(e){var n=this._root(),t=qe.resolve(e);if(n._waitingFor)n._waitingFor=n._waitingFor.then((function(){return t}));else{n._waitingFor=t,n._waitingQueue=[];var r=n.idbtrans.objectStore(n.storeNames[0]);!function e(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(r.get(-1/0).onsuccess=e)}()}var i=n._waitingFor;return new qe((function(e,r){t.then((function(t){return n._waitingQueue.push(Xe(e.bind(null,t)))}),(function(e){return n._waitingQueue.push(Xe(r.bind(null,e)))})).finally((function(){n._waitingFor===i&&(n._waitingFor=null)}))}))},e.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ee.Abort))},e.prototype.table=function(e){var n=this._memoizedTables||(this._memoizedTables={});if(f(n,e))return n[e];var t=this.schema[e];if(!t)throw new ee.NotFound("Table "+e+" not part of transaction");var r=new this.db.Table(e,t,this);return r.core=this.db.core.table(e),n[e]=r,r},e}();function gt(e){return Rn(mt.prototype,(function(n,t,r,i,o){var a=this;this.db=e,this.mode=n,this.storeNames=t,this.schema=r,this.chromeTransactionDurability=i,this.idbtrans=null,this.on=Fn(this,"complete","error","abort"),this.parent=o||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new qe((function(e,n){a._resolve=e,a._reject=n})),this._completion.then((function(){a.active=!1,a.on.complete.fire()}),(function(e){var n=a.active;return a.active=!1,a.on.error.fire(e),a.parent?a.parent._reject(e):n&&a.idbtrans&&a.idbtrans.abort(),mn(e)}))}))}function bt(e,n,t,r,i,o,a){return{name:e,keyPath:n,unique:t,multi:r,auto:i,compound:o,src:(t&&!a?"&":"")+(r?"*":"")+(i?"++":"")+wt(n)}}function wt(e){return"string"==typeof e?e:e?"["+[].join.call(e,"+")+"]":""}function _t(e,n,t){return{name:e,primKey:n,indexes:t,mappedClass:null,idxByName:k(t,(function(e){return[e.name,e]}))}}function xt(e){return 1===e.length?e[0]:e}var kt=function(e){try{return e.only([[]]),kt=function(){return[[]]},[[]]}catch(e){return kt=function(){return wn},wn}};function Ct(e){return null==e?function(){}:"string"==typeof e?St(e):function(n){return C(n,e)}}function St(e){return 1===e.split(".").length?function(n){return n[e]}:function(n){return C(n,e)}}function Ot(e){return[].slice.call(e)}var At=0;function Pt(e){return null==e?":id":"string"==typeof e?e:"[".concat(e.join("+"),"]")}function Et(e,n,t){function r(e,n){var t=Ot(e.objectStoreNames);return{schema:{name:e.name,tables:t.map((function(e){return n.objectStore(e)})).map((function(e){var n=e.keyPath,t=e.autoIncrement,r=u(n),i=null==n,o={},a={name:e.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:i,compound:r,keyPath:n,autoIncrement:t,unique:!0,extractKey:Ct(n)},indexes:Ot(e.indexNames).map((function(n){return e.index(n)})).map((function(e){var n=e.name,t=e.unique,r=e.multiEntry,i=e.keyPath,a={name:n,compound:u(i),keyPath:i,unique:t,multiEntry:r,extractKey:Ct(i)};return o[Pt(i)]=a,a})),getIndexByKeyPath:function(e){return o[Pt(e)]}};return o[":id"]=a.primaryKey,null!=n&&(o[Pt(n)]=a.primaryKey),a}))},hasGetAll:t.length>0&&"getAll"in n.objectStore(t[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function i(e){if(3===e.type)return null;if(4===e.type)throw new Error("Cannot convert never type to IDBKeyRange");var t=e.lower,r=e.upper,i=e.lowerOpen,o=e.upperOpen;return void 0===t?void 0===r?null:n.upperBound(r,!!o):void 0===r?n.lowerBound(t,!!i):n.bound(t,r,!!i,!!o)}function o(e){var n=e.name;function t(e){var t=e.trans,r=e.type,o=e.keys,a=e.values,u=e.range;return new Promise((function(e,s){e=Xe(e);var c=t.objectStore(n),l=null==c.keyPath,f="put"===r||"add"===r;if(!f&&"delete"!==r&&"deleteRange"!==r)throw new Error("Invalid operation type: "+r);var h,p=(o||a||{length:1}).length;if(o&&a&&o.length!==a.length)throw new Error("Given keys array must have same length as given values array.");if(0===p)return e({numFailures:0,failures:{},results:[],lastResult:void 0});var d=[],v=[],y=0,m=function(e){++y,pt(e)};if("deleteRange"===r){if(4===u.type)return e({numFailures:y,failures:v,results:[],lastResult:void 0});3===u.type?d.push(h=c.clear()):d.push(h=c.delete(i(u)))}else{var g=f?l?[a,o]:[a,null]:[o,null],b=g[0],w=g[1];if(f)for(var _=0;_<p;++_)d.push(h=w&&void 0!==w[_]?c[r](b[_],w[_]):c[r](b[_])),h.onerror=m;else for(_=0;_<p;++_)d.push(h=c[r](b[_])),h.onerror=m}var x=function(n){var t=n.target.result;d.forEach((function(e,n){return null!=e.error&&(v[n]=e.error)})),e({numFailures:y,failures:v,results:"delete"===r?o:d.map((function(e){return e.result})),lastResult:t})};h.onerror=function(e){m(e),x(e)},h.onsuccess=x}))}function r(e){var t=e.trans,r=e.values,o=e.query,a=e.reverse,u=e.unique;return new Promise((function(e,s){e=Xe(e);var c=o.index,l=o.range,f=t.objectStore(n),h=c.isPrimaryKey?f:f.index(c.name),p=a?u?"prevunique":"prev":u?"nextunique":"next",d=r||!("openKeyCursor"in h)?h.openCursor(i(l),p):h.openKeyCursor(i(l),p);d.onerror=ht(s),d.onsuccess=Xe((function(n){var r=d.result;if(r){r.___id=++At,r.done=!1;var i=r.continue.bind(r),o=r.continuePrimaryKey;o&&(o=o.bind(r));var a=r.advance.bind(r),u=function(){throw new Error("Cursor not started")},c=function(){throw new Error("Cursor not stopped")};r.trans=t,r.stop=r.continue=r.continuePrimaryKey=r.advance=u,r.fail=Xe(s),r.next=function(){var e=this,n=1;return this.start((function(){return n--?e.continue():e.stop()})).then((function(){return e}))},r.start=function(e){var n=new Promise((function(e,n){e=Xe(e),d.onerror=ht(n),r.fail=n,r.stop=function(n){r.stop=r.continue=r.continuePrimaryKey=r.advance=c,e(n)}})),t=function(){if(d.result)try{e()}catch(e){r.fail(e)}else r.done=!0,r.start=function(){throw new Error("Cursor behind last entry")},r.stop()};return d.onsuccess=Xe((function(e){d.onsuccess=t,t()})),r.continue=i,r.continuePrimaryKey=o,r.advance=a,t(),n},e(r)}else e(null)}),s)}))}function o(e){return function(t){return new Promise((function(r,o){r=Xe(r);var a=t.trans,u=t.values,s=t.limit,c=t.query,l=s===1/0?void 0:s,f=c.index,h=c.range,p=a.objectStore(n),d=f.isPrimaryKey?p:p.index(f.name),v=i(h);if(0===s)return r({result:[]});if(e){var y=u?d.getAll(v,l):d.getAllKeys(v,l);y.onsuccess=function(e){return r({result:e.target.result})},y.onerror=ht(o)}else{var m=0,g=u||!("openKeyCursor"in d)?d.openCursor(v):d.openKeyCursor(v),b=[];g.onsuccess=function(e){var n=g.result;return n?(b.push(u?n.value:n.primaryKey),++m===s?r({result:b}):void n.continue()):r({result:b})},g.onerror=ht(o)}}))}}return{name:n,schema:e,mutate:t,getMany:function(e){var t=e.trans,r=e.keys;return new Promise((function(e,i){e=Xe(e);for(var o,a=t.objectStore(n),u=r.length,s=new Array(u),c=0,l=0,f=function(n){var t=n.target;s[t._pos]=t.result,++l===c&&e(s)},h=ht(i),p=0;p<u;++p)null!=r[p]&&((o=a.get(r[p]))._pos=p,o.onsuccess=f,o.onerror=h,++c);0===c&&e(s)}))},get:function(e){var t=e.trans,r=e.key;return new Promise((function(e,i){e=Xe(e);var o=t.objectStore(n).get(r);o.onsuccess=function(n){return e(n.target.result)},o.onerror=ht(i)}))},query:o(c),openCursor:r,count:function(e){var t=e.query,r=e.trans,o=t.index,a=t.range;return new Promise((function(e,t){var u=r.objectStore(n),s=o.isPrimaryKey?u:u.index(o.name),c=i(a),l=c?s.count(c):s.count();l.onsuccess=Xe((function(n){return e(n.target.result)})),l.onerror=ht(t)}))}}}var a=r(e,t),s=a.schema,c=a.hasGetAll,l=s.tables.map((function(e){return o(e)})),f={};return l.forEach((function(e){return f[e.name]=e})),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(e){if(!f[e])throw new Error("Table '".concat(e,"' not found"));return f[e]},MIN_KEY:-1/0,MAX_KEY:kt(n),schema:s}}function jt(e,n){return n.reduce((function(e,n){var t=n.create;return r(r({},e),t(e))}),e)}function Tt(e,n,t,r){var i=t.IDBKeyRange;return t.indexedDB,{dbcore:jt(Et(n,i,r),e.dbcore)}}function Kt(e,n){var t=n.db,r=Tt(e._middlewares,t,e._deps,n);e.core=r.dbcore,e.tables.forEach((function(n){var t=n.name;e.core.schema.tables.some((function(e){return e.name===t}))&&(n.core=e.core.table(t),e[t]instanceof e.Table&&(e[t].core=n.core))}))}function Nt(e,n,t,r){t.forEach((function(t){var i=r[t];n.forEach((function(n){var r=m(n,t);(!r||"value"in r&&void 0===r.value)&&(n===e.Transaction.prototype||n instanceof e.Transaction?d(n,t,{get:function(){return this.table(t)},set:function(e){p(this,t,{value:e,writable:!0,configurable:!0,enumerable:!0})}}):n[t]=new e.Table(t,i))}))}))}function Mt(e,n){n.forEach((function(n){for(var t in n)n[t]instanceof e.Table&&delete n[t]}))}function Dt(e,n){return e._cfg.version-n._cfg.version}function qt(e,n,t,r){var i=e._dbSchema;t.objectStoreNames.contains("$meta")&&!i.$meta&&(i.$meta=_t("$meta",Yt("")[0],[]),e._storeNames.push("$meta"));var o=e._createTransaction("readwrite",e._storeNames,i);o.create(t),o._completion.catch(r);var u=o._reject.bind(o),s=Ke.transless||Ke;an((function(){if(Ke.trans=o,Ke.transless=s,0!==n)return Kt(e,t),Ft(e,o,n).then((function(n){return Rt(e,n,o,t)})).catch(u);a(i).forEach((function(e){zt(t,e,i[e].primKey,i[e].indexes)})),Kt(e,t),qe.follow((function(){return e.on.populate.fire(o)})).catch(u)}))}function It(e,n){Bt(e._dbSchema,n),n.db.version%10!=0||n.objectStoreNames.contains("$meta")||n.db.createObjectStore("$meta").add(Math.ceil(n.db.version/10-1),"version");var t=$t(e,e.idbdb,n);Jt(e,e._dbSchema,n);for(var r=function(e){if(e.change.length||e.recreate)return console.warn("Unable to patch indexes of table ".concat(e.name," because it has changes on the type of index or primary key.")),{value:void 0};var t=n.objectStore(e.name);e.add.forEach((function(n){pe&&console.debug("Dexie upgrade patch: Creating missing index ".concat(e.name,".").concat(n.src)),Ht(t,n)}))},i=0,o=Lt(t,e._dbSchema).change;i<o.length;i++){var a=r(o[i]);if("object"==typeof a)return a.value}}function Ft(e,n,t){return n.storeNames.includes("$meta")?n.table("$meta").get("version").then((function(e){return null!=e?e:t})):qe.resolve(t)}function Rt(e,n,t,r){var i=[],o=e._versions,u=e._dbSchema=$t(e,e.idbdb,r),s=o.filter((function(e){return e._cfg.version>=n}));if(0===s.length)return qe.resolve();function c(){return i.length?qe.resolve(i.shift()(t.idbtrans)).then(c):qe.resolve()}return s.forEach((function(o){i.push((function(){var i=u,s=o._cfg.dbschema;Jt(e,i,r),Jt(e,s,r),u=e._dbSchema=s;var c=Lt(i,s);c.add.forEach((function(e){zt(r,e[0],e[1].primKey,e[1].indexes)})),c.change.forEach((function(e){if(e.recreate)throw new ee.Upgrade("Not yet support for changing primary key");var n=r.objectStore(e.name);e.add.forEach((function(e){return Ht(n,e)})),e.change.forEach((function(e){n.deleteIndex(e.name),Ht(n,e)})),e.del.forEach((function(e){return n.deleteIndex(e)}))}));var l=o._cfg.contentUpgrade;if(l&&o._cfg.version>n){Kt(e,r),t._memoizedTables={};var f=A(s);c.del.forEach((function(e){f[e]=i[e]})),Mt(e,[e.Transaction.prototype]),Nt(e,[e.Transaction.prototype],a(f),f),t.schema=f;var h,p=H(l);p&&un();var d=qe.follow((function(){if((h=l(t))&&p){var e=sn.bind(null,null);h.then(e,e)}}));return h&&"function"==typeof h.then?qe.resolve(h):d.then((function(){return h}))}})),i.push((function(n){Ut(o._cfg.dbschema,n),Mt(e,[e.Transaction.prototype]),Nt(e,[e.Transaction.prototype],e._storeNames,e._dbSchema),t.schema=e._dbSchema})),i.push((function(n){e.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(e.idbdb.version/10)===o._cfg.version?(e.idbdb.deleteObjectStore("$meta"),delete e._dbSchema.$meta,e._storeNames=e._storeNames.filter((function(e){return"$meta"!==e}))):n.objectStore("$meta").put(o._cfg.version,"version"))}))})),c().then((function(){Bt(u,r)}))}function Lt(e,n){var t,r={del:[],add:[],change:[]};for(t in e)n[t]||r.del.push(t);for(t in n){var i=e[t],o=n[t];if(i){var a={name:t,def:o,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(o.primKey.keyPath||"")||i.primKey.auto!==o.primKey.auto)a.recreate=!0,r.change.push(a);else{var u=i.idxByName,s=o.idxByName,c=void 0;for(c in u)s[c]||a.del.push(c);for(c in s){var l=u[c],f=s[c];l?l.src!==f.src&&a.change.push(f):a.add.push(f)}(a.del.length>0||a.add.length>0||a.change.length>0)&&r.change.push(a)}}else r.add.push([t,o])}return r}function zt(e,n,t,r){var i=e.db.createObjectStore(n,t.keyPath?{keyPath:t.keyPath,autoIncrement:t.auto}:{autoIncrement:t.auto});return r.forEach((function(e){return Ht(i,e)})),i}function Bt(e,n){a(e).forEach((function(t){n.db.objectStoreNames.contains(t)||(pe&&console.debug("Dexie: Creating missing table",t),zt(n,t,e[t].primKey,e[t].indexes))}))}function Ut(e,n){[].slice.call(n.db.objectStoreNames).forEach((function(t){return null==e[t]&&n.db.deleteObjectStore(t)}))}function Ht(e,n){e.createIndex(n.name,n.keyPath,{unique:n.unique,multiEntry:n.multi})}function $t(e,n,t){var r={};return b(n.objectStoreNames,0).forEach((function(e){for(var n=t.objectStore(e),i=n.keyPath,o=bt(wt(i),i||"",!0,!1,!!n.autoIncrement,i&&"string"!=typeof i,!0),a=[],u=0;u<n.indexNames.length;++u){var s=n.index(n.indexNames[u]);i=s.keyPath;var c=bt(s.name,i,!!s.unique,!!s.multiEntry,!1,i&&"string"!=typeof i,!1);a.push(c)}r[e]=_t(e,o,a)})),r}function Wt(e,n,t){e.verno=n.version/10;var r=e._dbSchema=$t(e,n,t);e._storeNames=b(n.objectStoreNames,0),Nt(e,[e._allTables],a(r),r)}function Vt(e,n){var t=Lt($t(e,e.idbdb,n),e._dbSchema);return!(t.add.length||t.change.some((function(e){return e.add.length||e.change.length})))}function Jt(e,n,t){for(var r=t.db.objectStoreNames,i=0;i<r.length;++i){var a=r[i],u=t.objectStore(a);e._hasGetAll="getAll"in u;for(var s=0;s<u.indexNames.length;++s){var c=u.indexNames[s],l=u.index(c).keyPath,f="string"==typeof l?l:"["+b(l).join("+")+"]";if(n[a]){var h=n[a].idxByName[f];h&&(h.name=c,delete n[a].idxByName[f],n[a].idxByName[c]=h)}}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&o.WorkerGlobalScope&&o instanceof o.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function Yt(e){return e.split(",").map((function(e,n){var t=(e=e.trim()).replace(/([&*]|\+\+)/g,""),r=/^\[/.test(t)?t.match(/^\[(.*)\]$/)[1].split("+"):t;return bt(t,r||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),u(r),0===n)}))}var Gt,Qt=function(){function e(){}return e.prototype._parseStoresSpec=function(e,n){a(e).forEach((function(t){if(null!==e[t]){var r=Yt(e[t]),i=r.shift();if(i.unique=!0,i.multi)throw new ee.Schema("Primary key cannot be multi-valued");r.forEach((function(e){if(e.auto)throw new ee.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new ee.Schema("Index must have a name and cannot be an empty string")})),n[t]=_t(t,i,r)}}))},e.prototype.stores=function(e){var n=this.db;this._cfg.storesSource=this._cfg.storesSource?s(this._cfg.storesSource,e):e;var t=n._versions,r={},i={};return t.forEach((function(e){s(r,e._cfg.storesSource),i=e._cfg.dbschema={},e._parseStoresSpec(r,i)})),n._dbSchema=i,Mt(n,[n._allTables,n,n.Transaction.prototype]),Nt(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],a(i),i),n._storeNames=a(i),this},e.prototype.upgrade=function(e){return this._cfg.contentUpgrade=he(this._cfg.contentUpgrade||ie,e),this},e}();function Xt(e){return Rn(Qt.prototype,(function(n){this.db=e,this._cfg={version:n,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}}))}function Zt(e,n){var t=e._dbNamesDB;return t||(t=e._dbNamesDB=new ei(Sn,{addons:[],indexedDB:e,IDBKeyRange:n})).version(1).stores({dbnames:"name"}),t.table("dbnames")}function er(e){return e&&"function"==typeof e.databases}function nr(e){var n=e.indexedDB,t=e.IDBKeyRange;return er(n)?Promise.resolve(n.databases()).then((function(e){return e.map((function(e){return e.name})).filter((function(e){return e!==Sn}))})):Zt(n,t).toCollection().primaryKeys()}function tr(e,n){var t=e.indexedDB,r=e.IDBKeyRange;!er(t)&&n!==Sn&&Zt(t,r).put({name:n}).catch(ie)}function rr(e,n){var t=e.indexedDB,r=e.IDBKeyRange;!er(t)&&n!==Sn&&Zt(t,r).delete(n).catch(ie)}function ir(e){return an((function(){return Ke.letThrough=!0,e()}))}function or(){var e;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise((function(n){var t=function(){return indexedDB.databases().finally(n)};e=setInterval(t,100),t()})).finally((function(){return clearInterval(e)})):Promise.resolve()}function ar(e){return!("from"in e)}var ur=function(e,n){if(!this){var t=new ur;return e&&"d"in e&&s(t,e),t}s(this,arguments.length?{d:1,from:e,to:arguments.length>1?n:e}:{d:0})};function sr(e,n,t){var r=Kn(n,t);if(!isNaN(r)){if(r>0)throw RangeError();if(ar(e))return s(e,{from:n,to:t,d:1});var i=e.l,o=e.r;if(Kn(t,e.from)<0)return i?sr(i,n,t):e.l={from:n,to:t,d:1,l:null,r:null},hr(e);if(Kn(n,e.to)>0)return o?sr(o,n,t):e.r={from:n,to:t,d:1,l:null,r:null},hr(e);Kn(n,e.from)<0&&(e.from=n,e.l=null,e.d=o?o.d+1:1),Kn(t,e.to)>0&&(e.to=t,e.r=null,e.d=e.l?e.l.d+1:1);var a=!e.r;i&&!e.l&&cr(e,i),o&&a&&cr(e,o)}}function cr(e,n){function t(e,n){var r=n.from,i=n.to,o=n.l,a=n.r;sr(e,r,i),o&&t(e,o),a&&t(e,a)}ar(n)||t(e,n)}function lr(e,n){var t=fr(n),r=t.next();if(r.done)return!1;for(var i=r.value,o=fr(e),a=o.next(i.from),u=a.value;!r.done&&!a.done;){if(Kn(u.from,i.to)<=0&&Kn(u.to,i.from)>=0)return!0;Kn(i.from,u.from)<0?i=(r=t.next(u.from)).value:u=(a=o.next(i.from)).value}return!1}function fr(e){var n=ar(e)?null:{s:0,n:e};return{next:function(e){for(var t=arguments.length>0;n;)switch(n.s){case 0:if(n.s=1,t)for(;n.n.l&&Kn(e,n.n.from)<0;)n={up:n,n:n.n.l,s:1};else for(;n.n.l;)n={up:n,n:n.n.l,s:1};case 1:if(n.s=2,!t||Kn(e,n.n.to)<=0)return{value:n.n,done:!1};case 2:if(n.n.r){n.s=3,n={up:n,n:n.n.r,s:0};continue}case 3:n=n.up}return{done:!0}}}}function hr(e){var n,t,i=((null===(n=e.r)||void 0===n?void 0:n.d)||0)-((null===(t=e.l)||void 0===t?void 0:t.d)||0),o=i>1?"r":i<-1?"l":"";if(o){var a="r"===o?"l":"r",u=r({},e),s=e[o];e.from=s.from,e.to=s.to,e[o]=s[o],u[o]=s[a],e[a]=u,u.d=pr(u)}e.d=pr(e)}function pr(e){var n=e.r,t=e.l;return(n?t?Math.max(n.d,t.d):n.d:t?t.d:0)+1}function dr(e,n){return a(n).forEach((function(t){e[t]?cr(e[t],n[t]):e[t]=K(n[t])})),e}function vr(e,n){return e.all||n.all||Object.keys(e).some((function(t){return n[t]&&lr(n[t],e[t])}))}h(ur.prototype,((Gt={add:function(e){return cr(this,e),this},addKey:function(e){return sr(this,e,e),this},addKeys:function(e){var n=this;return e.forEach((function(e){return sr(n,e,e)})),this}})[R]=function(){return fr(this)},Gt));var yr={},mr={},gr=!1;function br(e,n){dr(mr,e),gr||(gr=!0,setTimeout((function(){gr=!1;var e=mr;mr={},wr(e,!1)}),0))}function wr(e,n){void 0===n&&(n=!1);var t=new Set;if(e.all)for(var r=0,i=Object.values(yr);r<i.length;r++)_r(u=i[r],e,t,n);else for(var o in e){var a=/^idb\:\/\/(.*)\/(.*)\//.exec(o);if(a){var u,s=a[1],c=a[2];(u=yr["idb://".concat(s,"/").concat(c)])&&_r(u,e,t,n)}}t.forEach((function(e){return e()}))}function _r(e,n,t,r){for(var i=[],o=0,a=Object.entries(e.queries.query);o<a.length;o++){for(var u=a[o],s=u[0],c=[],l=0,f=u[1];l<f.length;l++){var h=f[l];vr(n,h.obsSet)?h.subscribers.forEach((function(e){return t.add(e)})):r&&c.push(h)}r&&i.push([s,c])}if(r)for(var p=0,d=i;p<d.length;p++){var v=d[p];s=v[0],c=v[1],e.queries.query[s]=c}}function xr(e){var n=e._state,t=e._deps.indexedDB;if(n.isBeingOpened||e.idbdb)return n.dbReadyPromise.then((function(){return n.dbOpenError?mn(n.dbOpenError):e}));n.isBeingOpened=!0,n.dbOpenError=null,n.openComplete=!1;var r=n.openCanceller,i=Math.round(10*e.verno),o=!1;function a(){if(n.openCanceller!==r)throw new ee.DatabaseClosed("db.open() was cancelled")}var u=n.dbReadyResolve,s=null,c=!1,l=function(){return new qe((function(r,u){if(a(),!t)throw new ee.MissingAPI;var f=e.name,h=n.autoSchema||!i?t.open(f):t.open(f,i);if(!h)throw new ee.MissingAPI;h.onerror=ht(u),h.onblocked=Xe(e._fireOnBlocked),h.onupgradeneeded=Xe((function(r){if(s=h.transaction,n.autoSchema&&!e._options.allowEmptyDB){h.onerror=pt,s.abort(),h.result.close();var i=t.deleteDatabase(f);i.onsuccess=i.onerror=Xe((function(){u(new ee.NoSuchDatabase("Database ".concat(f," doesnt exist")))}))}else{s.onerror=ht(u);var a=r.oldVersion>Math.pow(2,62)?0:r.oldVersion;c=a<1,e.idbdb=h.result,o&&It(e,s),qt(e,a/10,s,u)}}),u),h.onsuccess=Xe((function(){s=null;var t=e.idbdb=h.result,a=b(t.objectStoreNames);if(a.length>0)try{var u=t.transaction(xt(a),"readonly");if(n.autoSchema)Wt(e,t,u);else if(Jt(e,e._dbSchema,u),!Vt(e,u)&&!o)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),t.close(),i=t.version+1,o=!0,r(l());Kt(e,u)}catch(e){}Cn.push(e),t.onversionchange=Xe((function(t){n.vcFired=!0,e.on("versionchange").fire(t)})),t.onclose=Xe((function(n){e.on("close").fire(n)})),c&&tr(e._deps,f),r()}),u)})).catch((function(e){switch(null==e?void 0:e.name){case"UnknownError":if(n.PR1398_maxLoop>0)return n.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),l();break;case"VersionError":if(i>0)return i=0,l()}return qe.reject(e)}))};return qe.race([r,("undefined"==typeof navigator?qe.resolve():or()).then(l)]).then((function(){return a(),n.onReadyBeingFired=[],qe.resolve(ir((function(){return e.on.ready.fire(e.vip)}))).then((function t(){if(n.onReadyBeingFired.length>0){var r=n.onReadyBeingFired.reduce(he,ie);return n.onReadyBeingFired=[],qe.resolve(ir((function(){return r(e.vip)}))).then(t)}}))})).finally((function(){n.openCanceller===r&&(n.onReadyBeingFired=null,n.isBeingOpened=!1)})).catch((function(t){n.dbOpenError=t;try{s&&s.abort()}catch(e){}return r===n.openCanceller&&e._close(),mn(t)})).finally((function(){n.openComplete=!0,u()})).then((function(){if(c){var n={};e.tables.forEach((function(t){t.schema.indexes.forEach((function(r){r.name&&(n["idb://".concat(e.name,"/").concat(t.name,"/").concat(r.name)]=new ur(-1/0,[[[]]]))})),n["idb://".concat(e.name,"/").concat(t.name,"/")]=n["idb://".concat(e.name,"/").concat(t.name,"/:dels")]=new ur(-1/0,[[[]]])})),yt(dt).fire(n),wr(n,!0)}return e}))}function kr(e){var n=function(n){return e.next(n)},t=function(n){return e.throw(n)},r=o(n),i=o(t);function o(e){return function(n){var t=e(n),o=t.value;return t.done?o:o&&"function"==typeof o.then?o.then(r,i):u(o)?Promise.all(o).then(r,i):r(o)}}return o(n)()}function Cr(e,n,t){var r=arguments.length;if(r<2)throw new ee.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];return t=i.pop(),[e,E(i),t]}function Sr(e,n,t,r,i){return qe.resolve().then((function(){var o=Ke.transless||Ke,a=e._createTransaction(n,t,e._dbSchema,r);a.explicit=!0;var u={trans:a,transless:o};if(r)a.idbtrans=r.idbtrans;else try{a.create(),a.idbtrans._explicit=!0,e._state.PR1398_maxLoop=3}catch(r){return r.name===X.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then((function(){return Sr(e,n,t,null,i)}))):mn(r)}var s,c=H(i);c&&un();var l=qe.follow((function(){if(s=i.call(a,a))if(c){var e=sn.bind(null,null);s.then(e,e)}else"function"==typeof s.next&&"function"==typeof s.throw&&(s=kr(s))}),u);return(s&&"function"==typeof s.then?qe.resolve(s).then((function(e){return a.active?e:mn(new ee.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))})):l.then((function(){return s}))).then((function(e){return r&&a._resolve(),a._completion.then((function(){return e}))})).catch((function(e){return a._reject(e),mn(e)}))}))}function Or(e,n,t){for(var r=u(e)?e.slice():[e],i=0;i<t;++i)r.push(n);return r}function Ar(e){return r(r({},e),{table:function(n){var t=e.table(n),i=t.schema,o={},a=[];function u(e,n,t){var i=Pt(e),s=o[i]=o[i]||[],c=null==e?0:"string"==typeof e?1:e.length,l=n>0,f=r(r({},t),{name:l?"".concat(i,"(virtual-from:").concat(t.name,")"):t.name,lowLevelIndex:t,isVirtual:l,keyTail:n,keyLength:c,extractKey:Ct(e),unique:!l&&t.unique});return s.push(f),f.isPrimaryKey||a.push(f),c>1&&u(2===c?e[0]:e.slice(0,c-1),n+1,t),s.sort((function(e,n){return e.keyTail-n.keyTail})),f}var s=u(i.primaryKey.keyPath,0,i.primaryKey);o[":id"]=[s];for(var c=0,l=i.indexes;c<l.length;c++){var f=l[c];u(f.keyPath,0,f)}function h(e){var n=o[Pt(e)];return n&&n[0]}function p(n,t){return{type:1===n.type?2:n.type,lower:Or(n.lower,n.lowerOpen?e.MAX_KEY:e.MIN_KEY,t),lowerOpen:!0,upper:Or(n.upper,n.upperOpen?e.MIN_KEY:e.MAX_KEY,t),upperOpen:!0}}function d(e){var n=e.query.index;return n.isVirtual?r(r({},e),{query:{index:n.lowLevelIndex,range:p(e.query.range,n.keyTail)}}):e}var v=r(r({},t),{schema:r(r({},i),{primaryKey:s,indexes:a,getIndexByKeyPath:h}),count:function(e){return t.count(d(e))},query:function(e){return t.query(d(e))},openCursor:function(n){var r=n.query.index,i=r.keyTail,o=r.isVirtual,a=r.keyLength;if(!o)return t.openCursor(n);function u(t){function r(r){null!=r?t.continue(Or(r,n.reverse?e.MAX_KEY:e.MIN_KEY,i)):n.unique?t.continue(t.key.slice(0,a).concat(n.reverse?e.MIN_KEY:e.MAX_KEY,i)):t.continue()}var o=Object.create(t,{continue:{value:r},continuePrimaryKey:{value:function(n,r){t.continuePrimaryKey(Or(n,e.MAX_KEY,i),r)}},primaryKey:{get:function(){return t.primaryKey}},key:{get:function(){var e=t.key;return 1===a?e[0]:e.slice(0,a)}},value:{get:function(){return t.value}}});return o}return t.openCursor(d(n)).then((function(e){return e&&u(e)}))}});return v}})}var Pr={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:Ar};function Er(e,n,t,r){return t=t||{},r=r||"",a(e).forEach((function(i){if(f(n,i)){var o=e[i],a=n[i];if("object"==typeof o&&"object"==typeof a&&o&&a){var u=F(o);u!==F(a)?t[r+i]=n[i]:"Object"===u?Er(o,a,t,r+i+"."):o!==a&&(t[r+i]=n[i])}else o!==a&&(t[r+i]=n[i])}else t[r+i]=void 0})),a(n).forEach((function(i){f(e,i)||(t[r+i]=n[i])})),t}function jr(e,n){return"delete"===n.type?n.keys:n.keys||n.values.map(e.extractKey)}var Tr={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return r(r({},e),{table:function(n){var t=e.table(n),o=t.schema.primaryKey,a=r(r({},t),{mutate:function(e){var a=Ke.trans,u=a.table(n).hook,s=u.deleting,c=u.creating,l=u.updating;switch(e.type){case"add":if(c.fire===ie)break;return a._promise("readwrite",(function(){return h(e)}),!0);case"put":if(c.fire===ie&&l.fire===ie)break;return a._promise("readwrite",(function(){return h(e)}),!0);case"delete":if(s.fire===ie)break;return a._promise("readwrite",(function(){return h(e)}),!0);case"deleteRange":if(s.fire===ie)break;return a._promise("readwrite",(function(){return p(e)}),!0)}return t.mutate(e);function h(e){var n=Ke.trans,a=e.keys||jr(o,e);if(!a)throw new Error("Keys missing");return"delete"!==(e="add"===e.type||"put"===e.type?r(r({},e),{keys:a}):r({},e)).type&&(e.values=i([],e.values,!0)),e.keys&&(e.keys=i([],e.keys,!0)),Kr(t,e,a).then((function(r){var i=a.map((function(t,i){var a=r[i],u={onerror:null,onsuccess:null};if("delete"===e.type)s.fire.call(u,t,a,n);else if("add"===e.type||void 0===a){var h=c.fire.call(u,t,e.values[i],n);null==t&&null!=h&&(t=h,e.keys[i]=t,o.outbound||S(e.values[i],o.keyPath,t))}else{var p=Er(a,e.values[i]),d=l.fire.call(u,p,t,a,n);if(d){var v=e.values[i];Object.keys(d).forEach((function(e){f(v,e)?v[e]=d[e]:S(v,e,d[e])}))}}return u}));return t.mutate(e).then((function(n){for(var t=n.failures,o=n.results,u=n.numFailures,s=n.lastResult,c=0;c<a.length;++c){var l=o?o[c]:a[c],f=i[c];null==l?f.onerror&&f.onerror(t[c]):f.onsuccess&&f.onsuccess("put"===e.type&&r[c]?e.values[c]:l)}return{failures:t,results:o,numFailures:u,lastResult:s}})).catch((function(e){return i.forEach((function(n){return n.onerror&&n.onerror(e)})),Promise.reject(e)}))}))}function p(e){return d(e.trans,e.range,1e4)}function d(e,n,i){return t.query({trans:e,values:!1,query:{index:o,range:n},limit:i}).then((function(t){var o=t.result;return h({type:"delete",keys:o,trans:e}).then((function(t){return t.numFailures>0?Promise.reject(t.failures[0]):o.length<i?{failures:[],numFailures:0,lastResult:void 0}:d(e,r(r({},n),{lower:o[o.length-1],lowerOpen:!0}),i)}))}))}}});return a}})}};function Kr(e,n,t){return"add"===n.type?Promise.resolve([]):e.getMany({trans:n.trans,keys:t,cache:"immutable"})}function Nr(e,n,t){try{if(!n)return null;if(n.keys.length<e.length)return null;for(var r=[],i=0,o=0;i<n.keys.length&&o<e.length;++i)0===Kn(n.keys[i],e[o])&&(r.push(t?D(n.values[i]):n.values[i]),++o);return r.length===e.length?r:null}catch(e){return null}}var Mr={stack:"dbcore",level:-1,create:function(e){return{table:function(n){var t=e.table(n);return r(r({},t),{getMany:function(e){if(!e.cache)return t.getMany(e);var n=Nr(e.keys,e.trans._cache,"clone"===e.cache);return n?qe.resolve(n):t.getMany(e).then((function(n){return e.trans._cache={keys:e.keys,values:"clone"===e.cache?D(n):n},n}))},mutate:function(e){return"add"!==e.type&&(e.trans._cache=null),t.mutate(e)}})}}}};function Dr(e,n){return"readonly"===e.trans.mode&&!!e.subscr&&!e.trans.explicit&&"disabled"!==e.trans.db._options.cache&&!n.schema.primaryKey.outbound}function qr(e,n){switch(e){case"query":return n.values&&!n.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Ir={stack:"dbcore",level:0,name:"Observability",create:function(e){var n=e.schema.name,t=new ur(e.MIN_KEY,e.MAX_KEY);return r(r({},e),{transaction:function(n,t,r){if(Ke.subscr&&"readonly"!==t)throw new ee.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Ke.querier));return e.transaction(n,t,r)},table:function(i){var o=e.table(i),s=o.schema,c=s.primaryKey,l=c.extractKey,f=c.outbound,h=r(r({},o),{mutate:function(e){var r=e.trans,a=e.mutatedParts||(e.mutatedParts={}),l=function(e){var t="idb://".concat(n,"/").concat(i,"/").concat(e);return a[t]||(a[t]=new ur)},f=l(""),h=l(":dels"),p=e.type,d="deleteRange"===e.type?[e.range]:"delete"===e.type?[e.keys]:e.values.length<50?[jr(c,e).filter((function(e){return e})),e.values]:[],v=d[0],y=d[1],m=e.trans._cache;if(u(v)){f.addKeys(v);var g="delete"===p||v.length===y.length?Nr(v,m):null;g||h.addKeys(v),(g||y)&&Fr(l,s,g,y)}else if(v){var b={from:v.lower,to:v.upper};h.add(b),f.add(b)}else f.add(t),h.add(t),s.indexes.forEach((function(e){return l(e.name).add(t)}));return o.mutate(e).then((function(n){return!v||"add"!==e.type&&"put"!==e.type||f.addKeys(n.results),r.mutatedParts=dr(r.mutatedParts||{},a),n}))}}),p=function(n){var t,r,i=n.query,o=i.index,a=i.range;return[o,new ur(null!==(t=a.lower)&&void 0!==t?t:e.MIN_KEY,null!==(r=a.upper)&&void 0!==r?r:e.MAX_KEY)]},d={get:function(e){return[c,new ur(e.key)]},getMany:function(e){return[c,(new ur).addKeys(e.keys)]},count:p,query:p,openCursor:p};return a(d).forEach((function(e){h[e]=function(a){var u=Ke.subscr,s=!!u,c=Dr(Ke,o)&&qr(e,a)?a.obsSet={}:u;if(s){var h=function(e){var t="idb://".concat(n,"/").concat(i,"/").concat(e);return c[t]||(c[t]=new ur)},p=h(""),v=h(":dels"),y=d[e](a),m=y[0],g=y[1];if("query"===e&&m.isPrimaryKey&&!a.values?v.add(g):h(m.name||"").add(g),!m.isPrimaryKey){if("count"!==e){var b="query"===e&&f&&a.values&&o.query(r(r({},a),{values:!1}));return o[e].apply(this,arguments).then((function(n){if("query"===e){if(f&&a.values)return b.then((function(e){var t=e.result;return p.addKeys(t),n}));var t=a.values?n.result.map(l):n.result;a.values?p.addKeys(t):v.addKeys(t)}else if("openCursor"===e){var r=n,i=a.values;return r&&Object.create(r,{key:{get:function(){return v.addKey(r.primaryKey),r.key}},primaryKey:{get:function(){var e=r.primaryKey;return v.addKey(e),e}},value:{get:function(){return i&&p.addKey(r.primaryKey),r.value}}})}return n}))}v.add(t)}}return o[e].apply(this,arguments)}})),h}})}};function Fr(e,n,t,r){function i(n){var i=e(n.name||"");function o(e){return null!=e?n.extractKey(e):null}var a=function(e){return n.multiEntry&&u(e)?e.forEach((function(e){return i.addKey(e)})):i.addKey(e)};(t||r).forEach((function(e,n){var i=t&&o(t[n]),u=r&&o(r[n]);0!==Kn(i,u)&&(null!=i&&a(i),null!=u&&a(u))}))}n.indexes.forEach(i)}function Rr(e,n,t){if(0===t.numFailures)return n;if("deleteRange"===n.type)return null;var i=n.keys?n.keys.length:"values"in n&&n.values?n.values.length:1;if(t.numFailures===i)return null;var o=r({},n);return u(o.keys)&&(o.keys=o.keys.filter((function(e,n){return!(n in t.failures)}))),"values"in o&&u(o.values)&&(o.values=o.values.filter((function(e,n){return!(n in t.failures)}))),o}function Lr(e,n){return void 0===n.lower||(n.lowerOpen?Kn(e,n.lower)>0:Kn(e,n.lower)>=0)}function zr(e,n){return void 0===n.upper||(n.upperOpen?Kn(e,n.upper)<0:Kn(e,n.upper)<=0)}function Br(e,n){return Lr(e,n)&&zr(e,n)}function Ur(e,n,t,r,i,o){if(!t||0===t.length)return e;var a=n.query.index,s=a.multiEntry,c=n.query.range,l=r.schema.primaryKey.extractKey,f=a.extractKey,h=(a.lowLevelIndex||a).extractKey,p=t.reduce((function(e,t){var r=e,i="add"===t.type||"put"===t.type?t.values.filter((function(e){var n=f(e);return s&&u(n)?n.some((function(e){return Br(e,c)})):Br(n,c)})).map((function(e){return e=D(e),o&&Object.freeze(e),e})):[];switch(t.type){case"add":r=e.concat(n.values?i:i.map((function(e){return l(e)})));break;case"put":var a=(new ur).addKeys(t.values.map((function(e){return l(e)})));r=e.filter((function(e){var t=n.values?l(e):e;return!lr(new ur(t),a)})).concat(n.values?i:i.map((function(e){return l(e)})));break;case"delete":var h=(new ur).addKeys(t.keys);r=e.filter((function(e){var t=n.values?l(e):e;return!lr(new ur(t),h)}));break;case"deleteRange":var p=t.range;r=e.filter((function(e){return!Br(l(e),p)}))}return r}),e);return p===e?e:(p.sort((function(e,n){return Kn(h(e),h(n))||Kn(l(e),l(n))})),n.limit&&n.limit<1/0&&(p.length>n.limit?p.length=n.limit:e.length===n.limit&&p.length<n.limit&&(i.dirty=!0)),o?Object.freeze(p):p)}function Hr(e,n){return 0===Kn(e.lower,n.lower)&&0===Kn(e.upper,n.upper)&&!!e.lowerOpen==!!n.lowerOpen&&!!e.upperOpen==!!n.upperOpen}function $r(e,n,t,r){if(void 0===e)return void 0!==n?-1:0;if(void 0===n)return 1;var i=Kn(e,n);if(0===i){if(t&&r)return 0;if(t)return 1;if(r)return-1}return i}function Wr(e,n,t,r){if(void 0===e)return void 0!==n?1:0;if(void 0===n)return-1;var i=Kn(e,n);if(0===i){if(t&&r)return 0;if(t)return-1;if(r)return 1}return i}function Vr(e,n){return $r(e.lower,n.lower,e.lowerOpen,n.lowerOpen)<=0&&Wr(e.upper,n.upper,e.upperOpen,n.upperOpen)>=0}function Jr(e,n,t,r){var i=yr["idb://".concat(e,"/").concat(n)];if(!i)return[];var o=i.queries[t];if(!o)return[null,!1,i,null];var a=o[(r.query?r.query.index.name:null)||""];if(!a)return[null,!1,i,null];switch(t){case"query":var u=a.find((function(e){return e.req.limit===r.limit&&e.req.values===r.values&&Hr(e.req.query.range,r.query.range)}));return u?[u,!0,i,a]:[a.find((function(e){return("limit"in e.req?e.req.limit:1/0)>=r.limit&&(!r.values||e.req.values)&&Vr(e.req.query.range,r.query.range)})),!1,i,a];case"count":var s=a.find((function(e){return Hr(e.req.query.range,r.query.range)}));return[s,!!s,i,a]}}function Yr(e,n,t,r){e.subscribers.add(t),r.addEventListener("abort",(function(){e.subscribers.delete(t),0===e.subscribers.size&&Gr(e,n)}))}function Gr(e,n){setTimeout((function(){0===e.subscribers.size&&z(n,e)}),3e3)}var Qr={stack:"dbcore",level:0,name:"Cache",create:function(e){var n=e.schema.name,t=r(r({},e),{transaction:function(t,r,i){var o=e.transaction(t,r,i);if("readwrite"===r){var a=new AbortController,u=a.signal,s=function(i){return function(){if(a.abort(),"readwrite"===r){for(var u=new Set,s=0,c=t;s<c.length;s++){var l=c[s],f=yr["idb://".concat(n,"/").concat(l)];if(f){var h=e.table(l),p=f.optimisticOps.filter((function(e){return e.trans===o}));if(o._explicit&&i&&o.mutatedParts)for(var d=0,v=Object.values(f.queries.query);d<v.length;d++)for(var y=0,m=(w=v[d]).slice();y<m.length;y++)vr((k=m[y]).obsSet,o.mutatedParts)&&(z(w,k),k.subscribers.forEach((function(e){return u.add(e)})));else if(p.length>0){f.optimisticOps=f.optimisticOps.filter((function(e){return e.trans!==o}));for(var g=0,b=Object.values(f.queries.query);g<b.length;g++)for(var w,_=0,x=(w=b[g]).slice();_<x.length;_++){var k;if(null!=(k=x[_]).res&&o.mutatedParts)if(i&&!k.dirty){var C=Object.isFrozen(k.res),S=Ur(k.res,k.req,p,h,k,C);k.dirty?(z(w,k),k.subscribers.forEach((function(e){return u.add(e)}))):S!==k.res&&(k.res=S,k.promise=qe.resolve({result:S}))}else k.dirty&&z(w,k),k.subscribers.forEach((function(e){return u.add(e)}))}}}}u.forEach((function(e){return e()}))}}};o.addEventListener("abort",s(!1),{signal:u}),o.addEventListener("error",s(!1),{signal:u}),o.addEventListener("complete",s(!0),{signal:u})}return o},table:function(t){var i=e.table(t),o=i.schema.primaryKey,a=r(r({},i),{mutate:function(e){var a=Ke.trans;if(o.outbound||"disabled"===a.db._options.cache||a.explicit)return i.mutate(e);var u=yr["idb://".concat(n,"/").concat(t)];if(!u)return i.mutate(e);var s=i.mutate(e);return"add"!==e.type&&"put"!==e.type||!(e.values.length>=50||jr(o,e).some((function(e){return null==e})))?(u.optimisticOps.push(e),e.mutatedParts&&br(e.mutatedParts),s.then((function(n){if(n.numFailures>0){z(u.optimisticOps,e);var t=Rr(u,e,n);t&&u.optimisticOps.push(t),e.mutatedParts&&br(e.mutatedParts)}})),s.catch((function(){z(u.optimisticOps,e),e.mutatedParts&&br(e.mutatedParts)}))):s.then((function(n){var t=r(r({},e),{values:e.values.map((function(e,t){var i,a=(null===(i=o.keyPath)||void 0===i?void 0:i.includes("."))?D(e):r({},e);return S(a,o.keyPath,n.results[t]),a}))}),i=Rr(u,t,n);u.optimisticOps.push(i),queueMicrotask((function(){return e.mutatedParts&&br(e.mutatedParts)}))})),s},query:function(e){var r;if(!Dr(Ke,i)||!qr("query",e))return i.query(e);var o="immutable"===(null===(r=Ke.trans)||void 0===r?void 0:r.db._options.cache),a=Ke,u=a.requery,s=a.signal,c=Jr(n,t,"query",e),l=c[0],f=c[1],h=c[2],p=c[3];if(l&&f)l.obsSet=e.obsSet;else{var d=i.query(e).then((function(e){var n=e.result;if(l&&(l.res=n),o){for(var t=0,r=n.length;t<r;++t)Object.freeze(n[t]);Object.freeze(n)}else e.result=D(n);return e})).catch((function(e){return p&&l&&z(p,l),Promise.reject(e)}));l={obsSet:e.obsSet,promise:d,subscribers:new Set,type:"query",req:e,dirty:!1},p?p.push(l):(p=[l],h||(h=yr["idb://".concat(n,"/").concat(t)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}}),h.queries.query[e.query.index.name||""]=p)}return Yr(l,p,u,s),l.promise.then((function(n){return{result:Ur(n.result,e,null==h?void 0:h.optimisticOps,i,l,o)}}))}});return a}});return t}};function Xr(e,n){return new Proxy(e,{get:function(e,t,r){return"db"===t?n:Reflect.get(e,t,r)}})}var Zr,ei=function(){function e(n,t){var i=this;this._middlewares={},this.verno=0;var o=e.dependencies;this._options=t=r({addons:e.addons,autoOpen:!0,indexedDB:o.indexedDB,IDBKeyRange:o.IDBKeyRange,cache:"cloned"},t),this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange};var a=t.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var u={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ie,dbReadyPromise:null,cancelOpen:ie,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:t.autoOpen};u.dbReadyPromise=new qe((function(e){u.dbReadyResolve=e})),u.openCanceller=new qe((function(e,n){u.cancelOpen=n})),this._state=u,this.name=n,this.on=Fn(this,"populate","blocked","versionchange","close",{ready:[he,ie]}),this.on.ready.subscribe=w(this.on.ready.subscribe,(function(n){return function(t,r){e.vip((function(){var e=i._state;if(e.openComplete)e.dbOpenError||qe.resolve().then(t),r&&n(t);else if(e.onReadyBeingFired)e.onReadyBeingFired.push(t),r&&n(t);else{n(t);var o=i;r||n((function e(){o.on.ready.unsubscribe(t),o.on.ready.unsubscribe(e)}))}}))}})),this.Collection=Zn(this),this.Table=Ln(this),this.Transaction=gt(this),this.Version=Xt(this),this.WhereClause=ft(this),this.on("versionchange",(function(e){e.newVersion>0?console.warn("Another connection wants to upgrade database '".concat(i.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(i.name,"'. Closing db now to resume the delete request.")),i.close({disableAutoOpen:!1})})),this.on("blocked",(function(e){!e.newVersion||e.newVersion<e.oldVersion?console.warn("Dexie.delete('".concat(i.name,"') was blocked")):console.warn("Upgrade '".concat(i.name,"' blocked by other connection holding version ").concat(e.oldVersion/10))})),this._maxKey=kt(t.IDBKeyRange),this._createTransaction=function(e,n,t,r){return new i.Transaction(e,n,t,i._options.chromeTransactionDurability,r)},this._fireOnBlocked=function(e){i.on("blocked").fire(e),Cn.filter((function(e){return e.name===i.name&&e!==i&&!e._state.vcFired})).map((function(n){return n.on("versionchange").fire(e)}))},this.use(Mr),this.use(Qr),this.use(Ir),this.use(Pr),this.use(Tr);var s=new Proxy(this,{get:function(e,n,t){if("_vip"===n)return!0;if("table"===n)return function(e){return Xr(i.table(e),s)};var r=Reflect.get(e,n,t);return r instanceof In?Xr(r,s):"tables"===n?r.map((function(e){return Xr(e,s)})):"_createTransaction"===n?function(){return Xr(r.apply(this,arguments),s)}:r}});this.vip=s,a.forEach((function(e){return e(i)}))}return e.prototype.version=function(e){if(isNaN(e)||e<.1)throw new ee.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new ee.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var n=this._versions,t=n.filter((function(n){return n._cfg.version===e}))[0];return t||(t=new this.Version(e),n.push(t),n.sort(Dt),t.stores({}),this._state.autoSchema=!1,t)},e.prototype._whenReady=function(e){var n=this;return this.idbdb&&(this._state.openComplete||Ke.letThrough||this._vip)?e():new qe((function(e,t){if(n._state.openComplete)return t(new ee.DatabaseClosed(n._state.dbOpenError));if(!n._state.isBeingOpened){if(!n._state.autoOpen)return void t(new ee.DatabaseClosed);n.open().catch(ie)}n._state.dbReadyPromise.then(e,t)})).then(e)},e.prototype.use=function(e){var n=e.stack,t=e.create,r=e.level,i=e.name;i&&this.unuse({stack:n,name:i});var o=this._middlewares[n]||(this._middlewares[n]=[]);return o.push({stack:n,create:t,level:null==r?10:r,name:i}),o.sort((function(e,n){return e.level-n.level})),this},e.prototype.unuse=function(e){var n=e.stack,t=e.name,r=e.create;return n&&this._middlewares[n]&&(this._middlewares[n]=this._middlewares[n].filter((function(e){return r?e.create!==r:!!t&&e.name!==t}))),this},e.prototype.open=function(){var e=this;return dn(Te,(function(){return xr(e)}))},e.prototype._close=function(){var e=this._state,n=Cn.indexOf(this);if(n>=0&&Cn.splice(n,1),this.idbdb){try{this.idbdb.close()}catch(e){}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new qe((function(n){e.dbReadyResolve=n})),e.openCanceller=new qe((function(n,t){e.cancelOpen=t})))},e.prototype.close=function(e){var n=(void 0===e?{disableAutoOpen:!0}:e).disableAutoOpen,t=this._state;n?(t.isBeingOpened&&t.cancelOpen(new ee.DatabaseClosed),this._close(),t.autoOpen=!1,t.dbOpenError=new ee.DatabaseClosed):(this._close(),t.autoOpen=this._options.autoOpen||t.isBeingOpened,t.openComplete=!1,t.dbOpenError=null)},e.prototype.delete=function(e){var n=this;void 0===e&&(e={disableAutoOpen:!0});var t=arguments.length>0&&"object"!=typeof arguments[0],r=this._state;return new qe((function(i,o){var a=function(){n.close(e);var t=n._deps.indexedDB.deleteDatabase(n.name);t.onsuccess=Xe((function(){rr(n._deps,n.name),i()})),t.onerror=ht(o),t.onblocked=n._fireOnBlocked};if(t)throw new ee.InvalidArgument("Invalid closeOptions argument to db.delete()");r.isBeingOpened?r.dbReadyPromise.then(a):a()}))},e.prototype.backendDB=function(){return this.idbdb},e.prototype.isOpen=function(){return null!==this.idbdb},e.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&"DatabaseClosed"===e.name},e.prototype.hasFailed=function(){return null!==this._state.dbOpenError},e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(e.prototype,"tables",{get:function(){var e=this;return a(this._allTables).map((function(n){return e._allTables[n]}))},enumerable:!1,configurable:!0}),e.prototype.transaction=function(){var e=Cr.apply(this,arguments);return this._transaction.apply(this,e)},e.prototype._transaction=function(e,n,t){var r=this,i=Ke.trans;i&&i.db===this&&-1===e.indexOf("!")||(i=null);var o,a,u=-1!==e.indexOf("?");e=e.replace("!","").replace("?","");try{if(a=n.map((function(e){var n=e instanceof r.Table?e.name:e;if("string"!=typeof n)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return n})),"r"==e||e===On)o=On;else{if("rw"!=e&&e!=An)throw new ee.InvalidArgument("Invalid transaction mode: "+e);o=An}if(i){if(i.mode===On&&o===An){if(!u)throw new ee.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");i=null}i&&a.forEach((function(e){if(i&&-1===i.storeNames.indexOf(e)){if(!u)throw new ee.SubTransaction("Table "+e+" not included in parent transaction.");i=null}})),u&&i&&!i.active&&(i=null)}}catch(e){return i?i._promise(null,(function(n,t){t(e)})):mn(e)}var s=Sr.bind(null,this,o,a,i,t);return i?i._promise(o,s,"lock"):Ke.trans?dn(Ke.transless,(function(){return r._whenReady(s)})):this._whenReady(s)},e.prototype.table=function(e){if(!f(this._allTables,e))throw new ee.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},e}(),ni="undefined"!=typeof Symbol&&"observable"in Symbol?Symbol.observable:"@@observable",ti=function(){function e(e){this._subscribe=e}return e.prototype.subscribe=function(e,n,t){return this._subscribe(e&&"function"!=typeof e?e:{next:e,error:n,complete:t})},e.prototype[ni]=function(){return this},e}();try{Zr={indexedDB:o.indexedDB||o.mozIndexedDB||o.webkitIndexedDB||o.msIndexedDB,IDBKeyRange:o.IDBKeyRange||o.webkitIDBKeyRange}}catch(e){Zr={indexedDB:null,IDBKeyRange:null}}function ri(e){var n,t=!1,r=new ti((function(r){var i=H(e);function o(n){var t=$e();try{i&&un();var r=an(e,n);return i&&(r=r.finally(sn)),r}finally{t&&We()}}var a,u=!1,s={},c={},l={get closed(){return u},unsubscribe:function(){u||(u=!0,a&&a.abort(),f&&yt.storagemutated.unsubscribe(d))}};r.start&&r.start(l);var f=!1,h=function(){return yn(v)};function p(){return vr(c,s)}var d=function(e){dr(s,e),p()&&h()},v=function(){if(!u&&Zr.indexedDB){s={};var i={};a&&a.abort(),a=new AbortController;var l={subscr:i,signal:a.signal,requery:h,querier:e,trans:null},p=o(l);Promise.resolve(p).then((function(e){t=!0,n=e,u||l.signal.aborted||(s={},N(c=i)||f||(yt(dt,d),f=!0),yn((function(){return!u&&r.next&&r.next(e)})))}),(function(e){t=!1,["DatabaseClosedError","AbortError"].includes(null==e?void 0:e.name)||u||yn((function(){u||r.error&&r.error(e)}))}))}};return setTimeout(h,0),l}));return r.hasValue=function(){return t},r.getValue=function(){return n},r}var ii=ei;function oi(e){var n=ui;try{ui=!0,yt.storagemutated.fire(e),wr(e,!0)}finally{ui=n}}h(ii,r(r({},re),{delete:function(e){return new ii(e,{addons:[]}).delete()},exists:function(e){return new ii(e,{addons:[]}).open().then((function(e){return e.close(),!0})).catch("NoSuchDatabaseError",(function(){return!1}))},getDatabaseNames:function(e){try{return nr(ii.dependencies).then(e)}catch(e){return mn(new ee.MissingAPI)}},defineClass:function(){function e(e){s(this,e)}return e},ignoreTransaction:function(e){return Ke.trans?dn(Ke.transless,e):e()},vip:ir,async:function(e){return function(){try{var n=kr(e.apply(this,arguments));return n&&"function"==typeof n.then?n:qe.resolve(n)}catch(e){return mn(e)}}},spawn:function(e,n,t){try{var r=kr(e.apply(t,n||[]));return r&&"function"==typeof r.then?r:qe.resolve(r)}catch(e){return mn(e)}},currentTransaction:{get:function(){return Ke.trans||null}},waitFor:function(e,n){var t=qe.resolve("function"==typeof e?ii.ignoreTransaction(e):e).timeout(n||6e4);return Ke.trans?Ke.trans.waitFor(t):t},Promise:qe,debug:{get:function(){return pe},set:function(e){de(e)}},derive:v,extend:s,props:h,override:w,Events:Fn,on:yt,liveQuery:ri,extendObservabilitySet:dr,getByKeyPath:C,setByKeyPath:S,delByKeyPath:O,shallowClone:A,deepClone:D,getObjectDiff:Er,cmp:Kn,asap:x,minKey:_n,addons:[],connections:Cn,errnames:X,dependencies:Zr,cache:yr,semVer:bn,version:bn.split(".").map((function(e){return parseInt(e)})).reduce((function(e,n,t){return e+n/Math.pow(10,2*t)}))})),ii.maxKey=kt(ii.dependencies.IDBKeyRange),"undefined"!=typeof dispatchEvent&&"undefined"!=typeof addEventListener&&(yt(dt,(function(e){var n;ui||(n=new CustomEvent(vt,{detail:e}),ui=!0,dispatchEvent(n),ui=!1)})),addEventListener(vt,(function(e){var n=e.detail;ui||oi(n)})));var ai,ui=!1,si=function(){};function ci(e,n){return new Gn({replacePrefix:[e,n]})}return"undefined"!=typeof BroadcastChannel&&((si=function(){(ai=new BroadcastChannel(vt)).onmessage=function(e){return e.data&&oi(e.data)}})(),"function"==typeof ai.unref&&ai.unref(),yt(dt,(function(e){ui||ai.postMessage(e)}))),"undefined"!=typeof addEventListener&&(addEventListener("pagehide",(function(e){if(!ei.disableBfCache&&e.persisted){pe&&console.debug("Dexie: handling persisted pagehide"),null==ai||ai.close();for(var n=0,t=Cn;n<t.length;n++)t[n].close({disableAutoOpen:!1})}})),addEventListener("pageshow",(function(e){!ei.disableBfCache&&e.persisted&&(pe&&console.debug("Dexie: handling persisted pageshow"),si(),oi({all:new ur(-1/0,[[]])}))}))),qe.rejectionMapper=te,de(pe),r(ei,Object.freeze({__proto__:null,Dexie:ei,liveQuery:ri,Entity:Tn,cmp:Kn,PropModSymbol:Yn,PropModification:Gn,replacePrefix:ci,default:ei,RangeSet:ur,mergeRanges:cr,rangesOverlap:lr}),{default:ei}),ei}();var r=t.exports;const i=Symbol.for("Dexie"),o=globalThis[i]||(globalThis[i]=r);if(r.semVer!==o.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${r.semVer} and ${o.semVer}`);const a=function(e){const n="string"==typeof e?n=>n&&"object"==typeof n&&void 0!==n[e]?n[e]:n:null,t=e=>{let t,r,i,o,a,u=0;return function(){for(i||(i=[].sort.call(arguments,((e,n)=>e.length-n.length)),r=i.length-1,o=[],a=new Map,u=0,t=0);u<=r;u++){const s=i[u].length;for(;t<s;){const s=i[u][t],c=n?n(s):s;if(a.get(c)===u-1)if(u===r){if(o[o.length]=s,a.set(c,0),e)return t++,{value:s}}else a.set(c,u);else 0===u&&a.set(c,0);t++}t=0}return i=null,e?{done:!0}:o}},r=t();return r.iterable=function(...e){const n=t(!0);let r;return{next:()=>r?n():(r=!0,n(...e)),[Symbol.iterator](){return this}}},r}(!0);function u(e,n={}){if(!(this&&"object"==typeof this&&this instanceof u))return new u(e,n);this.collections=e||[],Object.defineProperty(this,"length",{set:function(){},get:function(){let e=1;return this.collections.forEach((function(n){e*=n.length})),e}}),Object.defineProperty(this,"size",{set:function(){},get:function(){return this.length}}),Object.defineProperty(this,"_options",{value:Object.assign({},n)}),Object.defineProperty(this,"_cache",{configurable:!0,value:{}})}function s(e,n,t,r,i,o,a,u,c){var l=t[e],f=t.length-1,h=r[e];if(e==f)for(var p=0;p<h;++p){if(i[e]=l[p],!a||a(i)){var d=i.slice(0);!u||(u[n]=d),o(d,n,c)}n++}else for(p=0;p<h;++p)i[e]=l[p],s(e+1,n,t,r,i,o,a,u,c);i.pop()}u.prototype.asGenerator=function(){const e=this,n=function*e([n,...t]){if(void 0===n)return;const r=t.length>0?e(t):[[]];for(let e of r)for(let t of n)yield[t,...e]}(this.collections);return Object.defineProperty(n,"length",{get:()=>e.length}),n},u.prototype.asArrayLike=function(){const e=this;return new Proxy([],{get:(n,t)=>"length"===t?e.length:"number"==typeof t?e.get(t):n[t]})},u.prototype.add=function(...e){var n=this;return e.forEach((function(e){n.collections.push(e)})),this.flush(),n},u.prototype.push=function(e,n){return this.collections[e].push(n),this.flush(),this},u.prototype.flush=function(e){"number"==typeof e?delete this._cache[e]:Object.defineProperty(this,"_cache",{configurable:!0,value:{}})},u.prototype.get=function(e,{test:n,cache:t}={}){var r=this,i=[],o=1,a=this._cache[e];if(void 0!==a)return a;for(var u,s=[],c=1,l=r.collections.length;l--;c*=u)s[l]=[c,u=r.collections[l].length],o*=r.collections[l].length;return e>=o||(function(e,n,t,r){for(var i=n.length;i--;)r[i]=n[i][(e/t[i][0]<<0)%t[i][1]]}(e,r.collections,s,i),a=i.slice(0),n&&!n(i))?void 0:((!0===t||this._options.cache)&&(this._cache[e]=a),a)},u.has=function(e,{cache:n}={}){return this.get(e,{cache:n})>=0},u.prototype.indexable=function(){return new Proxy(this,{get(e,n){var t=parseInt(n);return t>=0?e.get(t):e[n]}})},u.prototype.indexOf=function(e,{cache:n}={}){for(var t,r=this,i=0,o=[],a=1,u=r.collections.length;u--;a*=t)o[u]=a,t=r.collections[u].length;return r.collections.every((function(n,t){var r=n.indexOf(e[t]);return r>=0&&(i+=r*o[t],!0)}))?((!0===n||this._options.cache)&&(this._cache[i]=e.slice(0)),i):-1},u.prototype.intersection=function(e){var n=[];return this.collections.length!==e.collections.length?new u([],this._options):(this.collections.forEach((function(t,r){n.push(a(t,e.collections[r]))})),new u(n,this._options))},u.prototype.verify=function(e,n,{cache:t}={}){var r=this.get(e,{cache:t});return r&&r.every((function(e,t){return e===n[t]}))},u.prototype.forEach1=function(e,{test:n,cache:t}={}){for(var r=this,i=[],o=r.collections.length;o--;)i[o]=r.collections[o].length;s(0,0,r.collections,i,[],e,n,t?this._cache:null,r)},u.prototype.forEach2=function(e,n){var t=0;do{var r=this.get(t,n);void 0!==r&&e(r,t,cxproduct),t++}while(void 0!==r)},u.prototype.forEach=u.prototype.forEach1;const c=e=>e,l=e=>"string"==typeof e,f=Array.isArray,h=e=>"object"==typeof e&&!!e&&!f(e),p=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),d=(e,n)=>e>n,v=(e,n)=>e<n,y=(e,n,t)=>{let r,i;if(f(e))for(let o=0,a=e.length;o<a;o++){const a=n(e[o]);(void 0===i||t(a,i))&&(r=e[o],i=a)}return r},m=(e,n)=>{const t=y(e,n,d);return void 0===t?t:n(t)},g=e=>m(e,c),b=(e,n)=>y(e,n,v),w=(e,n)=>e.reduce(((e,t)=>e+n(t)),0),_=(e,n)=>{const t={};for(let r=0,i=e.length;r<i;r++){const i=e[r],o=String(n(i));o in t||(t[o]=[]),t[o].push(e[r])}return t},x=e=>{const n=[];return u(e).forEach((e=>n.push(e))),n};function k(e,n,t=c){if(e.length<=1)return e.slice();const r=new Map;for(const i of e){const e=t(i);if(r.has(e)){1===n(r.get(e),i,e)&&(r.delete(e),r.set(e,i))}else r.set(e,i)}return Array.from(r.values())}function C(e,n,t=c){if(e.length<=1)return e.slice();const r=[];let i=0,o=t(e[0]);for(let a=1,u=e.length;a<u;a++){const u=t(e[a]),s=o!==u?0:n(e[i],e[a],o);-1!==s&&(0===s&&r.push(e[i]),o=u,i=a)}return r.push(e[i]),r}const S=(e,...n)=>{const t=new Map,[r,...i]=n;for(const[e,n]of r)t.set(e,n);for(const n of i)for(const[r,i]of n){const n=t.get(r);t.set(r,void 0===n?i:e(n,i))}return t},O=e=>`__duo-toolbox__-${e}`,A=O("action_request"),P=O("ui_event_notification");function E(e,n=!0,t=!1){let r=t?e.normalize("NFD").replace(/\p{M}/gu,""):e;return r=r.normalize("NFC"),n?r.trim().replace(/(\s)\1+/g,"$1"):r}function j(e,n,t){return e.localeCompare(n,t,{ignorePunctuation:!0,numeric:!0,sensitivity:"accent",usage:"sort",caseFirst:"upper"})}function T(e){const n=e.match(/([\p{L}\p{N}]+)/gu);return n?Array.from(n):[]}const K=e=>{const n=new Map;if(e.length<=2)n.set(e,(n.get(e)||0)+1);else for(let t=0,r=e.length-1;t<r;t++){const r=e.substring(t,t+2);n.set(r,(n.get(r)||0)+1)}return n},N=["name","translate","partialReverseTranslate","completeReverseTranslation"],M=["listen","listenTap","listenComplete"],D=["name"],q=["listenTap"],I="compact",F="expanded";var R={exports:{}};(function(e){var n=Object.prototype.hasOwnProperty,t=function(e){for(var t,r=0;r<(arguments.length<=1?0:arguments.length-1);r++)if((t=r+1<1||arguments.length<=r+1?void 0:arguments[r+1])&&"object"==typeof t)for(var i in t)n.call(t,i)&&(e[i]=t[i]);return e},r=function(e){var n=e.length;if(!n)return[];if(1===n)return[e[0]];if(2===n)return[e[0],e[1]];if(3===n)return[e[0],e[1],e[2]];for(var t=new Array(n),r=0;r<n;r++)t[r]=e[r];return t},i=function(e,n){var t="function"==typeof n?n:function(e){return function(n,t){if(n.length!==t.length)return!1;for(var r=0,i=n.length;r<i;r++)if(!e(n[r],t[r]))return!1;return!0}}(e);return function(e,n){for(var r=0;r<e.length;r++)if(t(e[r],n))return r;return-1}},o=function(e,n){return e===n||e!=e&&n!=n},a=function(e,n,t){},u=function(e,n,t){for(var r=t;r--;)e[r+1]=e[r];e[0]=n},s=function(e){var n=i(e.isEqual,e.isMatchingKey);return function(t,r){var i=t.keys[0];t.values[0]=t.values[0].then((function(n){return e.onCacheHit(t,e,r),e.onCacheChange(t,e,r),n})).catch((function(e){var r=n(t.keys,i);throw~r&&(t.keys.splice(r,1),t.values.splice(r,1)),e}))}};function c(e,n){if(e.isMemoized)return e;var c=n||{},l=c.isEqual,f=void 0===l?o:l,h=c.isMatchingKey,p=c.isPromise,d=void 0!==p&&p,v=c.maxSize,y=void 0===v?1:v,m=c.onCacheAdd,g=void 0===m?a:m,b=c.onCacheChange,w=void 0===b?a:b,_=c.onCacheHit,x=void 0===_?a:_,k=c.transformKey,C=function(e,n){if(null==e)return{};var t,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],0<=n.indexOf(t)||(i[t]=e[t]);return i}(c,["isEqual","isMatchingKey","isPromise","maxSize","onCacheAdd","onCacheChange","onCacheHit","transformKey"]),S=t({},C,{isEqual:f,isMatchingKey:h,isPromise:d,maxSize:y,onCacheAdd:g,onCacheChange:w,onCacheHit:x,transformKey:k}),O=i(f,h),A=s(S),P=!(!k&&!h),E={keys:[],get size(){return E.keys.length},values:[]},j=E.keys,T=E.values;function K(){var n=arguments,t=P?r(n):n,i=k?k(t):t,o=O(j,i);if(~o)x(E,S,K),o&&(u(j,j[o],o),u(T,T[o],o),w(E,S,K));else{j.length>=y&&(j.pop(),T.pop());var a=P?i:r(t),s=e.apply(this,n);u(j,a,j.length),u(T,s,T.length),d&&A(E,K),g(E,S,K),w(E,S,K)}return T[0]}return Object.defineProperties(K,{cache:{configurable:!0,get:function(){return E}},cacheSnapshot:{configurable:!0,get:function(){return{keys:r(E.keys),size:E.size,values:r(E.values)}}},isMemoized:{configurable:!0,get:function(){return!0}},options:{configurable:!0,get:function(){return S}}}),K}function l(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];if(n.length)return n.reduce((function(e,n){return"function"==typeof e?"function"==typeof n?function(){return e(n.apply(this,arguments))}:e:"function"==typeof n?n:void 0}))}function f(e,n){for(var t=0;t<e.length;t++)if(e[t].key===n)return t;return-1}function h(e,n){var t="function"==typeof n?n:function(n,t){for(var r=0;r<t.length;r++)if(!e(n[r],t[r]))return!1;return!0};return function(e,n){for(var r=0;r<e.length;r++)if(e[r].length===n.length&&t(e[r],n))return r;return-1}}function p(e){return Array.isArray(e)?e:[e]}function d(e,n,t){var r=f(e,n);~r&&(clearTimeout(e[r].timeoutId),t&&e.splice(r,1))}function v(e,n){var t=setTimeout(e,n);return"function"==typeof t.unref&&t.unref(),t}function y(){q.isCollectingStats=!0}function m(e,n){return e?(n/e*100).toFixed(4)+"%":"0%"}function g(e){if(q.isCollectingStats||I||(console.warn('Stats are not currently being collected, please run "collectStats" to enable them.'),I=!0),e){if(!q.profiles[e])return{calls:0,hits:0,usage:"0%"};var n=q.profiles[e];return Object.assign({},n,{usage:m(n.calls,n.hits)})}var t=Object.keys(q.profiles).reduce((function(e,n){return e.calls+=q.profiles[n].calls,e.hits+=q.profiles[n].hits,e}),{calls:0,hits:0});return Object.assign({},t,{profiles:Object.keys(q.profiles).reduce((function(e,n){return e[n]=g(n),e}),{}),usage:m(t.calls,t.hits)})}function b(e,n){return e&&"object"==typeof e&&n.add(e)}function w(e,n,t,r){for(var i,o=0;o<e.length;o++)if(t((i=e[o])[0],n[0],r)&&t(i[1],n[1],r))return!0;return!1}function _(e,n,t,r){for(var i=0;i<e.length;i++)if(t(e[i],n,r))return!0;return!1}function x(e,n){return e===n||e!=e&&n!=n}function k(e){return e.constructor===Object}function C(e){return"function"==typeof e.then}function S(e){return!(!e.$$typeof||!e._store)}function O(e){return function(n){var t=e||n;return function(e,n,r){void 0===r&&(r=U?new WeakSet:Object.create({_values:[],add:function(e){this._values.push(e)},has:function(e){return!!~this._values.indexOf(e)}}));var i=r.has(e),o=r.has(n);return i||o?i&&o:(b(e,r),b(n,r),t(e,n,r))}}}function A(e){var n=[];return e.forEach((function(e,t){return n.push([t,e])})),n}function P(e){var n=[];return e.forEach((function(e){return n.push(e)})),n}function E(e,n,t,r){var i,o=H(e),a=H(n);if(o.length!==a.length)return!1;for(var u=0;u<o.length;u++){if(!_(a,i=o[u],x))return!1;if(!("_owner"===i&&S(e)&&S(n)||t(e[i],n[i],r)))return!1}return!0}function j(e){var n="function"==typeof e?e(t):t;function t(e,t,r){if(x(e,t))return!0;var i=typeof e;if(i!=typeof t||"object"!=i||!e||!t)return!1;if(k(e)&&k(t))return E(e,t,n,r);var o=$(e),a=$(t);if(o||a)return o===a&&function(e,n,t,r){if(e.length!==n.length)return!1;for(var i=0;i<e.length;i++)if(!t(e[i],n[i],r))return!1;return!0}(e,t,n,r);var u=e instanceof Date,s=t instanceof Date;if(u||s)return u==s&&x(e.getTime(),t.getTime());var c=e instanceof RegExp,l=t instanceof RegExp;if(c||l)return c==l&&function(e,n){return e.source===n.source&&e.global===n.global&&e.ignoreCase===n.ignoreCase&&e.multiline===n.multiline&&e.unicode===n.unicode&&e.sticky===n.sticky&&e.lastIndex===n.lastIndex}(e,t);if(C(e)||C(t))return e===t;if(z){var f=e instanceof Map,h=t instanceof Map;if(f||h)return f==h&&function(e,n,t,r){if(e.size!==n.size)return!1;for(var i=A(e),o=A(n),a=0;a<i.length;a++)if(!w(o,i[a],t,r)||!w(i,o[a],t,r))return!1;return!0}(e,t,n,r)}if(B){var p=e instanceof Set,d=t instanceof Set;if(p||d)return p==d&&function(e,n,t,r){if(e.size!==n.size)return!1;for(var i=P(e),o=P(n),a=0;a<i.length;a++)if(!_(o,i[a],t,r)||!_(i,o[a],t,r))return!1;return!0}(e,t,n,r)}return E(e,t,n,r)}return t}function T(e){return function(n){if(e>=n.length)return n;switch(e){case 0:return[];case 1:return[n[0]];case 2:return[n[0],n[1]];case 3:return[n[0],n[1],n[2]];case 4:return[n[0],n[1],n[2],n[3]];case 5:return[n[0],n[1],n[2],n[3],n[4]]}return Array.prototype.slice.call(n,0,e)}}var K={equals:void 0,isDeepEqual:!1,isPromise:!1,isReact:!1,isSerialized:!1,matchesKey:void 0,maxAge:void 0,maxArgs:void 0,maxSize:1/0,onExpire:void 0,profileName:void 0,serializer:void 0,shouldSerializeFunctions:!1,transformArgs:void 0,updateExpire:!1},N=function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];if(n.length)return n.reduce((function(e,n){return"function"==typeof e?"function"==typeof n?function(){n.apply(this,arguments),e.apply(this,arguments)}:e:"function"==typeof n?n:void 0}))},M=function(e,n){return n===K?e:Object.assign({},e,n,{onCacheAdd:N(e.onCacheAdd,n.onCacheAdd),onCacheChange:N(e.onCacheChange,n.onCacheChange),onCacheHit:N(e.onCacheHit,n.onCacheHit),transformArgs:l(e.transformArgs,n.transformArgs)})},D=function(e,n,t,r){var i=n.maxAge,o=n.updateExpire,a="number"==typeof i&&isFinite(i)?function e(n,t,r,i){var o=t.maxAge,a=t.onCacheChange,u=t.onExpire,s=h(r,i);return function(i,c,l){var h=i.keys[0];if(!~f(n,h)){var p=function(){var o=s(i.keys,h),f=i.values[o];~o&&(i.keys.splice(o,1),i.values.splice(o,1),"function"==typeof a&&a(i,c,l)),d(n,h,!0),"function"==typeof u&&!1===u(h)&&(i.keys.unshift(h),i.values.unshift(f),e(n,t,r)(i,c,l),"function"==typeof a&&a(i,c,l))};n.push({expirationMethod:p,key:h,timeoutId:v(p,o)})}}}(e,n,t,r):void 0;return{onCacheAdd:a,onCacheHit:a&&o?function(e,n){var t=n.maxAge;return function(n){var r=n.keys[0],i=f(e,r);~i&&(d(e,r,!1),e[i].timeoutId=v(e[i].expirationMethod,t))}}(e,n):void 0}},q={anonymousProfileNameCounter:1,isCollectingStats:!1,profiles:{}},I=!1,F=function(e){var n=(new Error).stack,t=e.displayName||e.name||"Anonymous "+q.anonymousProfileNameCounter++;if(!n)return t;for(var r,i,o=n.split("\n").slice(3),a=0;a<o.length;a++)if(!~(r=o[a]).indexOf("/moize/")&&!~r.indexOf(" (native)")&&!~r.indexOf(" Function.")){i=r.replace(/\n/g,"\\n").trim();break}return i?t+" "+i:t},R=function(e){return q.isCollectingStats?{onCacheAdd:function(e){var n=e.profileName;return q.profiles[n]||(q.profiles[n]={calls:0,hits:0}),function(){q.profiles[n].calls++}}(e),onCacheHit:function(e){var n=e.profileName;return function(){q.profiles[n].calls++,q.profiles[n].hits++}}(e)}:{}},L=function(e,n){return function(e,n){var t=n.expirations,r=e.options,i=r.isEqual,o=r.isMatchingKey,a=r.onCacheAdd,s=r.onCacheChange,c=r.transformKey,l=h(i,o);e.add=function(n,t){var r=c?c(n):n;~l(e.cache.keys,r)||(e.cache.size>=e.options.maxSize&&(e.cache.keys.pop(),e.cache.values.pop()),e.cache.keys.unshift(r),e.cache.values.unshift(t),a(e.cache,e.options,e),s(e.cache,e.options,e))},e.clear=function(){e.cache.keys.length=0,e.cache.values.length=0,s(e.cache,e.options,e)},e.get=function(n){var t=l(e.cache.keys,c?c(n):n);return~t?e.apply(this,e.cache.keys[t]):void 0},e.getStats=function(){return g(e.options.profileName)},e.has=function(n){return!!~l(e.cache.keys,c?c(n):n)},e.keys=function(){return e.cacheSnapshot.keys},e.remove=function(n){var r=l(e.cache.keys,c?c(n):n);if(~r){var i=e.cache.keys[r];e.cache.keys.splice(r,1),e.cache.values.splice(r,1),s(e.cache,e.options,e),d(t,i,!0)}},e.update=function(n,t){var r=l(e.cache.keys,c?c(n):n);if(~r){var i=e.cache.keys[r];u(e.cache.keys,i,r),u(e.cache.values,t,r),s(e.cache,e.options,e)}},e.values=function(){return e.cacheSnapshot.values}}(e,n),function(e,n){var t=n.expirations,r=n.options,i=n.originalFunction,o=e.options;Object.defineProperties(e,{_microMemoizeOptions:{configurable:!0,get:function(){return o}},expirations:{configurable:!0,get:function(){return t}},expirationsSnapshot:{configurable:!0,get:function(){return t.slice(0)}},isCollectingStats:{configurable:!0,get:function(){return q.isCollectingStats}},isMoized:{configurable:!0,get:function(){return!0}},options:{configurable:!0,get:function(){return r}},originalFunction:{configurable:!0,get:function(){return i}}}),r.isReact&&(e.contextTypes=i.contextTypes,e.defaultProps=i.defaultProps,e.displayName="Moized("+(i.displayName||i.name||"Component")+")",e.propTypes=i.propTypes)}(e,n),e},z="function"==typeof Map,B="function"==typeof Set,U="function"==typeof WeakSet,H=Object.keys,$=Array.isArray,W=(j(O()),j(O(x)),j()),V=j((function(){return x}));function J(e,n,t){return"[ref-"+t+"]"}var Y=function(e,n){if(e[0]===n)return 0;for(var t=e.length,r=1;r<t;r++)if(e[r]===n)return r;return-1};function G(e,n){var t=n||J,r="function"==typeof e,i=[];return function(n,o){if("object"==typeof o)if(i.length){var a=Y(i,this)+1;a?i=function(e,n){for(var t=new Array(n),r=0;r<n;r++)t[r]=e[r];return t}(i,a):i[i.length]=this;var u=Y(i,o);if(~u)return t.call(this,n,o,u)}else i[0]=o;return r?e.call(this,n,o):o}}function Q(e,n){return"function"==typeof n?""+n:n}function X(e,n){try{return JSON.stringify(e,n)}catch(t){return function(e,n,t,r){return JSON.stringify(e,G(n,r),t)}(e,n)}}function Z(e){return"function"==typeof e.serializer?l(p,e.serializer):function(e){var n=e.shouldSerializeFunctions?Q:null;return function(e){for(var t,r,i="|",o=0;o<e.length;o++)i+=(r=typeof(t=e[o]),(!t||"object"!=r&&"function"!=r?t:X(t,n))+"|");return[i]}}(e)}function ee(e,n){return e[0]===n[0]}var ne=function(e){if("function"==typeof e)return function(n,t,r){return e(r.cache,r.options,r)}},te=function(e){var n=e.equals,t=e.isDeepEqual,r=e.isReact;return n||t&&W||r&&V||x},re=function(e){var n=e.isSerialized;return e.matchesKey||n&&ee||void 0},ie=function(e){var n=e.maxArgs,t=e.isReact,r=e.isSerialized,i=e.transformArgs;return l(r&&Z(e),"function"==typeof i&&l(p,i),t&&T(2),"number"==typeof n&&T(n))};function oe(e,n){if(void 0===n&&(n=K),e.isMoized)return oe(e.originalFunction,M(e.options,n));if("object"==typeof e)return function(n,t){return void 0===t&&(t={}),"function"==typeof n?oe(n,M(e,t)):oe(M(e,n))};var t=Object.assign({},K,n,{maxArgs:"number"==typeof n.maxArgs&&0<=n.maxArgs?n.maxArgs:K.maxArgs,maxSize:"number"==typeof n.maxSize&&0<=n.maxSize?n.maxSize:K.maxSize,profileName:n.profileName||F(e)}),r=[],i=(t.equals,t.isDeepEqual,t.isPromise),o=(t.isReact,t.isSerialized,t.matchesKey,t.maxAge,t.maxArgs,t.maxSize),a=t.onCacheAdd,u=t.onCacheChange,s=t.onCacheHit,l=(t.onExpire,t.profileName,t.shouldSerializeFunctions,t.serializer,t.transformArgs,t.updateExpire,function(e,n){if(null==e)return{};var t,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],0<=n.indexOf(t)||(i[t]=e[t]);return i}(t,["equals","isDeepEqual","isPromise","isReact","isSerialized","matchesKey","maxAge","maxArgs","maxSize","onCacheAdd","onCacheChange","onCacheHit","onExpire","profileName","shouldSerializeFunctions","serializer","transformArgs","updateExpire"])),f=te(t),h=re(t),p=D(r,t,f,h),d=R(t),v=ie(t),y=Object.assign({},l,{isEqual:f,isMatchingKey:h,isPromise:i,maxSize:o,onCacheAdd:ne(N(a,p.onCacheAdd,d.onCacheAdd)),onCacheChange:ne(u),onCacheHit:ne(N(s,p.onCacheHit,d.onCacheHit)),transformKey:v});return L(c(e,y),{expirations:r,options:t,originalFunction:e})}oe.collectStats=y,oe.compose=function(){return l.apply(null,arguments)||oe},oe.deep=oe({isDeepEqual:!0}),oe.getStats=g,oe.isCollectingStats=function(){return q.isCollectingStats},oe.isMoized=function(e){return"function"==typeof e&&!!e.isMoized},oe.maxAge=function(e){return oe({maxAge:e})},oe.maxArgs=function(e){return oe({maxArgs:e})},oe.maxSize=function(e){return oe({maxSize:e})},oe.promise=oe({isPromise:!0,updateExpire:!0}),oe.react=oe({isReact:!0}),oe.reactSimple=oe({isReact:!0,maxSize:1}),oe.serialize=oe({isSerialized:!0}),oe.simple=oe({maxSize:1}),e.collectStats=y,e.default=oe,Object.defineProperty(e,"__esModule",{value:!0})})(R.exports);var L=n(R.exports),z={exports:{}};
/*!

	 diff v4.0.1

	Software License Agreement (BSD License)

	Copyright (c) 2009-2015, Kevin Decker <kpdecker@gmail.com>

	All rights reserved.

	Redistribution and use of this software in source and binary forms, with or without modification,
	are permitted provided that the following conditions are met:

	* Redistributions of source code must retain the above
	  copyright notice, this list of conditions and the
	  following disclaimer.

	* Redistributions in binary form must reproduce the above
	  copyright notice, this list of conditions and the
	  following disclaimer in the documentation and/or other
	  materials provided with the distribution.

	* Neither the name of Kevin Decker nor the names of its
	  contributors may be used to endorse or promote products
	  derived from this software without specific prior
	  written permission.

	THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR
	IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
	FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR
	CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
	DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
	DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER
	IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT
	OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
	@license
	*/
!function(e,n){!function(e){function n(){}function t(e,n,t,r,i){for(var o=0,a=n.length,u=0,s=0;o<a;o++){var c=n[o];if(c.removed){if(c.value=e.join(r.slice(s,s+c.count)),s+=c.count,o&&n[o-1].added){var l=n[o-1];n[o-1]=n[o],n[o]=l}}else{if(!c.added&&i){var f=t.slice(u,u+c.count);f=f.map((function(e,n){var t=r[s+n];return t.length>e.length?t:e})),c.value=e.join(f)}else c.value=e.join(t.slice(u,u+c.count));u+=c.count,c.added||(s+=c.count)}}var h=n[a-1];return a>1&&"string"==typeof h.value&&(h.added||h.removed)&&e.equals("",h.value)&&(n[a-2].value+=h.value,n.pop()),n}function r(e){return{newPos:e.newPos,components:e.components.slice(0)}}n.prototype={diff:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=i.callback;"function"==typeof i&&(o=i,i={}),this.options=i;var a=this;function u(e){return o?(setTimeout((function(){o(void 0,e)}),0),!0):e}e=this.castInput(e),n=this.castInput(n),e=this.removeEmpty(this.tokenize(e));var s=(n=this.removeEmpty(this.tokenize(n))).length,c=e.length,l=1,f=s+c,h=[{newPos:-1,components:[]}],p=this.extractCommon(h[0],n,e,0);if(h[0].newPos+1>=s&&p+1>=c)return u([{value:this.join(n),count:n.length}]);function d(){for(var i=-1*l;i<=l;i+=2){var o=void 0,f=h[i-1],p=h[i+1],d=(p?p.newPos:0)-i;f&&(h[i-1]=void 0);var v=f&&f.newPos+1<s,y=p&&0<=d&&d<c;if(v||y){if(!v||y&&f.newPos<p.newPos?(o=r(p),a.pushComponent(o.components,void 0,!0)):((o=f).newPos++,a.pushComponent(o.components,!0,void 0)),d=a.extractCommon(o,n,e,i),o.newPos+1>=s&&d+1>=c)return u(t(a,o.components,n,e,a.useLongestToken));h[i]=o}else h[i]=void 0}l++}if(o)!function e(){setTimeout((function(){if(l>f)return o();d()||e()}),0)}();else for(;l<=f;){var v=d();if(v)return v}},pushComponent:function(e,n,t){var r=e[e.length-1];r&&r.added===n&&r.removed===t?e[e.length-1]={count:r.count+1,added:n,removed:t}:e.push({count:1,added:n,removed:t})},extractCommon:function(e,n,t,r){for(var i=n.length,o=t.length,a=e.newPos,u=a-r,s=0;a+1<i&&u+1<o&&this.equals(n[a+1],t[u+1]);)a++,u++,s++;return s&&e.components.push({count:s}),e.newPos=a,u},equals:function(e,n){return this.options.comparator?this.options.comparator(e,n):e===n||this.options.ignoreCase&&e.toLowerCase()===n.toLowerCase()},removeEmpty:function(e){for(var n=[],t=0;t<e.length;t++)e[t]&&n.push(e[t]);return n},castInput:function(e){return e},tokenize:function(e){return e.split("")},join:function(e){return e.join("")}};var i=new n;function o(e,n,t){return i.diff(e,n,t)}function a(e,n){if("function"==typeof e)n.callback=e;else if(e)for(var t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}var u=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,s=/\S/,c=new n;function l(e,n,t){return t=a(t,{ignoreWhitespace:!0}),c.diff(e,n,t)}function f(e,n,t){return c.diff(e,n,t)}c.equals=function(e,n){return this.options.ignoreCase&&(e=e.toLowerCase(),n=n.toLowerCase()),e===n||this.options.ignoreWhitespace&&!s.test(e)&&!s.test(n)},c.tokenize=function(e){for(var n=e.split(/(\s+|[()[\]{}'"]|\b)/),t=0;t<n.length-1;t++)!n[t+1]&&n[t+2]&&u.test(n[t])&&u.test(n[t+2])&&(n[t]+=n[t+2],n.splice(t+1,2),t--);return n};var h=new n;function p(e,n,t){return h.diff(e,n,t)}function d(e,n,t){var r=a(t,{ignoreWhitespace:!0});return h.diff(e,n,r)}h.tokenize=function(e){var n=[],t=e.split(/(\n|\r\n)/);t[t.length-1]||t.pop();for(var r=0;r<t.length;r++){var i=t[r];r%2&&!this.options.newlineIsToken?n[n.length-1]+=i:(this.options.ignoreWhitespace&&(i=i.trim()),n.push(i))}return n};var v=new n;function y(e,n,t){return v.diff(e,n,t)}v.tokenize=function(e){return e.split(/(\S.+?[.!?])(?=\s+|$)/)};var m=new n;function g(e,n,t){return m.diff(e,n,t)}function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function w(e){return _(e)||x(e)||k()}function _(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}function x(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function k(){throw new TypeError("Invalid attempt to spread non-iterable instance")}m.tokenize=function(e){return e.split(/([{}:;,]|\s+)/)};var C=Object.prototype.toString,S=new n;function O(e,n,t){return S.diff(e,n,t)}function A(e,n,t,r,i){var o,a;for(n=n||[],t=t||[],r&&(e=r(i,e)),o=0;o<n.length;o+=1)if(n[o]===e)return t[o];if("[object Array]"===C.call(e)){for(n.push(e),a=new Array(e.length),t.push(a),o=0;o<e.length;o+=1)a[o]=A(e[o],n,t,r,i);return n.pop(),t.pop(),a}if(e&&e.toJSON&&(e=e.toJSON()),"object"===b(e)&&null!==e){n.push(e),a={},t.push(a);var u,s=[];for(u in e)e.hasOwnProperty(u)&&s.push(u);for(s.sort(),o=0;o<s.length;o+=1)a[u=s[o]]=A(e[u],n,t,r,u);n.pop(),t.pop()}else a=e;return a}S.useLongestToken=!0,S.tokenize=h.tokenize,S.castInput=function(e){var n=this.options,t=n.undefinedReplacement,r=n.stringifyReplacer,i=void 0===r?function(e,n){return void 0===n?t:n}:r;return"string"==typeof e?e:JSON.stringify(A(e,null,null,i),i,"  ")},S.equals=function(e,t){return n.prototype.equals.call(S,e.replace(/,([\r\n])/g,"$1"),t.replace(/,([\r\n])/g,"$1"))};var P=new n;function E(e,n,t){return P.diff(e,n,t)}function j(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=e.split(/\r\n|[\n\v\f\r\x85]/),r=e.match(/\r\n|[\n\v\f\r\x85]/g)||[],i=[],o=0;function a(){var e={};for(i.push(e);o<t.length;){var r=t[o];if(/^(\-\-\-|\+\+\+|@@)\s/.test(r))break;var a=/^(?:Index:|diff(?: -r \w+)+)\s+(.+?)\s*$/.exec(r);a&&(e.index=a[1]),o++}for(u(e),u(e),e.hunks=[];o<t.length;){var c=t[o];if(/^(Index:|diff|\-\-\-|\+\+\+)\s/.test(c))break;if(/^@@/.test(c))e.hunks.push(s());else{if(c&&n.strict)throw new Error("Unknown line "+(o+1)+" "+JSON.stringify(c));o++}}}function u(e){var n=/^(---|\+\+\+)\s+(.*)$/.exec(t[o]);if(n){var r="---"===n[1]?"old":"new",i=n[2].split("\t",2),a=i[0].replace(/\\\\/g,"\\");/^".*"$/.test(a)&&(a=a.substr(1,a.length-2)),e[r+"FileName"]=a,e[r+"Header"]=(i[1]||"").trim(),o++}}function s(){for(var e=o,i=t[o++].split(/@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/),a={oldStart:+i[1],oldLines:+i[2]||1,newStart:+i[3],newLines:+i[4]||1,lines:[],linedelimiters:[]},u=0,s=0;o<t.length&&!(0===t[o].indexOf("--- ")&&o+2<t.length&&0===t[o+1].indexOf("+++ ")&&0===t[o+2].indexOf("@@"));o++){var c=0==t[o].length&&o!=t.length-1?" ":t[o][0];if("+"!==c&&"-"!==c&&" "!==c&&"\\"!==c)break;a.lines.push(t[o]),a.linedelimiters.push(r[o]||"\n"),"+"===c?u++:"-"===c?s++:" "===c&&(u++,s++)}if(u||1!==a.newLines||(a.newLines=0),s||1!==a.oldLines||(a.oldLines=0),n.strict){if(u!==a.newLines)throw new Error("Added line count did not match for hunk at line "+(e+1));if(s!==a.oldLines)throw new Error("Removed line count did not match for hunk at line "+(e+1))}return a}for(;o<t.length;)a();return i}function T(e,n,t){var r=!0,i=!1,o=!1,a=1;return function u(){if(r&&!o){if(i?a++:r=!1,e+a<=t)return a;o=!0}if(!i)return o||(r=!0),n<=e-a?-a++:(i=!0,u())}}function K(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("string"==typeof n&&(n=j(n)),Array.isArray(n)){if(n.length>1)throw new Error("applyPatch only works with a single input.");n=n[0]}var r,i,o=e.split(/\r\n|[\n\v\f\r\x85]/),a=e.match(/\r\n|[\n\v\f\r\x85]/g)||[],u=n.hunks,s=t.compareLine||function(e,n,t,r){return n===r},c=0,l=t.fuzzFactor||0,f=0,h=0;function p(e,n){for(var t=0;t<e.lines.length;t++){var r=e.lines[t],i=r.length>0?r[0]:" ",a=r.length>0?r.substr(1):r;if(" "===i||"-"===i){if(!s(n+1,o[n],i,a)&&++c>l)return!1;n++}}return!0}for(var d=0;d<u.length;d++){for(var v=u[d],y=o.length-v.oldLines,m=0,g=h+v.oldStart-1,b=T(g,f,y);void 0!==m;m=b())if(p(v,g+m)){v.offset=h+=m;break}if(void 0===m)return!1;f=v.offset+v.oldStart+v.oldLines}for(var w=0,_=0;_<u.length;_++){var x=u[_],k=x.oldStart+x.offset+w-1;w+=x.newLines-x.oldLines,k<0&&(k=0);for(var C=0;C<x.lines.length;C++){var S=x.lines[C],O=S.length>0?S[0]:" ",A=S.length>0?S.substr(1):S,P=x.linedelimiters[C];if(" "===O)k++;else if("-"===O)o.splice(k,1),a.splice(k,1);else if("+"===O)o.splice(k,0,A),a.splice(k,0,P),k++;else if("\\"===O){var E=x.lines[C-1]?x.lines[C-1][0]:null;"+"===E?r=!0:"-"===E&&(i=!0)}}}if(r)for(;!o[o.length-1];)o.pop(),a.pop();else i&&(o.push(""),a.push("\n"));for(var K=0;K<o.length-1;K++)o[K]=o[K]+a[K];return o.join("")}function N(e,n){"string"==typeof e&&(e=j(e));var t=0;function r(){var i=e[t++];if(!i)return n.complete();n.loadFile(i,(function(e,t){if(e)return n.complete(e);var o=K(t,i,n);n.patched(i,o,(function(e){if(e)return n.complete(e);r()}))}))}r()}function M(e,n,t,r,i,o,a){a||(a={}),void 0===a.context&&(a.context=4);var u=p(t,r,a);function s(e){return e.map((function(e){return" "+e}))}u.push({value:"",lines:[]});for(var c=[],l=0,f=0,h=[],d=1,v=1,y=function(e){var n=u[e],i=n.lines||n.value.replace(/\n$/,"").split("\n");if(n.lines=i,n.added||n.removed){var o;if(!l){var p=u[e-1];l=d,f=v,p&&(h=a.context>0?s(p.lines.slice(-a.context)):[],l-=h.length,f-=h.length)}(o=h).push.apply(o,w(i.map((function(e){return(n.added?"+":"-")+e})))),n.added?v+=i.length:d+=i.length}else{if(l)if(i.length<=2*a.context&&e<u.length-2){var y;(y=h).push.apply(y,w(s(i)))}else{var m,g=Math.min(i.length,a.context);(m=h).push.apply(m,w(s(i.slice(0,g))));var b={oldStart:l,oldLines:d-l+g,newStart:f,newLines:v-f+g,lines:h};if(e>=u.length-2&&i.length<=a.context){var _=/\n$/.test(t),x=/\n$/.test(r),k=0==i.length&&h.length>b.oldLines;!_&&k&&h.splice(b.oldLines,0,"\\ No newline at end of file"),(_||k)&&x||h.push("\\ No newline at end of file")}c.push(b),l=0,f=0,h=[]}d+=i.length,v+=i.length}},m=0;m<u.length;m++)y(m);return{oldFileName:e,newFileName:n,oldHeader:i,newHeader:o,hunks:c}}function D(e,n,t,r,i,o,a){var u=M(e,n,t,r,i,o,a),s=[];e==n&&s.push("Index: "+e),s.push("==================================================================="),s.push("--- "+u.oldFileName+(void 0===u.oldHeader?"":"\t"+u.oldHeader)),s.push("+++ "+u.newFileName+(void 0===u.newHeader?"":"\t"+u.newHeader));for(var c=0;c<u.hunks.length;c++){var l=u.hunks[c];s.push("@@ -"+l.oldStart+","+l.oldLines+" +"+l.newStart+","+l.newLines+" @@"),s.push.apply(s,l.lines)}return s.join("\n")+"\n"}function q(e,n,t,r,i,o){return D(e,e,n,t,r,i,o)}function I(e,n){return e.length===n.length&&F(e,n)}function F(e,n){if(n.length>e.length)return!1;for(var t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function R(e){var n=te(e.lines),t=n.oldLines,r=n.newLines;void 0!==t?e.oldLines=t:delete e.oldLines,void 0!==r?e.newLines=r:delete e.newLines}function L(e,n,t){e=z(e,t),n=z(n,t);var r={};(e.index||n.index)&&(r.index=e.index||n.index),(e.newFileName||n.newFileName)&&(B(e)?B(n)?(r.oldFileName=U(r,e.oldFileName,n.oldFileName),r.newFileName=U(r,e.newFileName,n.newFileName),r.oldHeader=U(r,e.oldHeader,n.oldHeader),r.newHeader=U(r,e.newHeader,n.newHeader)):(r.oldFileName=e.oldFileName,r.newFileName=e.newFileName,r.oldHeader=e.oldHeader,r.newHeader=e.newHeader):(r.oldFileName=n.oldFileName||e.oldFileName,r.newFileName=n.newFileName||e.newFileName,r.oldHeader=n.oldHeader||e.oldHeader,r.newHeader=n.newHeader||e.newHeader)),r.hunks=[];for(var i=0,o=0,a=0,u=0;i<e.hunks.length||o<n.hunks.length;){var s=e.hunks[i]||{oldStart:1/0},c=n.hunks[o]||{oldStart:1/0};if(H(s,c))r.hunks.push($(s,a)),i++,u+=s.newLines-s.oldLines;else if(H(c,s))r.hunks.push($(c,u)),o++,a+=c.newLines-c.oldLines;else{var l={oldStart:Math.min(s.oldStart,c.oldStart),oldLines:0,newStart:Math.min(s.newStart+a,c.oldStart+u),newLines:0,lines:[]};W(l,s.oldStart,s.lines,c.oldStart,c.lines),o++,i++,r.hunks.push(l)}}return r}function z(e,n){if("string"==typeof e){if(/^@@/m.test(e)||/^Index:/m.test(e))return j(e)[0];if(!n)throw new Error("Must provide a base reference or pass in a patch");return M(void 0,void 0,n,e)}return e}function B(e){return e.newFileName&&e.newFileName!==e.oldFileName}function U(e,n,t){return n===t?n:(e.conflict=!0,{mine:n,theirs:t})}function H(e,n){return e.oldStart<n.oldStart&&e.oldStart+e.oldLines<n.oldStart}function $(e,n){return{oldStart:e.oldStart,oldLines:e.oldLines,newStart:e.newStart+n,newLines:e.newLines,lines:e.lines}}function W(e,n,t,r,i){var o={offset:n,lines:t,index:0},a={offset:r,lines:i,index:0};for(G(e,o,a),G(e,a,o);o.index<o.lines.length&&a.index<a.lines.length;){var u=o.lines[o.index],s=a.lines[a.index];if("-"!==u[0]&&"+"!==u[0]||"-"!==s[0]&&"+"!==s[0])if("+"===u[0]&&" "===s[0]){var c;(c=e.lines).push.apply(c,w(X(o)))}else if("+"===s[0]&&" "===u[0]){var l;(l=e.lines).push.apply(l,w(X(a)))}else"-"===u[0]&&" "===s[0]?J(e,o,a):"-"===s[0]&&" "===u[0]?J(e,a,o,!0):u===s?(e.lines.push(u),o.index++,a.index++):Y(e,X(o),X(a));else V(e,o,a)}Q(e,o),Q(e,a),R(e)}function V(e,n,t){var r=X(n),i=X(t);if(ee(r)&&ee(i)){var o,a;if(F(r,i)&&ne(t,r,r.length-i.length))return void(o=e.lines).push.apply(o,w(r));if(F(i,r)&&ne(n,i,i.length-r.length))return void(a=e.lines).push.apply(a,w(i))}else if(I(r,i)){var u;return void(u=e.lines).push.apply(u,w(r))}Y(e,r,i)}function J(e,n,t,r){var i,o=X(n),a=Z(t,o);a.merged?(i=e.lines).push.apply(i,w(a.merged)):Y(e,r?a:o,r?o:a)}function Y(e,n,t){e.conflict=!0,e.lines.push({conflict:!0,mine:n,theirs:t})}function G(e,n,t){for(;n.offset<t.offset&&n.index<n.lines.length;){var r=n.lines[n.index++];e.lines.push(r),n.offset++}}function Q(e,n){for(;n.index<n.lines.length;){var t=n.lines[n.index++];e.lines.push(t)}}function X(e){for(var n=[],t=e.lines[e.index][0];e.index<e.lines.length;){var r=e.lines[e.index];if("-"===t&&"+"===r[0]&&(t="+"),t!==r[0])break;n.push(r),e.index++}return n}function Z(e,n){for(var t=[],r=[],i=0,o=!1,a=!1;i<n.length&&e.index<e.lines.length;){var u=e.lines[e.index],s=n[i];if("+"===s[0])break;if(o=o||" "!==u[0],r.push(s),i++,"+"===u[0])for(a=!0;"+"===u[0];)t.push(u),u=e.lines[++e.index];s.substr(1)===u.substr(1)?(t.push(u),e.index++):a=!0}if("+"===(n[i]||"")[0]&&o&&(a=!0),a)return t;for(;i<n.length;)r.push(n[i++]);return{merged:r,changes:t}}function ee(e){return e.reduce((function(e,n){return e&&"-"===n[0]}),!0)}function ne(e,n,t){for(var r=0;r<t;r++){var i=n[n.length-t+r].substr(1);if(e.lines[e.index+r]!==" "+i)return!1}return e.index+=t,!0}function te(e){var n=0,t=0;return e.forEach((function(e){if("string"!=typeof e){var r=te(e.mine),i=te(e.theirs);void 0!==n&&(r.oldLines===i.oldLines?n+=r.oldLines:n=void 0),void 0!==t&&(r.newLines===i.newLines?t+=r.newLines:t=void 0)}else void 0===t||"+"!==e[0]&&" "!==e[0]||t++,void 0===n||"-"!==e[0]&&" "!==e[0]||n++})),{oldLines:n,newLines:t}}function re(e){for(var n,t,r=[],i=0;i<e.length;i++)t=(n=e[i]).added?1:n.removed?-1:0,r.push([t,n.value]);return r}function ie(e){for(var n=[],t=0;t<e.length;t++){var r=e[t];r.added?n.push("<ins>"):r.removed&&n.push("<del>"),n.push(oe(r.value)),r.added?n.push("</ins>"):r.removed&&n.push("</del>")}return n.join("")}function oe(e){var n=e;return n=(n=(n=(n=n.replace(/&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/"/g,"&quot;")}P.tokenize=function(e){return e.slice()},P.join=P.removeEmpty=function(e){return e},e.Diff=n,e.diffChars=o,e.diffWords=l,e.diffWordsWithSpace=f,e.diffLines=p,e.diffTrimmedLines=d,e.diffSentences=y,e.diffCss=g,e.diffJson=O,e.diffArrays=E,e.structuredPatch=M,e.createTwoFilesPatch=D,e.createPatch=q,e.applyPatch=K,e.applyPatches=N,e.parsePatch=j,e.merge=L,e.convertChangesToDMP=re,e.convertChangesToXML=ie,e.canonicalize=A,Object.defineProperty(e,"__esModule",{value:!0})}(n)}(0,z.exports);var B=n(z.exports);function U(e){return null===e?"null":e!==Object(e)?typeof e:{}.toString.call(e).slice(8,-1).toLowerCase()}function H(e){return"string"!==U(e)||!e.length}function $(e="",n,t){if(H(e))return!1;const r=e.charCodeAt(0);return n<=r&&r<=t}const W=12353,V=12438,J=12449,Y=12540,G=19968,Q=40879,X=12540,Z=[65313,65338],ee=[65345,65370],ne=[65377,65381],te=[[12288,12351],ne,[12539,12540],[65281,65295],[65306,65311],[65339,65343],[65371,65376],[65504,65518]],re=[...[[12352,12447],[12448,12543],ne,[65382,65439]],...te,Z,ee,[65296,65305],[19968,40959],[13312,19903]],ie=[[0,127],[256,257],[274,275],[298,299],[332,333],[362,363]],oe=[[32,47],[58,63],[91,96],[123,126],[8216,8217],[8220,8221]];function ae(e=""){return re.some((([n,t])=>$(e,n,t)))}function ue(e=""){return!H(e)&&(!!function(e=""){return!H(e)&&e.charCodeAt(0)===X}(e)||$(e,W,V))}function se(e=""){return!H(e)&&ie.some((([n,t])=>$(e,n,t)))}function ce(e=""){return!H(e)&&oe.some((([n,t])=>$(e,n,t)))}function le(e=""){return!H(e)&&te.some((([n,t])=>$(e,n,t)))}Object.assign({tu:"っ",wa:"ゎ",ka:"ヵ",ke:"ヶ"},{a:"ぁ",i:"ぃ",u:"ぅ",e:"ぇ",o:"ぉ"},{ya:"ゃ",yi:"ぃ",yu:"ゅ",ye:"ぇ",yo:"ょ"}),function(e={}){const n={};"object"===U(e)&&Object.entries(e).forEach((([e,t])=>{let r=n;e.split("").forEach((e=>{void 0===r[e]&&(r[e]={}),r=r[e]})),r[""]=t}))}({wi:"ゐ",we:"ゑ"});const fe=e=>" "===e,he=e=>"　"===e,pe=e=>/[０-９]/.test(e),de=e=>/[0-9]/.test(e),ve={EN:"en",JA:"ja",EN_NUM:"englishNumeral",JA_NUM:"japaneseNumeral",EN_PUNC:"englishPunctuation",JA_PUNC:"japanesePunctuation",KANJI:"kanji",HIRAGANA:"hiragana",KATAKANA:"katakana",SPACE:"space",OTHER:"other"};function ye(e,n=!1){const{EN:t,JA:r,EN_NUM:i,JA_NUM:o,EN_PUNC:a,JA_PUNC:u,KANJI:s,HIRAGANA:c,KATAKANA:l,SPACE:f,OTHER:h}=ve;if(n)switch(!0){case pe(e):case de(e):return h;case fe(e):return t;case ce(e):return h;case he(e):return r;case le(e):return h;case ae(e):return r;case se(e):return t;default:return h}else switch(!0){case he(e):case fe(e):return f;case pe(e):return o;case de(e):return i;case ce(e):return a;case le(e):return u;case function(e=""){return $(e,G,Q)}(e):return s;case ue(e):return c;case function(e=""){return $(e,J,Y)}(e):return l;case ae(e):return r;case se(e):return t;default:return h}}const me=e=>!["ja","zh","zs"].includes(e),ge=(e,n=!1)=>{let t,r={};return t=n?n=>(p(r,n)||(r[n]=e(n)),r[n]):(...n)=>{const t=n.join("");return p(r,t)||(r[t]=e(...n)),r[t]},t.clearCache=()=>{r={}},t},be=ge((function(e,n,t){return e.localeCompare(n,t,{ignorePunctuation:!0,numeric:!0,sensitivity:"variant",usage:"sort",caseFirst:"upper"})})),we=ge(j),_e=ge(((e,n)=>e.toLocaleLowerCase(n).normalize("NFD").replace(/\p{M}/gu,"").replace(/[^\p{L}\p{N}]/gu,"").normalize("NFC")),!0),xe={en:8,hiragana:1,katakana:4,kanji:2},ke=e=>function(e,{compact:n=!1,detailed:t=!1}={}){if(null==e||H(e))return[];const r=[...e];let i=r.shift(),o=ye(i,n);return i=t?{type:o,value:i}:i,r.reduce(((e,r)=>{const i=ye(r,n),a=i===o;o=i;let u=r;return a&&(u=(t?e.pop().value:e.pop())+u),t?e.concat({type:i,value:u}):e.concat(u)}),[i])}(e,{detailed:!0}).map((e=>xe[e.type]??0)).reduce(((e,n)=>e|n),0),Ce=ge(ke,!0),Se=(e,n,t)=>{let r,i=e;if(t&&(i=i.filter((e=>!/[^\s]\s+[^\s]/.test(e)))),"en"===n)i=i.filter((e=>1===e.length||!e.includes("&")||!/(^|[^&\s])&([^&\s]|$)/.test(e)));else if("fr"===n)i=i.filter((e=>"où"===e||"Où"===e||!e.includes("ù")));else if("de"===n){const e=["ä","ö","ü"],n=["ae","oe","ue"];for(let t=0;t<=e.length;t++)i.includes((n=>n.includes(e[t])))&&!i.includes((e=>e.includes[n[t]]))&&(i=i.filter((n=>n.includes(e[t]))))}var o;if([r,i]=((e,n)=>{const t=[[],[]];for(let r=0,i=e.length;r<i;r++)t[n(e[r])?0:1].push(e[r]);return t})(i,(e=>e.includes("i̇"))),"tr"!==n&&(i=i.filter((e=>!e.includes("ı")&&!e.includes("İ")))),0===i.length&&(i=r.map((e=>e.replaceAll("i̇","i").replaceAll("İ","I")))),i.length>1&&(o=i.sort(((e,t)=>we(e,t,n))),i=C(o,(()=>-1))),i.length>1&&(i=C(i,((e,t,r)=>{const i=0===we(e,r,n),o=0===we(t,r,n);if(i){if(!o)return 1}else if(o)return-1;if(e.length>t.length)return-1;if(t.length>e.length)return 1;if(0===we(e,t,n)){const r=be(e,t,n);if(0!==r)return r}return i?-1:0}),(e=>_e(e,n)))),i.length>1){let e=i[0].match(/([^\p{L}\p{N}]+)$/u);if(e)for(let n=1;n<i.length;n++)if(!i[n].endsWith(e[1])){e=null;break}e&&(i=i.map((n=>n.slice(0,-e[1].length))),i.suffix=e[1])}return i.flags="ja"===n?i.map((e=>Ce(e))).reduce(((e,n)=>e|n),0):0,i},Oe={size:0},Ae=(e,n,t,r)=>{if(!e[n])return[];if(f(e[n].solutions))return e[n].solutions;let i=[];for(const r of Object.keys(e[n])){const o=Number(r),a=e[n][o];let u;u=0===a.length?c:a.suffix?e=>({token:a,next:{token:[a.suffix],next:e,size:e.size+1},size:e.size+2}):e=>({token:a,next:e,size:e.size+1});const s={reference:a[0]||"",flags:a.flags,isComplex:a.length>1},l=Ae(e,o,t);if(l.length>0)for(const e of l)i.push({locale:t,reference:s.reference+e.reference,flags:s.flags|e.flags,isComplex:s.isComplex||e.isComplex,tokens:u(e.tokens)});else o===e.length-1&&(s.locale=t,s.tokens=u(Oe),i.push(s))}return e[n].solutions=i,i},Pe=(e,n)=>e.map((e=>({sentence:e,flags:ke(e)}))),Ee=(e,n,t)=>{const r={locale:t,patterns:[]},i=me(t);let o;o="ja"===t?Pe(e.map((e=>e.normalize("NFC")))):e.map((e=>({sentence:e.normalize("NFC"),flags:0})));const a=e=>{return(n=e,i?n.split(/([^\p{L}\p{N}]+)/u):[n]).filter((e=>""!==e));var n};for(const{sentence:e,flags:n}of o){let o=0;const u=[],s=[],c=e.matchAll(i?/([^\s[]*\[[^[]+\][^\s[]*)+/gu:/\[([^\]]+)\]/gu);for(const n of c){if(n.index>o){const t=e.substring(o,n.index);if(""!==t){const e=a(t);s.push(...e)}}let r;const c=i&&(0===s.length||!!s.at(-1).match(/\p{Sentence_Terminal}\s*$/gu));if(i){r=[""];let e=0;const i=n[0].matchAll(/\[([^[]+)]/g);for(const t of i){if(t.index>e){const i=n[0].substring(e,t.index);r=r.map((e=>e+i))}const i=t[1].split(/\//);r=i.flatMap((e=>r.map((n=>n+e)))),e=t.index+t[0].length}if(e<n[0].length){const[,t,i]=n[0].substring(e).match(/(.*?)([^\p{L}\p{N}]*)$/u);r=r.map((e=>e+t)),i.length>0&&(n[0]=n[0].slice(0,-i.length))}r.sort(((e,n)=>j(e,n,t))),r=_(r.map(a),(e=>e.length))}else r=_(n[1].split(/\//).map(a),(e=>e.length));const l=[],f=Object.entries(r);for(const[e,n]of f){const r=Number(e);if(r>1){const e=Array.from(n.keys()),o=Object.values(_(e,(e=>n[e].slice(1).join("")))).filter((e=>e.length>1)),a=Object.values(_(e,(e=>n[e].slice(0,-1).join("")))).filter((e=>e.length>1)),u=new Set;if(i&&r>=3){const t=Object.values(_(e,(e=>n[e].slice(1,-1).join("")))).filter((e=>e.length>1));for(const e of t){const t=Object.values(_(e,(e=>n[e].slice(1).join("")))).filter((e=>e.length>1)).map((e=>e.map((e=>n[e][1].match(/\s/)&&n[e][0])).filter(Boolean))),r=Object.values(_(Array.from(t.keys()),(e=>t[e].join("/")))).filter((e=>e.length>1));for(const e of r)l.push({sharedTokens:n[o[e[0]][0]].slice(1,-1),firstChoice:o[e[0]].map((e=>n[e][0])),lastChoice:e.map((e=>n[o[e][0]].at(-1)))}),e.flatMap((e=>o[e])).forEach((e=>u.add(e)))}}for(let e of o)if(e=e.filter((e=>!u.has(e))),e.length>1){const r=e.map((e=>n[e][0])).sort(((e,n)=>j(e,n,t)));l.push({sharedTokens:n[e[0]].slice(1),firstChoice:r,lastChoice:[]}),e.forEach((e=>u.add(e)))}for(let e of a)if(e=e.filter((e=>!u.has(e))),e.length>1){const r=e.map((e=>n[e].at(-1))).sort(((e,n)=>j(e,n,t)));l.push({sharedTokens:n[e[0]].slice(0,-1),firstChoice:[],lastChoice:r}),e.forEach((e=>u.add(e)))}for(const t of e)u.has(t)||l.push({sharedTokens:n[t],firstChoice:[],lastChoice:[]})}else{const t=c&&0===r&&f.every((n=>n[0]===e||n[1].some((e=>{var n;return null===(n=e[0])||void 0===n?void 0:n.match(/^\s*[\p{N}\p{Lu}]/gu)}))));l.push({sharedTokens:[],firstChoice:n.flat(),lastChoice:[],shouldTitleCaseNextNonSpaceToken:t})}}u.push({branches:l,tokenPosition:s.length}),o=n.index+n[0].length}if(o<e.length){const n=a(e.substring(o));s.push(...n)}let l=1;for(let e=u.length-1;e>=0;e--){u[e].branchSize=l,l=u[e].branches.length*l;for(const n of u[e].branches)1===n.firstChoice.length&&n.sharedTokens.unshift(n.firstChoice.pop()),1===n.lastChoice.length&&n.sharedTokens.push(n.lastChoice.pop())}r.patterns.push({flags:n,size:l,branchSets:u,sharedTokens:s})}r.size=r.patterns.reduce(((e,n)=>e+n.size),0);const u=[];for(let e=0;e<r.size;e++)u.push(Ke(r,e));return we.clearCache(),u},je=(e,n,t)=>{let r=e.filter(l).map((e=>e.trim())).filter((e=>""!==e)).map(E);return r="ja"===t?Pe(r):r.map((e=>({sentence:e,flags:0}))),r.map((({sentence:e,flags:n})=>{const r=E(e),i=r.split(/([\p{L}\p{N}]+)/gu).map((e=>[e]));return{locale:t,reference:r,tokens:i,flags:n,isComplex:!1}}))},Te=(e,n,t)=>{const r=[];let i=0,o="",a=!1,u=!1;const s=e=>{f(e)?(u&&(u=!1,e=e.map((e=>e.replace(/[\p{L}\p{N}]/u,(e=>e.toLocaleUpperCase(t)))))),r.push(e),o+=e[0]):(u&&""!==e.trim()&&(u=!1,e=e.replace(/[\p{L}\p{N}]/u,(e=>e.toLocaleUpperCase(t)))),o+=e,r.push([e]))};for(const t of e.branchSets){for(let n=i;n<t.tokenPosition;n++)s(e.sharedTokens[n]);const r=t.branches[Math.floor(n/t.branchSize)];if(r.firstChoice.length>0&&(a=!0,s(r.firstChoice.sort(we))),r.sharedTokens.length>0)for(const e of r.sharedTokens)s(e);r.lastChoice.length>0&&(a=!0,s(r.lastChoice.sort(we))),i=t.tokenPosition,n%=t.branchSize,u=u||!!r.shouldTitleCaseNextNonSpaceToken}for(let n=i;n<e.sharedTokens.length;n++)s(e.sharedTokens[n]);return{locale:t,reference:o,tokens:r,isComplex:a,flags:e.flags}},Ke=(e,n)=>{for(const t of e.patterns){if(!(n>=t.size))return Te(t,n,e.locale);n-=t.size}return null},Ne=Symbol("summary"),Me=L(((e,n)=>T(E(e,!0,!1).toLocaleLowerCase(n)))),De=L(((e,n)=>T(E(e,!0,!0).toLocaleLowerCase(n)))),qe=(e,n,t)=>{const r=new Set,i=e.tokens.map((n=>n.map((e=>e.trim())).filter((e=>""!==e)).map((n=>{const i=((e,n,t)=>t.ignoreDiacritics?De(e,n):Me(e,n))(n,e.locale,t);return i.forEach((e=>r.add(e))),i})))).filter((e=>e.length>0));e.matchingData={id:n,tokens:i,words:Array.from(r)}},Ie=(e,n,t)=>{var r;const i=E((e=>{if(!e[Ne]){const n=me(e.locale)?"":" ";e[Ne]=e.tokens.reduce(((e,t)=>e+(1===t.length?t[0]:`${n}[${n}${t.join(" / ")}${n}]${n}`)),"")}return e[Ne]})(e),!0,t.ignoreDiacritics).toLocaleLowerCase(e.locale),o=(null===(r=/^[^\p{L}\p{N}]*(.*?)[^\p{L}\p{N}]*?$/gu.exec(i))||void 0===r?void 0:r[1])||i;e.matchingData={id:n,summary:o}},Fe={charCount:0,wordCount:0,bigramMap:new Map},Re=Symbol("word_stats"),Le=e=>({charCount:e.length,wordCount:1,bigramMap:K(e)}),ze=e=>0===e.length?Fe:{charCount:w(e,(e=>e.charCount)),wordCount:w(e,(e=>e.wordCount)),bigramMap:S(((e,n)=>e+n),...e.map((e=>e.bigramMap)))},Be=(e,n,t)=>{const r=(e=>{if(!e.matchingData)return{shared:Fe};if(!e[Re]){const{false:n=[],true:t=[]}=_(e.matchingData.tokens,(e=>e.length>1));e[Re]={shared:ze(n.flatMap((e=>e[0].map((e=>Le(e))))))};const r=t.map((e=>e.map((e=>ze(e.map((e=>Le(e))))))));if(r.length>0){const n=x(r);e[Re].paths=n.map(ze)}}return e[Re]})(e),i=ze(((e,n,t)=>T(E(e,!0,t.ignoreDiacritics).toLocaleLowerCase(n)))(n,e.locale,t).map(Le)),o=i.charCount+r.shared.charCount,a=i.wordCount+r.shared.wordCount;let u=0;for(const[e,n]of i.bigramMap){const t=r.shared.bigramMap.get(e)||0;t>0&&(u+=Math.min(n,t),i.bigramMap.set(e,Math.max(0,n-t)))}return r.paths?r.paths.map((e=>{let n=0;for(const[t,r]of i.bigramMap){const i=e.bigramMap.get(t)||0;i>0&&(n+=Math.min(r,i))}const t=o+e.charCount,r=a+e.wordCount;return 2*(u+n)/(t-r)})):[2*u/(o-a)]},Ue={ru:{"ё":"е"}},He=(e,n)=>{const t=Ue[n],r=E(e).toLocaleLowerCase(n);return h(t)?r.replace(new RegExp(`(${Object.keys(t).join("|")})`,"g"),(e=>t[e])):r},$e=(e,n)=>(e.type&n)>0,We=e=>e.key||`_duo-sv_-${e.type}-${e.statement}`,getParsedSolutionList=(e,n)=>{if(e.solutions.parsed)return e.solutions;let t;const{locale:r,metadata:i}=e.solutions,o=getAvailableSolutionListTypes(e);return o.includes(n)||(n=o[0]??null),t=F===n?((e,n,t)=>{const r=e.map((e=>_(e.filter((e=>{return!(n=e).auto&&"typo"!==n.type;var n})),(e=>e.to))));for(let e=0;e<r.length;++e){const i={};for(const[o,a]of Object.entries(r[e]))i[o]=Se(a.map((e=>String(e.orig||e.lenient||""))),n,t);r[e]=i}let i=Ae(r,0,n);for(const e of i){let n=0,t=e.tokens;const r=new Array(e.tokens.size);for(;t.token;)r[n++]=t.token,t=t.next;e.tokens=r}return i=Object.values(_(i,(e=>e.reference))).flatMap((e=>e.length<=1?e:e.some((e=>e.isComplex))?e.filter((e=>e.isComplex)):e.slice(-1))),be.clearCache(),we.clearCache(),i})(e.solutions.graph,r,i.isWhitespaceDelimited||me(r)):I===n?Ee(e.solutions.patterns,0,r):[],{parsed:!0,locale:r,type:n,list:t}},getAvailableSolutionListTypes=e=>e.solutions.parsed&&[e.solutions.type]||[e.solutions.graph&&F,e.solutions.patterns&&I].filter(l),addSimilarityScoresToSolutionList=(e,n)=>{(e=>{if(!h(e.matchingData)){if(!e.parsed)throw new Error("Cannot add matching data to an unparsed solution list.");const n=e.locale,t={ignoreDiacritics:!1,ignoreWordOrder:!0};if(e.matchingData={matchingOptions:t,locale:n},me(n)){const n=new Set;e.list.forEach(((e,r)=>{qe(e,r,t);for(const t of e.matchingData.words)n.add(t)})),e.matchingData.words=Array.from(n)}else e.list.forEach(((e,n)=>Ie(e,n,t)))}})(e),""!==n&&e.matchingData.words&&e.list.forEach((t=>{t.score=((e,n,t)=>g(Be(e,n,t)))(t,n,e.matchingData.matchingOptions)}))},getUiChallengeSolutionList=e=>{const n=h(e.grader)?e.grader:{},t=h(e.metadata)?{...e.metadata}:{},r=String(e.targetLanguage||n.language||t.target_language||t.language||"").trim(),i=(e,n=I)=>({parsed:!0,locale:r,type:n,list:e});if(f(e.correctSolutions)&&D.includes(e.type))return i(je(e.correctSolutions,0,r));const o=f(e.compactTranslations)&&e.compactTranslations.length>0,a=h(n)&&f(n.vertices)&&n.vertices.length>0;if(a||o){const i={parsed:!1,locale:r,metadata:t};return a&&(i.graph=n.vertices,t.isWhitespaceDelimited=!!n.whitespaceDelimited),o&&(i.patterns=e.compactTranslations),i}return l(e.prompt)&&""!==e.prompt&&M.includes(e.type)?i(je([e.prompt],0,r)):f(e.correctTokens)&&q.includes(e.type)?i(((e,n,t)=>je(e.filter(l).join(" "),0,t))(e.correctTokens,0,r)):null},Ve=new o("dsv");Ve.version(1).stores({sessions:"sessionId,lastUpdatedAt"});const Je=e=>{var n;return`${String((null===(n=e.tab)||void 0===n?void 0:n.id)||"global")}-${String(e.frameId||"main")}`},Ye=[],Ge=async(e,n)=>{await Ve.transaction("rw",[Ve.sessions],(async()=>{const t=await Ve.sessions.get(e),r=async()=>{t?await Ve.sessions.update(e,{...n(t),lastUpdatedAt:Date.now()}):await Ve.sessions.add({...n(),sessionId:e,lastUpdatedAt:Date.now()})};try{await r()}catch(n){if(!("QuotaExceededError"===n.name||n.inner&&"QuotaExceededError"===n.inner.name))throw n;await Qe([e]),await r()}}))},Qe=async(e=[],n=Number.MAX_SAFE_INTEGER)=>{await Ve.sessions.where("lastUpdatedAt").below(n).and(!e.includes((e=>e.sessionId))).delete()},Xe=async e=>{const n=await Ve.sessions.get(e);return f(null==n?void 0:n.challenges)?n.challenges:[]},Ze=async(e,n,t)=>{const r=await Xe(e);return f(r)?r.find((e=>$e(e,n)&&t(e))):null},en=async(e,n,t,r)=>{const i=((e,n,t)=>e.map((e=>{const r=getUiChallengeSolutionList(e);if(r){const i=String(e.id||Math.floor(Math.random()*Number.MAX_SAFE_INTEGER)).trim(),o=E(String(e.prompt||""));if(""!==o&&N.includes(e.type))return{key:i,type:D.includes(e.type)?3:1,statement:o,solutions:r,fromLanguage:n,toLanguage:t};if(M.includes(e.type)&&""!==String(e.solutionTranslation||"").trim()){const a=E(String(e.solutionTranslation)),u=String(e.tts||"").trim(),s=String(e.slowTts||"").trim();return{key:i,type:4,statement:o,solutions:r,fromLanguage:n,toLanguage:t,solutionTranslation:a,ttsMediaUrl:u,slowTtsMediaUrl:s}}}})).filter(h))(n,t,r);await Ge(e,(({challenges:e=[],...n}={})=>({...n,challenges:k(e.concat(i).splice(-200),(()=>1),(e=>We(e)))})))},getChallengeParsedSolutionList=(e,n)=>{if(e.solutions.parsed)return e.solutions;const t=We(e),r=Ye.find((e=>e.key===t&&e.type===n));if(r)return r.list;const i=getParsedSolutionList(e,n);return i.otherTypes=getAvailableSolutionListTypes(e).filter((e=>e!==i.type)),Ye.splice(0,Math.max(0,Ye.length+1-4)),Ye.push({key:t,type:n,list:i}),i},nn=async(e,n,t)=>{if(h(n)){let r,i=()=>!0;const o=l(n.userAnswer)?E(n.userAnswer):"";if(l(n.solutionTranslation)&&""!==n.solutionTranslation){const e=E(n.solutionTranslation);i=n=>e===n.solutionTranslation}if(r=await(async(e,n,t)=>{const r=await Xe(e);return f(r)?r.filter((e=>$e(e,n)&&t(e))):[]})(e,4,i),0===r.length)return;let a=null;if(l(n.solutionTranslation)&&""!==n.solutionTranslation&&1===r.length)a=r.pop();else{const n=await(async e=>{const n=await Ve.sessions.get(e);return(null==n?void 0:n.lastListeningChallenge)||null})(e);a=n&&r.find((e=>{return r=n,!!(t=e).ttsMediaUrl&&t.ttsMediaUrl===r.ttsMediaUrl||!!t.slowTtsMediaUrl&&t.slowTtsMediaUrl===r.slowTtsMediaUrl;var t,r}))}if(!h(a))return;const u=getChallengeParsedSolutionList(a,n.listType||I);addSimilarityScoresToSolutionList(u,o);const s={challenge:{...r,solutions:u}};if(""!==o&&"correct"===n.result){let e;const n=a.solutions.locale||null,t=u.matchingData.matchingOptions;if("ja"!==n){if(u.list.some((e=>"score"in e))){const n=m(u.list,(e=>e.score));e=u.list.filter((e=>n===e.score)).flatMap((e=>((e,n,t)=>{if(!e.isComplex)return[e.reference];const r=e.tokens.length;if(0===r)return[];const i=Be(e,n,t),o=g(i),a=[e.tokens[r-1].length,1];for(let n=r-2;n>=1;n--)a.unshift(a[0]*e.tokens[n].length);return i.map(((n,t)=>{if(n<o)return null;let i=t,u="";for(let n=0;n<r;n++)if(1===e.tokens[n].length)u+=e.tokens[n][0];else{const t=Math.floor(i/a[n]);u+=e.tokens[n][t],i%=a[n]}return u})).filter(l)})(e,o,t)))}else e=u.list.flatMap((e=>x(e.tokens.map((e=>e))).map((e=>e.join("")))));const r=e.map((e=>((e,n,t)=>{const r=B.diffChars(He(e,t),He(n,t)).flatMap((e=>{const n=[];if(e.added=!!e.added,e.removed=!!e.removed,e.added||e.removed){const t=[...e.value.matchAll(/[\p{P}\p{Z}]+/gu)].reduce(((t,r)=>(r.index>t&&n.push({added:e.added,removed:e.removed,value:e.value.substring(t,r.index),count:r.index-t}),n.push({added:e.added,removed:e.removed,ignorable:!0,value:r[0],count:r[0].length}),r.index+r[0].length)),0);t>0&&t<e.value.length&&n.push({added:e.added,removed:e.removed,value:e.value.substring(t,e.length),count:e.value.length-t})}return 0===n.length&&n.push(e),n}));if(!r.some((e=>(e.added||e.removed)&&!e.ignorable)))return null;const{result:i}=r.reduce((({result:e,left:n,right:t},r)=>{if(r.added)return r.value=t.substring(0,r.value.length),e.push(r),{result:e,left:n,right:t.substring(r.value.length)};if(r.removed)return r.value=n.substring(0,r.value.length),e.push(r),{result:e,right:t,left:n.substring(r.value.length)};const i=n.substring(0,r.value.length),o=t.substring(0,r.value.length),a=B.diffChars(i,o);return a.forEach((e=>{e.added=!!e.added,e.removed=!!e.removed,(e.added||e.removed)&&(e.ignorable=!0)})),e.push(...a),{result:e,left:n.substring(r.value.length),right:t.substring(r.value.length)}}),{result:[],left:e,right:n});return i})(e,o,n)));if(r.every((e=>f(e)))){const e=((e,n)=>{const t=b(e,n);return void 0===t?t:n(t)})(r,(e=>e.length));s.correctionDiff=b(r.filter((n=>e===n.length)),(e=>w(e,(e=>!e.ignorable&&(e.added||e.removed)&&e.value.length||0))))}}}t(s)}},tn=async(e,n)=>{if(l(n)){const t=n.trim();if(""!==t){const n=await Ze(e,4,(e=>t===e.ttsMediaUrl||t===e.slowTtsMediaUrl));h(n)&&await(async(e,n)=>{await Ge(e,((e={})=>({...e,lastListeningChallenge:n})))})(e,n)}}};var rn;rn=async(e,n,t,r)=>{switch(e){case"get_current_translation_challenge":await(async(e,n,t)=>{if(h(n)&&l(n.statement)){const r=E(n.statement),i=l(n.userAnswer)?E(n.userAnswer):"";let o=await Ze(e,1,(e=>r===e.statement));if(o||(o=await Ze(e,3,r.includes((e=>e.statement)))),!h(o))return;const a=getChallengeParsedSolutionList(o,n.listType||I);addSimilarityScoresToSolutionList(a,i),t({...o,solutions:a})}})(Je(t),n,r);break;case"get_current_listening_challenge":await nn(Je(t),n,r);break;case"get_challenge_by_key":case"update_current_challenge_user_reference":await(async(e,n,t)=>{if(h(n)&&l(n.key)&&l(n.userReference)){const r=n.userReference.trim(),i=await Ze(e,1,(e=>We(e)===n.key));if(h(i)){const e=getChallengeParsedSolutionList(i,n.listType||I);addSimilarityScoresToSolutionList(e,r),t({challenge:{...i,solutions:e},userReference:r})}}})(Je(t),n,r)}},chrome.runtime.onMessage.addListener(((e,n,t)=>{if(A===e.type){let r=!1;const i=e=>{r=!0,t({type:"success",value:e})},o=e=>{r=!0,t({type:"failure",error:e})};try{Promise.resolve(rn(e.action,e.value,n,i,o)).then((()=>{if(!r)throw new Error(`Could not handle action request: "${e.action}".`)})).catch((e=>{r||o(e)}))}catch(e){!r&&o(e)}return!0}})),(e=>{chrome.runtime.onMessage.addListener(((n,t)=>{P===n.type&&e(n.event,n.value,t)}))})((async(e,n,t)=>{switch(e){case"session_loaded":await(async(e,n)=>{if(h(n)){const t=h(n.sessionMetaData)?n.sessionMetaData:{},r=f(n.challenges)?n.challenges:[];await en(e,r,String(t.ui_language||t.from_language||n.fromLanguage||"").trim(),String(t.language||t.learning_language||n.learningLanguage||"").trim())}})(Je(t),n);break;case"sound_played":await tn(Je(t),n)}})),Qe([],Date.now()-864e5)}();
