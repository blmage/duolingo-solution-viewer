!function(){"use strict";const e=function(e){const t="string"==typeof e?t=>t&&"object"==typeof t&&void 0!==t[e]?t[e]:t:null,n=e=>{let n,r,o,i,s,a=0;return function(){for(o||(o=[].sort.call(arguments,((e,t)=>e.length-t.length)),r=o.length-1,i=[],s=new Map,a=0,n=0);a<=r;a++){const c=o[a].length;for(;n<c;){const c=o[a][n],u=t?t(c):c;if(s.get(u)===a-1)if(a===r){if(i[i.length]=c,s.set(u,0),e)return n++,{value:c}}else s.set(u,a);else 0===a&&s.set(u,0);n++}n=0}return o=null,e?{done:!0}:i}},r=n();return r.iterable=function(...e){const t=n(!0);let r;return{next:()=>r?t():(r=!0,t(...e)),[Symbol.iterator](){return this}}},r}(!0);function t(e,n={}){if(!(this&&"object"==typeof this&&this instanceof t))return new t(e,n);this.collections=e||[],Object.defineProperty(this,"length",{set:function(){},get:function(){let e=1;return this.collections.forEach((function(t){e*=t.length})),e}}),Object.defineProperty(this,"size",{set:function(){},get:function(){return this.length}}),Object.defineProperty(this,"_options",{value:Object.assign({},n)}),Object.defineProperty(this,"_cache",{configurable:!0,value:{}})}function n(e,t,r,o,i,s,a,c,u){var l=r[e],f=r.length-1,h=o[e];if(e==f)for(var p=0;p<h;++p){if(i[e]=l[p],!a||a(i)){var d=i.slice(0);!c||(c[t]=d),s(d,t,u)}t++}else for(p=0;p<h;++p)i[e]=l[p],n(e+1,t,r,o,i,s,a,c,u);i.pop()}t.prototype.asGenerator=function(){const e=this,t=function*e([t,...n]){if(void 0===t)return;const r=n.length>0?e(n):[[]];for(let e of r)for(let n of t)yield[n,...e]}(this.collections);return Object.defineProperty(t,"length",{get:()=>e.length}),t},t.prototype.asArrayLike=function(){const e=this;return new Proxy([],{get:(t,n)=>"length"===n?e.length:"number"==typeof n?e.get(n):t[n]})},t.prototype.add=function(...e){var t=this;return e.forEach((function(e){t.collections.push(e)})),this.flush(),t},t.prototype.push=function(e,t){return this.collections[e].push(t),this.flush(),this},t.prototype.flush=function(e){"number"==typeof e?delete this._cache[e]:Object.defineProperty(this,"_cache",{configurable:!0,value:{}})},t.prototype.get=function(e,{test:t,cache:n}={}){var r=this,o=[],i=1,s=this._cache[e];if(void 0!==s)return s;for(var a,c=[],u=1,l=r.collections.length;l--;u*=a)c[l]=[u,a=r.collections[l].length],i*=r.collections[l].length;return e>=i||(function(e,t,n,r){for(var o=t.length;o--;)r[o]=t[o][(e/n[o][0]<<0)%n[o][1]]}(e,r.collections,c,o),s=o.slice(0),t&&!t(o))?void 0:((!0===n||this._options.cache)&&(this._cache[e]=s),s)},t.has=function(e,{cache:t}={}){return this.get(e,{cache:t})>=0},t.prototype.indexable=function(){return new Proxy(this,{get(e,t){var n=parseInt(t);return n>=0?e.get(n):e[t]}})},t.prototype.indexOf=function(e,{cache:t}={}){for(var n,r=this,o=0,i=[],s=1,a=r.collections.length;a--;s*=n)i[a]=s,n=r.collections[a].length;return r.collections.every((function(t,n){var r=t.indexOf(e[n]);return r>=0&&(o+=r*i[n],!0)}))?((!0===t||this._options.cache)&&(this._cache[o]=e.slice(0)),o):-1},t.prototype.intersection=function(n){var r=[];return this.collections.length!==n.collections.length?new t([],this._options):(this.collections.forEach((function(t,o){r.push(e(t,n.collections[o]))})),new t(r,this._options))},t.prototype.verify=function(e,t,{cache:n}={}){var r=this.get(e,{cache:n});return r&&r.every((function(e,n){return e===t[n]}))},t.prototype.forEach1=function(e,{test:t,cache:r}={}){for(var o=this,i=[],s=o.collections.length;s--;)i[s]=o.collections[s].length;n(0,0,o.collections,i,[],e,t,r?this._cache:null,o)},t.prototype.forEach2=function(e,t){var n=0;do{var r=this.get(n,t);void 0!==r&&e(r,n,cxproduct),n++}while(void 0!==r)},t.prototype.forEach=t.prototype.forEach1;const r=e=>e,o=e=>"string"==typeof e,i=Array.isArray,s=e=>"object"==typeof e&&!!e&&!i(e),a=(e,t)=>e>t,c=(e,t)=>e<t,u=(e,t,n)=>{let r,o;if(i(e))for(let i=0,s=e.length;i<s;i++){const s=t(e[i]);(void 0===o||n(s,o))&&(r=e[i],o=s)}return r},l=(e,t)=>{const n=u(e,t,a);return void 0===n?n:t(n)},f=e=>l(e,r),h=(e,t)=>u(e,t,c),p=(e,t)=>e.reduce(((e,n)=>e+t(n)),0),d=(e,t)=>{const n={};for(let r=0,o=e.length;r<o;r++){const o=e[r],i=String(t(o));i in n||(n[i]=[]),n[i].push(e[r])}return n},g=e=>{const n=[];return t(e).forEach((e=>n.push(e))),n};function m(e,t,n=r){if(e.length<=1)return e.slice();const o=[];let i=0,s=n(e[0]);for(let r=1,a=e.length;r<a;r++){const a=n(e[r]),c=s!==a?0:t(e[i],e[r],s);-1!==c&&(0===c&&o.push(e[i]),s=a,i=r)}return o.push(e[i]),o}const v=(e,...t)=>{const n=new Map,[r,...o]=t;for(const[e,t]of r)n.set(e,t);for(const t of o)for(const[r,o]of t){const t=n.get(r);n.set(r,void 0===t?o:e(t,o))}return n},y=e=>`__duo-toolbox__-${e}`,b=y("action_request"),w=y("ui_event_notification");function k(e,t=!0,n=!1){let r=n?e.normalize("NFD").replace(/\p{M}/gu,""):e;return r=r.normalize("NFC"),t?r.trim().replace(/(\s)\1+/g,"$1"):r}function x(e,t,n){return e.localeCompare(t,n,{ignorePunctuation:!0,numeric:!0,sensitivity:"accent",usage:"sort"})}function C(e){const t=e.match(/([\p{L}\p{N}]+)/gu);return t?Array.from(t):[]}const j=e=>{const t=new Map;if(e.length<=2)t.set(e,(t.get(e)||0)+1);else for(let n=0,r=e.length-1;n<r;n++){const r=e.substring(n,n+2);t.set(r,(t.get(r)||0)+1)}return t},S=["name","translate","partialReverseTranslate","completeReverseTranslation"],A=["listen","listenTap","listenComplete"],O=["name"],N=["listenTap"],z="compact",E="expanded";"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function M(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var L={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,n=function(e){for(var n,r=0;r<(arguments.length<=1?0:arguments.length-1);r++)if((n=r+1<1||arguments.length<=r+1?void 0:arguments[r+1])&&"object"==typeof n)for(var o in n)t.call(n,o)&&(e[o]=n[o]);return e},r=function(e){var t=e.length;if(!t)return[];if(1===t)return[e[0]];if(2===t)return[e[0],e[1]];if(3===t)return[e[0],e[1],e[2]];for(var n=new Array(t),r=0;r<t;r++)n[r]=e[r];return n},o=function(e,t){var n="function"==typeof t?t:function(e){return function(t,n){if(t.length!==n.length)return!1;for(var r=0,o=t.length;r<o;r++)if(!e(t[r],n[r]))return!1;return!0}}(e);return function(e,t){for(var r=0;r<e.length;r++)if(n(e[r],t))return r;return-1}},i=function(e,t){return e===t||e!=e&&t!=t},s=function(e,t,n){},a=function(e,t,n){for(var r=n;r--;)e[r+1]=e[r];e[0]=t},c=function(e){var t=o(e.isEqual,e.isMatchingKey);return function(n,r){var o=n.keys[0];n.values[0]=n.values[0].then((function(t){return e.onCacheHit(n,e,r),e.onCacheChange(n,e,r),t})).catch((function(e){var r=t(n.keys,o);throw~r&&(n.keys.splice(r,1),n.values.splice(r,1)),e}))}};function u(e,t){if(e.isMemoized)return e;var u=t||{},l=u.isEqual,f=void 0===l?i:l,h=u.isMatchingKey,p=u.isPromise,d=void 0!==p&&p,g=u.maxSize,m=void 0===g?1:g,v=u.onCacheAdd,y=void 0===v?s:v,b=u.onCacheChange,w=void 0===b?s:b,k=u.onCacheHit,x=void 0===k?s:k,C=u.transformKey,j=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],0<=t.indexOf(n)||(o[n]=e[n]);return o}(u,["isEqual","isMatchingKey","isPromise","maxSize","onCacheAdd","onCacheChange","onCacheHit","transformKey"]),S=n({},j,{isEqual:f,isMatchingKey:h,isPromise:d,maxSize:m,onCacheAdd:y,onCacheChange:w,onCacheHit:x,transformKey:C}),A=o(f,h),O=c(S),N=!(!C&&!h),z={keys:[],get size(){return z.keys.length},values:[]},E=z.keys,M=z.values;function L(){var t=arguments,n=N?r(t):t,o=C?C(n):n,i=A(E,o);if(~i)x(z,S,L),i&&(a(E,E[i],i),a(M,M[i],i),w(z,S,L));else{E.length>=m&&(E.pop(),M.pop());var s=N?o:r(n),c=e.apply(this,t);a(E,s,E.length),a(M,c,M.length),d&&O(z,L),y(z,S,L),w(z,S,L)}return M[0]}return Object.defineProperties(L,{cache:{configurable:!0,get:function(){return z}},cacheSnapshot:{configurable:!0,get:function(){return{keys:r(z.keys),size:z.size,values:r(z.values)}}},isMemoized:{configurable:!0,get:function(){return!0}},options:{configurable:!0,get:function(){return S}}}),L}function l(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(t.length)return t.reduce((function(e,t){return"function"==typeof e?"function"==typeof t?function(){return e(t.apply(this,arguments))}:e:"function"==typeof t?t:void 0}))}function f(e,t){for(var n=0;n<e.length;n++)if(e[n].key===t)return n;return-1}function h(e,t){var n="function"==typeof t?t:function(t,n){for(var r=0;r<n.length;r++)if(!e(t[r],n[r]))return!1;return!0};return function(e,t){for(var r=0;r<e.length;r++)if(e[r].length===t.length&&n(e[r],t))return r;return-1}}function p(e){return Array.isArray(e)?e:[e]}function d(e,t,n){var r=f(e,t);~r&&(clearTimeout(e[r].timeoutId),n&&e.splice(r,1))}function g(e,t){var n=setTimeout(e,t);return"function"==typeof n.unref&&n.unref(),n}function m(){F.isCollectingStats=!0}function v(e,t){return e?(t/e*100).toFixed(4)+"%":"0%"}function y(e){if(F.isCollectingStats||H||(console.warn('Stats are not currently being collected, please run "collectStats" to enable them.'),H=!0),e){if(!F.profiles[e])return{calls:0,hits:0,usage:"0%"};var t=F.profiles[e];return Object.assign({},t,{usage:v(t.calls,t.hits)})}var n=Object.keys(F.profiles).reduce((function(e,t){return e.calls+=F.profiles[t].calls,e.hits+=F.profiles[t].hits,e}),{calls:0,hits:0});return Object.assign({},n,{profiles:Object.keys(F.profiles).reduce((function(e,t){return e[t]=y(t),e}),{}),usage:v(n.calls,n.hits)})}function b(e,t){return e&&"object"==typeof e&&t.add(e)}function w(e,t,n,r){for(var o,i=0;i<e.length;i++)if(n((o=e[i])[0],t[0],r)&&n(o[1],t[1],r))return!0;return!1}function k(e,t,n,r){for(var o=0;o<e.length;o++)if(n(e[o],t,r))return!0;return!1}function x(e,t){return e===t||e!=e&&t!=t}function C(e){return e.constructor===Object}function j(e){return"function"==typeof e.then}function S(e){return!(!e.$$typeof||!e._store)}function A(e){return function(t){var n=e||t;return function(e,t,r){void 0===r&&(r=q?new WeakSet:Object.create({_values:[],add:function(e){this._values.push(e)},has:function(e){return!!~this._values.indexOf(e)}}));var o=r.has(e),i=r.has(t);return o||i?o&&i:(b(e,r),b(t,r),n(e,t,r))}}}function O(e){var t=[];return e.forEach((function(e,n){return t.push([n,e])})),t}function N(e){var t=[];return e.forEach((function(e){return t.push(e)})),t}function z(e,t,n,r){var o,i=J(e),s=J(t);if(i.length!==s.length)return!1;for(var a=0;a<i.length;a++){if(!k(s,o=i[a],x))return!1;if(!("_owner"===o&&S(e)&&S(t)||n(e[o],t[o],r)))return!1}return!0}function E(e){var t="function"==typeof e?e(n):n;function n(e,n,r){if(x(e,n))return!0;var o=typeof e;if(o!=typeof n||"object"!=o||!e||!n)return!1;if(C(e)&&C(n))return z(e,n,t,r);var i=U(e),s=U(n);if(i||s)return i===s&&function(e,t,n,r){if(e.length!==t.length)return!1;for(var o=0;o<e.length;o++)if(!n(e[o],t[o],r))return!1;return!0}(e,n,t,r);var a=e instanceof Date,c=n instanceof Date;if(a||c)return a==c&&x(e.getTime(),n.getTime());var u=e instanceof RegExp,l=n instanceof RegExp;if(u||l)return u==l&&function(e,t){return e.source===t.source&&e.global===t.global&&e.ignoreCase===t.ignoreCase&&e.multiline===t.multiline&&e.unicode===t.unicode&&e.sticky===t.sticky&&e.lastIndex===t.lastIndex}(e,n);if(j(e)||j(n))return e===n;if(K){var f=e instanceof Map,h=n instanceof Map;if(f||h)return f==h&&function(e,t,n,r){if(e.size!==t.size)return!1;for(var o=O(e),i=O(t),s=0;s<o.length;s++)if(!w(i,o[s],n,r)||!w(o,i[s],n,r))return!1;return!0}(e,n,t,r)}if(I){var p=e instanceof Set,d=n instanceof Set;if(p||d)return p==d&&function(e,t,n,r){if(e.size!==t.size)return!1;for(var o=N(e),i=N(t),s=0;s<o.length;s++)if(!k(i,o[s],n,r)||!k(o,i[s],n,r))return!1;return!0}(e,n,t,r)}return z(e,n,t,r)}return n}function M(e){return function(t){if(e>=t.length)return t;switch(e){case 0:return[];case 1:return[t[0]];case 2:return[t[0],t[1]];case 3:return[t[0],t[1],t[2]];case 4:return[t[0],t[1],t[2],t[3]];case 5:return[t[0],t[1],t[2],t[3],t[4]]}return Array.prototype.slice.call(t,0,e)}}var L={equals:void 0,isDeepEqual:!1,isPromise:!1,isReact:!1,isSerialized:!1,matchesKey:void 0,maxAge:void 0,maxArgs:void 0,maxSize:1/0,onExpire:void 0,profileName:void 0,serializer:void 0,shouldSerializeFunctions:!1,transformArgs:void 0,updateExpire:!1},T=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(t.length)return t.reduce((function(e,t){return"function"==typeof e?"function"==typeof t?function(){t.apply(this,arguments),e.apply(this,arguments)}:e:"function"==typeof t?t:void 0}))},_=function(e,t){return t===L?e:Object.assign({},e,t,{onCacheAdd:T(e.onCacheAdd,t.onCacheAdd),onCacheChange:T(e.onCacheChange,t.onCacheChange),onCacheHit:T(e.onCacheHit,t.onCacheHit),transformArgs:l(e.transformArgs,t.transformArgs)})},P=function(e,t,n,r){var o=t.maxAge,i=t.updateExpire,s="number"==typeof o&&isFinite(o)?function e(t,n,r,o){var i=n.maxAge,s=n.onCacheChange,a=n.onExpire,c=h(r,o);return function(o,u,l){var h=o.keys[0];if(!~f(t,h)){var p=function(){var i=c(o.keys,h),f=o.values[i];~i&&(o.keys.splice(i,1),o.values.splice(i,1),"function"==typeof s&&s(o,u,l)),d(t,h,!0),"function"==typeof a&&!1===a(h)&&(o.keys.unshift(h),o.values.unshift(f),e(t,n,r)(o,u,l),"function"==typeof s&&s(o,u,l))};t.push({expirationMethod:p,key:h,timeoutId:g(p,i)})}}}(e,t,n,r):void 0;return{onCacheAdd:s,onCacheHit:s&&i?function(e,t){var n=t.maxAge;return function(t){var r=t.keys[0],o=f(e,r);~o&&(d(e,r,!1),e[o].timeoutId=g(e[o].expirationMethod,n))}}(e,t):void 0}},F={anonymousProfileNameCounter:1,isCollectingStats:!1,profiles:{}},H=!1,D=function(e){var t=(new Error).stack,n=e.displayName||e.name||"Anonymous "+F.anonymousProfileNameCounter++;if(!t)return n;for(var r,o,i=t.split("\n").slice(3),s=0;s<i.length;s++)if(!~(r=i[s]).indexOf("/moize/")&&!~r.indexOf(" (native)")&&!~r.indexOf(" Function.")){o=r.replace(/\n/g,"\\n").trim();break}return o?n+" "+o:n},$=function(e){return F.isCollectingStats?{onCacheAdd:function(e){var t=e.profileName;return F.profiles[t]||(F.profiles[t]={calls:0,hits:0}),function(){F.profiles[t].calls++}}(e),onCacheHit:function(e){var t=e.profileName;return function(){F.profiles[t].calls++,F.profiles[t].hits++}}(e)}:{}},R=function(e,t){return function(e,t){var n=t.expirations,r=e.options,o=r.isEqual,i=r.isMatchingKey,s=r.onCacheAdd,c=r.onCacheChange,u=r.transformKey,l=h(o,i);e.add=function(t,n){var r=u?u(t):t;~l(e.cache.keys,r)||(e.cache.size>=e.options.maxSize&&(e.cache.keys.pop(),e.cache.values.pop()),e.cache.keys.unshift(r),e.cache.values.unshift(n),s(e.cache,e.options,e),c(e.cache,e.options,e))},e.clear=function(){e.cache.keys.length=0,e.cache.values.length=0,c(e.cache,e.options,e)},e.get=function(t){var n=l(e.cache.keys,u?u(t):t);return~n?e.apply(this,e.cache.keys[n]):void 0},e.getStats=function(){return y(e.options.profileName)},e.has=function(t){return!!~l(e.cache.keys,u?u(t):t)},e.keys=function(){return e.cacheSnapshot.keys},e.remove=function(t){var r=l(e.cache.keys,u?u(t):t);if(~r){var o=e.cache.keys[r];e.cache.keys.splice(r,1),e.cache.values.splice(r,1),c(e.cache,e.options,e),d(n,o,!0)}},e.update=function(t,n){var r=l(e.cache.keys,u?u(t):t);if(~r){var o=e.cache.keys[r];a(e.cache.keys,o,r),a(e.cache.values,n,r),c(e.cache,e.options,e)}},e.values=function(){return e.cacheSnapshot.values}}(e,t),function(e,t){var n=t.expirations,r=t.options,o=t.originalFunction,i=e.options;Object.defineProperties(e,{_microMemoizeOptions:{configurable:!0,get:function(){return i}},expirations:{configurable:!0,get:function(){return n}},expirationsSnapshot:{configurable:!0,get:function(){return n.slice(0)}},isCollectingStats:{configurable:!0,get:function(){return F.isCollectingStats}},isMoized:{configurable:!0,get:function(){return!0}},options:{configurable:!0,get:function(){return r}},originalFunction:{configurable:!0,get:function(){return o}}}),r.isReact&&(e.contextTypes=o.contextTypes,e.defaultProps=o.defaultProps,e.displayName="Moized("+(o.displayName||o.name||"Component")+")",e.propTypes=o.propTypes)}(e,t),e},K="function"==typeof Map,I="function"==typeof Set,q="function"==typeof WeakSet,J=Object.keys,U=Array.isArray,W=(E(A()),E(A(x)),E()),G=E((function(){return x}));function B(e,t,n){return"[ref-"+n+"]"}var V=function(e,t){if(e[0]===t)return 0;for(var n=e.length,r=1;r<n;r++)if(e[r]===t)return r;return-1};function X(e,t){var n=t||B,r="function"==typeof e,o=[];return function(t,i){if("object"==typeof i)if(o.length){var s=V(o,this)+1;s?o=function(e,t){for(var n=new Array(t),r=0;r<t;r++)n[r]=e[r];return n}(o,s):o[o.length]=this;var a=V(o,i);if(~a)return n.call(this,t,i,a)}else o[0]=i;return r?e.call(this,t,i):i}}function Z(e,t){return"function"==typeof t?""+t:t}function Q(e,t){try{return JSON.stringify(e,t)}catch(n){return function(e,t,n,r){return JSON.stringify(e,X(t,r),n)}(e,t)}}function Y(e){return"function"==typeof e.serializer?l(p,e.serializer):function(e){var t=e.shouldSerializeFunctions?Z:null;return function(e){for(var n,r,o="|",i=0;i<e.length;i++)o+=(r=typeof(n=e[i]),(!n||"object"!=r&&"function"!=r?n:Q(n,t))+"|");return[o]}}(e)}function ee(e,t){return e[0]===t[0]}var te=function(e){if("function"==typeof e)return function(t,n,r){return e(r.cache,r.options,r)}},ne=function(e){var t=e.equals,n=e.isDeepEqual,r=e.isReact;return t||n&&W||r&&G||x},re=function(e){var t=e.isSerialized;return e.matchesKey||t&&ee||void 0},oe=function(e){var t=e.maxArgs,n=e.isReact,r=e.isSerialized,o=e.transformArgs;return l(r&&Y(e),"function"==typeof o&&l(p,o),n&&M(2),"number"==typeof t&&M(t))};function ie(e,t){if(void 0===t&&(t=L),e.isMoized)return ie(e.originalFunction,_(e.options,t));if("object"==typeof e)return function(t,n){return void 0===n&&(n={}),"function"==typeof t?ie(t,_(e,n)):ie(_(e,t))};var n=Object.assign({},L,t,{maxArgs:"number"==typeof t.maxArgs&&0<=t.maxArgs?t.maxArgs:L.maxArgs,maxSize:"number"==typeof t.maxSize&&0<=t.maxSize?t.maxSize:L.maxSize,profileName:t.profileName||D(e)}),r=[],o=(n.equals,n.isDeepEqual,n.isPromise),i=(n.isReact,n.isSerialized,n.matchesKey,n.maxAge,n.maxArgs,n.maxSize),s=n.onCacheAdd,a=n.onCacheChange,c=n.onCacheHit,l=(n.onExpire,n.profileName,n.shouldSerializeFunctions,n.serializer,n.transformArgs,n.updateExpire,function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],0<=t.indexOf(n)||(o[n]=e[n]);return o}(n,["equals","isDeepEqual","isPromise","isReact","isSerialized","matchesKey","maxAge","maxArgs","maxSize","onCacheAdd","onCacheChange","onCacheHit","onExpire","profileName","shouldSerializeFunctions","serializer","transformArgs","updateExpire"])),f=ne(n),h=re(n),p=P(r,n,f,h),d=$(n),g=oe(n),m=Object.assign({},l,{isEqual:f,isMatchingKey:h,isPromise:o,maxSize:i,onCacheAdd:te(T(s,p.onCacheAdd,d.onCacheAdd)),onCacheChange:te(a),onCacheHit:te(T(c,p.onCacheHit,d.onCacheHit)),transformKey:g});return R(u(e,m),{expirations:r,options:n,originalFunction:e})}ie.collectStats=m,ie.compose=function(){return l.apply(null,arguments)||ie},ie.deep=ie({isDeepEqual:!0}),ie.getStats=y,ie.isCollectingStats=function(){return F.isCollectingStats},ie.isMoized=function(e){return"function"==typeof e&&!!e.isMoized},ie.maxAge=function(e){return ie({maxAge:e})},ie.maxArgs=function(e){return ie({maxArgs:e})},ie.maxSize=function(e){return ie({maxSize:e})},ie.promise=ie({isPromise:!0,updateExpire:!0}),ie.react=ie({isReact:!0}),ie.reactSimple=ie({isReact:!0,maxSize:1}),ie.serialize=ie({isSerialized:!0}),ie.simple=ie({maxSize:1}),e.collectStats=m,e.default=ie,Object.defineProperty(e,"__esModule",{value:!0})})(L.exports);var T=M(L.exports),_={exports:{}};
/*!

     diff v4.0.1

    Software License Agreement (BSD License)

    Copyright (c) 2009-2015, Kevin Decker <kpdecker@gmail.com>

    All rights reserved.

    Redistribution and use of this software in source and binary forms, with or without modification,
    are permitted provided that the following conditions are met:

    * Redistributions of source code must retain the above
      copyright notice, this list of conditions and the
      following disclaimer.

    * Redistributions in binary form must reproduce the above
      copyright notice, this list of conditions and the
      following disclaimer in the documentation and/or other
      materials provided with the distribution.

    * Neither the name of Kevin Decker nor the names of its
      contributors may be used to endorse or promote products
      derived from this software without specific prior
      written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR
    IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
    FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR
    CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
    DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER
    IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT
    OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
    @license
    */
!function(e,t){!function(e){function t(){}function n(e,t,n,r,o){for(var i=0,s=t.length,a=0,c=0;i<s;i++){var u=t[i];if(u.removed){if(u.value=e.join(r.slice(c,c+u.count)),c+=u.count,i&&t[i-1].added){var l=t[i-1];t[i-1]=t[i],t[i]=l}}else{if(!u.added&&o){var f=n.slice(a,a+u.count);f=f.map((function(e,t){var n=r[c+t];return n.length>e.length?n:e})),u.value=e.join(f)}else u.value=e.join(n.slice(a,a+u.count));a+=u.count,u.added||(c+=u.count)}}var h=t[s-1];return s>1&&"string"==typeof h.value&&(h.added||h.removed)&&e.equals("",h.value)&&(t[s-2].value+=h.value,t.pop()),t}function r(e){return{newPos:e.newPos,components:e.components.slice(0)}}t.prototype={diff:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=o.callback;"function"==typeof o&&(i=o,o={}),this.options=o;var s=this;function a(e){return i?(setTimeout((function(){i(void 0,e)}),0),!0):e}e=this.castInput(e),t=this.castInput(t),e=this.removeEmpty(this.tokenize(e));var c=(t=this.removeEmpty(this.tokenize(t))).length,u=e.length,l=1,f=c+u,h=[{newPos:-1,components:[]}],p=this.extractCommon(h[0],t,e,0);if(h[0].newPos+1>=c&&p+1>=u)return a([{value:this.join(t),count:t.length}]);function d(){for(var o=-1*l;o<=l;o+=2){var i=void 0,f=h[o-1],p=h[o+1],d=(p?p.newPos:0)-o;f&&(h[o-1]=void 0);var g=f&&f.newPos+1<c,m=p&&0<=d&&d<u;if(g||m){if(!g||m&&f.newPos<p.newPos?(i=r(p),s.pushComponent(i.components,void 0,!0)):((i=f).newPos++,s.pushComponent(i.components,!0,void 0)),d=s.extractCommon(i,t,e,o),i.newPos+1>=c&&d+1>=u)return a(n(s,i.components,t,e,s.useLongestToken));h[o]=i}else h[o]=void 0}l++}if(i)!function e(){setTimeout((function(){if(l>f)return i();d()||e()}),0)}();else for(;l<=f;){var g=d();if(g)return g}},pushComponent:function(e,t,n){var r=e[e.length-1];r&&r.added===t&&r.removed===n?e[e.length-1]={count:r.count+1,added:t,removed:n}:e.push({count:1,added:t,removed:n})},extractCommon:function(e,t,n,r){for(var o=t.length,i=n.length,s=e.newPos,a=s-r,c=0;s+1<o&&a+1<i&&this.equals(t[s+1],n[a+1]);)s++,a++,c++;return c&&e.components.push({count:c}),e.newPos=s,a},equals:function(e,t){return this.options.comparator?this.options.comparator(e,t):e===t||this.options.ignoreCase&&e.toLowerCase()===t.toLowerCase()},removeEmpty:function(e){for(var t=[],n=0;n<e.length;n++)e[n]&&t.push(e[n]);return t},castInput:function(e){return e},tokenize:function(e){return e.split("")},join:function(e){return e.join("")}};var o=new t;function i(e,t,n){return o.diff(e,t,n)}function s(e,t){if("function"==typeof e)t.callback=e;else if(e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}var a=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,c=/\S/,u=new t;function l(e,t,n){return n=s(n,{ignoreWhitespace:!0}),u.diff(e,t,n)}function f(e,t,n){return u.diff(e,t,n)}u.equals=function(e,t){return this.options.ignoreCase&&(e=e.toLowerCase(),t=t.toLowerCase()),e===t||this.options.ignoreWhitespace&&!c.test(e)&&!c.test(t)},u.tokenize=function(e){for(var t=e.split(/(\s+|[()[\]{}'"]|\b)/),n=0;n<t.length-1;n++)!t[n+1]&&t[n+2]&&a.test(t[n])&&a.test(t[n+2])&&(t[n]+=t[n+2],t.splice(n+1,2),n--);return t};var h=new t;function p(e,t,n){return h.diff(e,t,n)}function d(e,t,n){var r=s(n,{ignoreWhitespace:!0});return h.diff(e,t,r)}h.tokenize=function(e){var t=[],n=e.split(/(\n|\r\n)/);n[n.length-1]||n.pop();for(var r=0;r<n.length;r++){var o=n[r];r%2&&!this.options.newlineIsToken?t[t.length-1]+=o:(this.options.ignoreWhitespace&&(o=o.trim()),t.push(o))}return t};var g=new t;function m(e,t,n){return g.diff(e,t,n)}g.tokenize=function(e){return e.split(/(\S.+?[.!?])(?=\s+|$)/)};var v=new t;function y(e,t,n){return v.diff(e,t,n)}function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function w(e){return k(e)||x(e)||C()}function k(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function x(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function C(){throw new TypeError("Invalid attempt to spread non-iterable instance")}v.tokenize=function(e){return e.split(/([{}:;,]|\s+)/)};var j=Object.prototype.toString,S=new t;function A(e,t,n){return S.diff(e,t,n)}function O(e,t,n,r,o){var i,s;for(t=t||[],n=n||[],r&&(e=r(o,e)),i=0;i<t.length;i+=1)if(t[i]===e)return n[i];if("[object Array]"===j.call(e)){for(t.push(e),s=new Array(e.length),n.push(s),i=0;i<e.length;i+=1)s[i]=O(e[i],t,n,r,o);return t.pop(),n.pop(),s}if(e&&e.toJSON&&(e=e.toJSON()),"object"===b(e)&&null!==e){t.push(e),s={},n.push(s);var a,c=[];for(a in e)e.hasOwnProperty(a)&&c.push(a);for(c.sort(),i=0;i<c.length;i+=1)s[a=c[i]]=O(e[a],t,n,r,a);t.pop(),n.pop()}else s=e;return s}S.useLongestToken=!0,S.tokenize=h.tokenize,S.castInput=function(e){var t=this.options,n=t.undefinedReplacement,r=t.stringifyReplacer,o=void 0===r?function(e,t){return void 0===t?n:t}:r;return"string"==typeof e?e:JSON.stringify(O(e,null,null,o),o,"  ")},S.equals=function(e,n){return t.prototype.equals.call(S,e.replace(/,([\r\n])/g,"$1"),n.replace(/,([\r\n])/g,"$1"))};var N=new t;function z(e,t,n){return N.diff(e,t,n)}function E(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.split(/\r\n|[\n\v\f\r\x85]/),r=e.match(/\r\n|[\n\v\f\r\x85]/g)||[],o=[],i=0;function s(){var e={};for(o.push(e);i<n.length;){var r=n[i];if(/^(\-\-\-|\+\+\+|@@)\s/.test(r))break;var s=/^(?:Index:|diff(?: -r \w+)+)\s+(.+?)\s*$/.exec(r);s&&(e.index=s[1]),i++}for(a(e),a(e),e.hunks=[];i<n.length;){var u=n[i];if(/^(Index:|diff|\-\-\-|\+\+\+)\s/.test(u))break;if(/^@@/.test(u))e.hunks.push(c());else{if(u&&t.strict)throw new Error("Unknown line "+(i+1)+" "+JSON.stringify(u));i++}}}function a(e){var t=/^(---|\+\+\+)\s+(.*)$/.exec(n[i]);if(t){var r="---"===t[1]?"old":"new",o=t[2].split("\t",2),s=o[0].replace(/\\\\/g,"\\");/^".*"$/.test(s)&&(s=s.substr(1,s.length-2)),e[r+"FileName"]=s,e[r+"Header"]=(o[1]||"").trim(),i++}}function c(){for(var e=i,o=n[i++].split(/@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/),s={oldStart:+o[1],oldLines:+o[2]||1,newStart:+o[3],newLines:+o[4]||1,lines:[],linedelimiters:[]},a=0,c=0;i<n.length&&!(0===n[i].indexOf("--- ")&&i+2<n.length&&0===n[i+1].indexOf("+++ ")&&0===n[i+2].indexOf("@@"));i++){var u=0==n[i].length&&i!=n.length-1?" ":n[i][0];if("+"!==u&&"-"!==u&&" "!==u&&"\\"!==u)break;s.lines.push(n[i]),s.linedelimiters.push(r[i]||"\n"),"+"===u?a++:"-"===u?c++:" "===u&&(a++,c++)}if(a||1!==s.newLines||(s.newLines=0),c||1!==s.oldLines||(s.oldLines=0),t.strict){if(a!==s.newLines)throw new Error("Added line count did not match for hunk at line "+(e+1));if(c!==s.oldLines)throw new Error("Removed line count did not match for hunk at line "+(e+1))}return s}for(;i<n.length;)s();return o}function M(e,t,n){var r=!0,o=!1,i=!1,s=1;return function a(){if(r&&!i){if(o?s++:r=!1,e+s<=n)return s;i=!0}if(!o)return i||(r=!0),t<=e-s?-s++:(o=!0,a())}}function L(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("string"==typeof t&&(t=E(t)),Array.isArray(t)){if(t.length>1)throw new Error("applyPatch only works with a single input.");t=t[0]}var r,o,i=e.split(/\r\n|[\n\v\f\r\x85]/),s=e.match(/\r\n|[\n\v\f\r\x85]/g)||[],a=t.hunks,c=n.compareLine||function(e,t,n,r){return t===r},u=0,l=n.fuzzFactor||0,f=0,h=0;function p(e,t){for(var n=0;n<e.lines.length;n++){var r=e.lines[n],o=r.length>0?r[0]:" ",s=r.length>0?r.substr(1):r;if(" "===o||"-"===o){if(!c(t+1,i[t],o,s)&&++u>l)return!1;t++}}return!0}for(var d=0;d<a.length;d++){for(var g=a[d],m=i.length-g.oldLines,v=0,y=h+g.oldStart-1,b=M(y,f,m);void 0!==v;v=b())if(p(g,y+v)){g.offset=h+=v;break}if(void 0===v)return!1;f=g.offset+g.oldStart+g.oldLines}for(var w=0,k=0;k<a.length;k++){var x=a[k],C=x.oldStart+x.offset+w-1;w+=x.newLines-x.oldLines,C<0&&(C=0);for(var j=0;j<x.lines.length;j++){var S=x.lines[j],A=S.length>0?S[0]:" ",O=S.length>0?S.substr(1):S,N=x.linedelimiters[j];if(" "===A)C++;else if("-"===A)i.splice(C,1),s.splice(C,1);else if("+"===A)i.splice(C,0,O),s.splice(C,0,N),C++;else if("\\"===A){var z=x.lines[j-1]?x.lines[j-1][0]:null;"+"===z?r=!0:"-"===z&&(o=!0)}}}if(r)for(;!i[i.length-1];)i.pop(),s.pop();else o&&(i.push(""),s.push("\n"));for(var L=0;L<i.length-1;L++)i[L]=i[L]+s[L];return i.join("")}function T(e,t){"string"==typeof e&&(e=E(e));var n=0;function r(){var o=e[n++];if(!o)return t.complete();t.loadFile(o,(function(e,n){if(e)return t.complete(e);var i=L(n,o,t);t.patched(o,i,(function(e){if(e)return t.complete(e);r()}))}))}r()}function _(e,t,n,r,o,i,s){s||(s={}),void 0===s.context&&(s.context=4);var a=p(n,r,s);function c(e){return e.map((function(e){return" "+e}))}a.push({value:"",lines:[]});for(var u=[],l=0,f=0,h=[],d=1,g=1,m=function(e){var t=a[e],o=t.lines||t.value.replace(/\n$/,"").split("\n");if(t.lines=o,t.added||t.removed){var i;if(!l){var p=a[e-1];l=d,f=g,p&&(h=s.context>0?c(p.lines.slice(-s.context)):[],l-=h.length,f-=h.length)}(i=h).push.apply(i,w(o.map((function(e){return(t.added?"+":"-")+e})))),t.added?g+=o.length:d+=o.length}else{if(l)if(o.length<=2*s.context&&e<a.length-2){var m;(m=h).push.apply(m,w(c(o)))}else{var v,y=Math.min(o.length,s.context);(v=h).push.apply(v,w(c(o.slice(0,y))));var b={oldStart:l,oldLines:d-l+y,newStart:f,newLines:g-f+y,lines:h};if(e>=a.length-2&&o.length<=s.context){var k=/\n$/.test(n),x=/\n$/.test(r),C=0==o.length&&h.length>b.oldLines;!k&&C&&h.splice(b.oldLines,0,"\\ No newline at end of file"),(k||C)&&x||h.push("\\ No newline at end of file")}u.push(b),l=0,f=0,h=[]}d+=o.length,g+=o.length}},v=0;v<a.length;v++)m(v);return{oldFileName:e,newFileName:t,oldHeader:o,newHeader:i,hunks:u}}function P(e,t,n,r,o,i,s){var a=_(e,t,n,r,o,i,s),c=[];e==t&&c.push("Index: "+e),c.push("==================================================================="),c.push("--- "+a.oldFileName+(void 0===a.oldHeader?"":"\t"+a.oldHeader)),c.push("+++ "+a.newFileName+(void 0===a.newHeader?"":"\t"+a.newHeader));for(var u=0;u<a.hunks.length;u++){var l=a.hunks[u];c.push("@@ -"+l.oldStart+","+l.oldLines+" +"+l.newStart+","+l.newLines+" @@"),c.push.apply(c,l.lines)}return c.join("\n")+"\n"}function F(e,t,n,r,o,i){return P(e,e,t,n,r,o,i)}function H(e,t){return e.length===t.length&&D(e,t)}function D(e,t){if(t.length>e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function $(e){var t=ne(e.lines),n=t.oldLines,r=t.newLines;void 0!==n?e.oldLines=n:delete e.oldLines,void 0!==r?e.newLines=r:delete e.newLines}function R(e,t,n){e=K(e,n),t=K(t,n);var r={};(e.index||t.index)&&(r.index=e.index||t.index),(e.newFileName||t.newFileName)&&(I(e)?I(t)?(r.oldFileName=q(r,e.oldFileName,t.oldFileName),r.newFileName=q(r,e.newFileName,t.newFileName),r.oldHeader=q(r,e.oldHeader,t.oldHeader),r.newHeader=q(r,e.newHeader,t.newHeader)):(r.oldFileName=e.oldFileName,r.newFileName=e.newFileName,r.oldHeader=e.oldHeader,r.newHeader=e.newHeader):(r.oldFileName=t.oldFileName||e.oldFileName,r.newFileName=t.newFileName||e.newFileName,r.oldHeader=t.oldHeader||e.oldHeader,r.newHeader=t.newHeader||e.newHeader)),r.hunks=[];for(var o=0,i=0,s=0,a=0;o<e.hunks.length||i<t.hunks.length;){var c=e.hunks[o]||{oldStart:1/0},u=t.hunks[i]||{oldStart:1/0};if(J(c,u))r.hunks.push(U(c,s)),o++,a+=c.newLines-c.oldLines;else if(J(u,c))r.hunks.push(U(u,a)),i++,s+=u.newLines-u.oldLines;else{var l={oldStart:Math.min(c.oldStart,u.oldStart),oldLines:0,newStart:Math.min(c.newStart+s,u.oldStart+a),newLines:0,lines:[]};W(l,c.oldStart,c.lines,u.oldStart,u.lines),i++,o++,r.hunks.push(l)}}return r}function K(e,t){if("string"==typeof e){if(/^@@/m.test(e)||/^Index:/m.test(e))return E(e)[0];if(!t)throw new Error("Must provide a base reference or pass in a patch");return _(void 0,void 0,t,e)}return e}function I(e){return e.newFileName&&e.newFileName!==e.oldFileName}function q(e,t,n){return t===n?t:(e.conflict=!0,{mine:t,theirs:n})}function J(e,t){return e.oldStart<t.oldStart&&e.oldStart+e.oldLines<t.oldStart}function U(e,t){return{oldStart:e.oldStart,oldLines:e.oldLines,newStart:e.newStart+t,newLines:e.newLines,lines:e.lines}}function W(e,t,n,r,o){var i={offset:t,lines:n,index:0},s={offset:r,lines:o,index:0};for(X(e,i,s),X(e,s,i);i.index<i.lines.length&&s.index<s.lines.length;){var a=i.lines[i.index],c=s.lines[s.index];if("-"!==a[0]&&"+"!==a[0]||"-"!==c[0]&&"+"!==c[0])if("+"===a[0]&&" "===c[0]){var u;(u=e.lines).push.apply(u,w(Q(i)))}else if("+"===c[0]&&" "===a[0]){var l;(l=e.lines).push.apply(l,w(Q(s)))}else"-"===a[0]&&" "===c[0]?B(e,i,s):"-"===c[0]&&" "===a[0]?B(e,s,i,!0):a===c?(e.lines.push(a),i.index++,s.index++):V(e,Q(i),Q(s));else G(e,i,s)}Z(e,i),Z(e,s),$(e)}function G(e,t,n){var r=Q(t),o=Q(n);if(ee(r)&&ee(o)){var i,s;if(D(r,o)&&te(n,r,r.length-o.length))return void(i=e.lines).push.apply(i,w(r));if(D(o,r)&&te(t,o,o.length-r.length))return void(s=e.lines).push.apply(s,w(o))}else if(H(r,o)){var a;return void(a=e.lines).push.apply(a,w(r))}V(e,r,o)}function B(e,t,n,r){var o,i=Q(t),s=Y(n,i);s.merged?(o=e.lines).push.apply(o,w(s.merged)):V(e,r?s:i,r?i:s)}function V(e,t,n){e.conflict=!0,e.lines.push({conflict:!0,mine:t,theirs:n})}function X(e,t,n){for(;t.offset<n.offset&&t.index<t.lines.length;){var r=t.lines[t.index++];e.lines.push(r),t.offset++}}function Z(e,t){for(;t.index<t.lines.length;){var n=t.lines[t.index++];e.lines.push(n)}}function Q(e){for(var t=[],n=e.lines[e.index][0];e.index<e.lines.length;){var r=e.lines[e.index];if("-"===n&&"+"===r[0]&&(n="+"),n!==r[0])break;t.push(r),e.index++}return t}function Y(e,t){for(var n=[],r=[],o=0,i=!1,s=!1;o<t.length&&e.index<e.lines.length;){var a=e.lines[e.index],c=t[o];if("+"===c[0])break;if(i=i||" "!==a[0],r.push(c),o++,"+"===a[0])for(s=!0;"+"===a[0];)n.push(a),a=e.lines[++e.index];c.substr(1)===a.substr(1)?(n.push(a),e.index++):s=!0}if("+"===(t[o]||"")[0]&&i&&(s=!0),s)return n;for(;o<t.length;)r.push(t[o++]);return{merged:r,changes:n}}function ee(e){return e.reduce((function(e,t){return e&&"-"===t[0]}),!0)}function te(e,t,n){for(var r=0;r<n;r++){var o=t[t.length-n+r].substr(1);if(e.lines[e.index+r]!==" "+o)return!1}return e.index+=n,!0}function ne(e){var t=0,n=0;return e.forEach((function(e){if("string"!=typeof e){var r=ne(e.mine),o=ne(e.theirs);void 0!==t&&(r.oldLines===o.oldLines?t+=r.oldLines:t=void 0),void 0!==n&&(r.newLines===o.newLines?n+=r.newLines:n=void 0)}else void 0===n||"+"!==e[0]&&" "!==e[0]||n++,void 0===t||"-"!==e[0]&&" "!==e[0]||t++})),{oldLines:t,newLines:n}}function re(e){for(var t,n,r=[],o=0;o<e.length;o++)n=(t=e[o]).added?1:t.removed?-1:0,r.push([n,t.value]);return r}function oe(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];r.added?t.push("<ins>"):r.removed&&t.push("<del>"),t.push(ie(r.value)),r.added?t.push("</ins>"):r.removed&&t.push("</del>")}return t.join("")}function ie(e){var t=e;return t=(t=(t=(t=t.replace(/&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")).replace(/"/g,"&quot;")}N.tokenize=function(e){return e.slice()},N.join=N.removeEmpty=function(e){return e},e.Diff=t,e.diffChars=i,e.diffWords=l,e.diffWordsWithSpace=f,e.diffLines=p,e.diffTrimmedLines=d,e.diffSentences=m,e.diffCss=y,e.diffJson=A,e.diffArrays=z,e.structuredPatch=_,e.createTwoFilesPatch=P,e.createPatch=F,e.applyPatch=L,e.applyPatches=T,e.parsePatch=E,e.merge=R,e.convertChangesToDMP=re,e.convertChangesToXML=oe,e.canonicalize=O,Object.defineProperty(e,"__esModule",{value:!0})}(t)}(0,_.exports);var P=M(_.exports);function F(e){return null===e?"null":e!==Object(e)?typeof e:{}.toString.call(e).slice(8,-1).toLowerCase()}function H(e){return"string"!==F(e)||!e.length}function D(e="",t,n){if(H(e))return!1;const r=e.charCodeAt(0);return t<=r&&r<=n}const $={HIRAGANA:"toHiragana",KATAKANA:"toKatakana"},R="hepburn",K={useObsoleteKana:!1,passRomaji:!1,upcaseKatakana:!1,IMEMode:!1,convertLongVowelMark:!0,romanization:R},I=65,q=90,J=12353,U=12438,W=12449,G=12540,B=19968,V=40879,X=12540,Z=12539,Q=[65313,65338],Y=[65345,65370],ee=[65377,65381],te=[[12288,12351],ee,[12539,12540],[65281,65295],[65306,65311],[65339,65343],[65371,65376],[65504,65518]],ne=[...[[12352,12447],[12448,12543],ee,[65382,65439]],...te,Q,Y,[65296,65305],[19968,40959],[13312,19903]],re=[[0,127],[256,257],[274,275],[298,299],[332,333],[362,363]],oe=[[32,47],[58,63],[91,96],[123,126],[8216,8217],[8220,8221]];function ie(e=""){return ne.some((([t,n])=>D(e,t,n)))}var se=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function ae(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(r=e[n],o=t[n],!(r===o||se(r)&&se(o)))return!1;var r,o;return!0}function ce(e,t){void 0===t&&(t=ae);var n=null;function r(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];if(n&&n.lastThis===this&&t(r,n.lastArgs))return n.lastResult;var i=e.apply(this,r);return n={lastResult:i,lastArgs:r,lastThis:this},i}return r.clear=function(){n=null},r}var ue=Object.prototype.hasOwnProperty;function le(e,t,n){for(n of e.keys())if(fe(n,t))return n}function fe(e,t){var n,r,o;if(e===t)return!0;if(e&&t&&(n=e.constructor)===t.constructor){if(n===Date)return e.getTime()===t.getTime();if(n===RegExp)return e.toString()===t.toString();if(n===Array){if((r=e.length)===t.length)for(;r--&&fe(e[r],t[r]););return-1===r}if(n===Set){if(e.size!==t.size)return!1;for(r of e){if((o=r)&&"object"==typeof o&&!(o=le(t,o)))return!1;if(!t.has(o))return!1}return!0}if(n===Map){if(e.size!==t.size)return!1;for(r of e){if((o=r[0])&&"object"==typeof o&&!(o=le(t,o)))return!1;if(!fe(r[1],t.get(o)))return!1}return!0}if(n===ArrayBuffer)e=new Uint8Array(e),t=new Uint8Array(t);else if(n===DataView){if((r=e.byteLength)===t.byteLength)for(;r--&&e.getInt8(r)===t.getInt8(r););return-1===r}if(ArrayBuffer.isView(e)){if((r=e.byteLength)===t.byteLength)for(;r--&&e[r]===t[r];);return-1===r}if(!n||"object"==typeof e){for(n in r=0,e){if(ue.call(e,n)&&++r&&!ue.call(t,n))return!1;if(!(n in t)||!fe(e[n],t[n]))return!1}return Object.keys(t).length===r}}return e!=e&&t!=t}const he=(e={})=>Object.assign({},K,e);function pe(e,t,n){const r=t;function o(e,t){const n=e.charAt(0);return i(Object.assign({"":n},r[n]),e.slice(1),t,t+1)}function i(e,t,r,s){if(!t)return n||1===Object.keys(e).length?e[""]?[[r,s,e[""]]]:[]:[[r,s,null]];if(1===Object.keys(e).length)return[[r,s,e[""]]].concat(o(t,s));const a=function(e,t){if(void 0!==e[t])return Object.assign({"":e[""]+t},e[t])}(e,t.charAt(0));return void 0===a?[[r,s,e[""]]].concat(o(t,s)):i(a,t.slice(1),r,s+1)}return o(e,0)}function de(e){return Object.entries(e).reduce(((e,[t,n])=>{const r="string"===F(n);return e[t]=r?{"":n}:de(n),e}),{})}function ge(e,t){return t.split("").reduce(((e,t)=>(void 0===e[t]&&(e[t]={}),e[t])),e)}function me(e={}){const t={};return"object"===F(e)&&Object.entries(e).forEach((([e,n])=>{let r=t;e.split("").forEach((e=>{void 0===r[e]&&(r[e]={}),r=r[e]})),r[""]=n})),function(e){return function e(t,n){return void 0===t||"string"===F(t)?n:Object.entries(n).reduce(((n,[r,o])=>(n[r]=e(t[r],o),n)),t)}(JSON.parse(JSON.stringify(e)),t)}}function ve(e,t){return t?"function"===F(t)?t(e):me(t)(e):e}const ye={a:"あ",i:"い",u:"う",e:"え",o:"お",k:{a:"か",i:"き",u:"く",e:"け",o:"こ"},s:{a:"さ",i:"し",u:"す",e:"せ",o:"そ"},t:{a:"た",i:"ち",u:"つ",e:"て",o:"と"},n:{a:"な",i:"に",u:"ぬ",e:"ね",o:"の"},h:{a:"は",i:"ひ",u:"ふ",e:"へ",o:"ほ"},m:{a:"ま",i:"み",u:"む",e:"め",o:"も"},y:{a:"や",u:"ゆ",o:"よ"},r:{a:"ら",i:"り",u:"る",e:"れ",o:"ろ"},w:{a:"わ",i:"ゐ",e:"ゑ",o:"を"},g:{a:"が",i:"ぎ",u:"ぐ",e:"げ",o:"ご"},z:{a:"ざ",i:"じ",u:"ず",e:"ぜ",o:"ぞ"},d:{a:"だ",i:"ぢ",u:"づ",e:"で",o:"ど"},b:{a:"ば",i:"び",u:"ぶ",e:"べ",o:"ぼ"},p:{a:"ぱ",i:"ぴ",u:"ぷ",e:"ぺ",o:"ぽ"},v:{a:"ゔぁ",i:"ゔぃ",u:"ゔ",e:"ゔぇ",o:"ゔぉ"}},be={".":"。",",":"、",":":"：","/":"・","!":"！","?":"？","~":"〜","-":"ー","‘":"「","’":"」","“":"『","”":"』","[":"［","]":"］","(":"（",")":"）","{":"｛","}":"｝"},we={k:"き",s:"し",t:"ち",n:"に",h:"ひ",m:"み",r:"り",g:"ぎ",z:"じ",d:"ぢ",b:"び",p:"ぴ",v:"ゔ",q:"く",f:"ふ"},ke={ya:"ゃ",yi:"ぃ",yu:"ゅ",ye:"ぇ",yo:"ょ"},xe={a:"ぁ",i:"ぃ",u:"ぅ",e:"ぇ",o:"ぉ"},Ce={sh:"sy",ch:"ty",cy:"ty",chy:"ty",shy:"sy",j:"zy",jy:"zy",shi:"si",chi:"ti",tsu:"tu",ji:"zi",fu:"hu"},je=Object.assign({tu:"っ",wa:"ゎ",ka:"ヵ",ke:"ヶ"},xe,ke),Se={yi:"い",wu:"う",ye:"いぇ",wi:"うぃ",we:"うぇ",kwa:"くぁ",whu:"う",tha:"てゃ",thu:"てゅ",tho:"てょ",dha:"でゃ",dhu:"でゅ",dho:"でょ"},Ae={wh:"う",kw:"く",qw:"く",q:"く",gw:"ぐ",sw:"す",ts:"つ",th:"て",tw:"と",dh:"で",dw:"ど",fw:"ふ",f:"ふ"};function Oe(){const e=de(ye),t=t=>ge(e,t);function n(e){return Object.entries(e).reduce(((e,[t,r])=>(e[t]=t?n(r):`っ${r}`,e)),{})}return Object.entries(we).forEach((([e,n])=>{Object.entries(ke).forEach((([r,o])=>{t(e+r)[""]=n+o}))})),Object.entries(be).forEach((([e,n])=>{t(e)[""]=n})),Object.entries(Ae).forEach((([e,n])=>{Object.entries(xe).forEach((([r,o])=>{t(e+r)[""]=n+o}))})),["n","n'","xn"].forEach((e=>{t(e)[""]="ん"})),e.c=JSON.parse(JSON.stringify(e.k)),Object.entries(Ce).forEach((([e,n])=>{const r=e.slice(0,e.length-1),o=e.charAt(e.length-1);t(r)[o]=JSON.parse(JSON.stringify(t(n)))})),Object.entries(je).forEach((([e,n])=>{const r=e=>e.charAt(e.length-1),o=e=>e.slice(0,e.length-1),i=t(`x${e}`);i[""]=n;var s;t(`l${o(e)}`)[r(e)]=i,(s=e,[...Object.entries(Ce),["c","k"]].reduce(((e,[t,n])=>s.startsWith(n)?e.concat(s.replace(n,t)):e),[])).forEach((n=>{["l","x"].forEach((i=>{t(i+o(n))[r(n)]=t(i+e)}))}))})),Object.entries(Se).forEach((([e,n])=>{t(e)[""]=n})),[...Object.keys(we),"c","y","w","j"].forEach((t=>{const r=e[t];r[t]=n(r)})),delete e.n.n,Object.freeze(JSON.parse(JSON.stringify(e)))}let Ne=null;const ze=me({wi:"ゐ",we:"ゑ"});function Ee(e=""){return!H(e)&&D(e,I,q)}function Me(e=""){return!H(e)&&e.charCodeAt(0)===X}function Le(e=""){return!H(e)&&e.charCodeAt(0)===Z}function Te(e=""){return!H(e)&&(!!Me(e)||D(e,J,U))}function _e(e=""){const t=[];return e.split("").forEach((e=>{if(Me(e)||Le(e))t.push(e);else if(Te(e)){const n=e.charCodeAt(0)+(W-J),r=String.fromCharCode(n);t.push(r)}else t.push(e)})),t.join("")}const Pe=ce(((e,t,n)=>{let r=(null==Ne&&(Ne=Oe()),Ne);return r=e?function(e){const t=JSON.parse(JSON.stringify(e));return t.n.n={"":"ん"},t.n[" "]={"":"ん"},t}(r):r,r=t?ze(r):r,n&&(r=ve(r,n)),r}),fe);function Fe(e="",t={},n){let r;return n?r=t:(r=he(t),n=Pe(r.IMEMode,r.useObsoleteKana,r.customKanaMapping)),function(e="",t={},n){const{IMEMode:r,useObsoleteKana:o,customKanaMapping:i}=t;n||(n=Pe(r,o,i));return pe(e.toLowerCase(),n,!r)}(e,r,n).map((t=>{const[n,o,i]=t;if(null===i)return e.slice(n);const s=r.IMEMode===$.HIRAGANA,a=r.IMEMode===$.KATAKANA||[...e.slice(n,o)].every(Ee);return s||!a?i:_e(i)})).join("")}function He(e=""){return!H(e)&&re.some((([t,n])=>D(e,t,n)))}function De(e="",t){const n="regexp"===F(t);return!H(e)&&[...e].every((e=>{const r=He(e);return n?r||t.test(e):r}))}function $e(e=""){return D(e,W,G)}function Re(e=""){return!H(e)&&[...e].every(Te)}function Ke(e=""){return!H(e)&&[...e].every($e)}function Ie(e=""){return D(e,B,V)}function qe(e=""){return!H(e)&&[...e].every(Ie)}function Je(e="",t={passKanji:!0}){const n=[...e];let r=!1;return t.passKanji||(r=n.some(qe)),(n.some(Re)||n.some(Ke))&&n.some(De)&&!r}const Ue=(e,t)=>Me(e)&&t<1,We=(e,t)=>Me(e)&&t>0,Ge=e=>["ヶ","ヵ"].includes(e),Be={a:"あ",i:"い",u:"う",e:"え",o:"う"};function Ve(e="",t,{isDestinationRomaji:n,convertLongVowelMark:r}={}){let o="";return e.split("").reduce(((i,s,a)=>{if(Le(s)||Ue(s,a)||Ge(s))return i.concat(s);if(r&&o&&We(s,a)){const r=t(o).slice(-1);return $e(e[a-1])&&"o"===r&&n?i.concat("お"):i.concat(Be[r])}if(!Me(s)&&$e(s)){const e=s.charCodeAt(0)+(J-W),t=String.fromCharCode(e);return o=t,i.concat(t)}return o="",i.concat(s)}),[]).join("")}let Xe=null;const Ze={"あ":"a","い":"i","う":"u","え":"e","お":"o","か":"ka","き":"ki","く":"ku","け":"ke","こ":"ko","さ":"sa","し":"shi","す":"su","せ":"se","そ":"so","た":"ta","ち":"chi","つ":"tsu","て":"te","と":"to","な":"na","に":"ni","ぬ":"nu","ね":"ne","の":"no","は":"ha","ひ":"hi","ふ":"fu","へ":"he","ほ":"ho","ま":"ma","み":"mi","む":"mu","め":"me","も":"mo","ら":"ra","り":"ri","る":"ru","れ":"re","ろ":"ro","や":"ya","ゆ":"yu","よ":"yo","わ":"wa","ゐ":"wi","ゑ":"we","を":"wo","ん":"n","が":"ga","ぎ":"gi","ぐ":"gu","げ":"ge","ご":"go","ざ":"za","じ":"ji","ず":"zu","ぜ":"ze","ぞ":"zo","だ":"da","ぢ":"ji","づ":"zu","で":"de","ど":"do","ば":"ba","び":"bi","ぶ":"bu","べ":"be","ぼ":"bo","ぱ":"pa","ぴ":"pi","ぷ":"pu","ぺ":"pe","ぽ":"po","ゔぁ":"va","ゔぃ":"vi","ゔ":"vu","ゔぇ":"ve","ゔぉ":"vo"},Qe={"。":".","、":",","：":":","・":"/","！":"!","？":"?","〜":"~","ー":"-","「":"‘","」":"’","『":"“","』":"”","［":"[","］":"]","（":"(","）":")","｛":"{","｝":"}","　":" "},Ye=["あ","い","う","え","お","や","ゆ","よ"],et={"ゃ":"ya","ゅ":"yu","ょ":"yo"},tt={"ぃ":"yi","ぇ":"ye"},nt={"ぁ":"a","ぃ":"i","ぅ":"u","ぇ":"e","ぉ":"o"},rt=["き","に","ひ","み","り","ぎ","び","ぴ","ゔ","く","ふ"],ot={"し":"sh","ち":"ch","じ":"j","ぢ":"j"},it={"っ":"","ゃ":"ya","ゅ":"yu","ょ":"yo","ぁ":"a","ぃ":"i","ぅ":"u","ぇ":"e","ぉ":"o"},st={b:"b",c:"t",d:"d",f:"f",g:"g",h:"h",j:"j",k:"k",m:"m",p:"p",q:"q",r:"r",s:"s",t:"t",v:"v",w:"w",x:"x",z:"z"};function at(){return null==Xe&&(Xe=function(){const e=de(Ze),t=t=>ge(e,t),n=(e,n)=>{t(e)[""]=n};return Object.entries(Qe).forEach((([e,n])=>{t(e)[""]=n})),[...Object.entries(et),...Object.entries(nt)].forEach((([e,t])=>{n(e,t)})),rt.forEach((e=>{const r=t(e)[""][0];Object.entries(et).forEach((([t,o])=>{n(e+t,r+o)})),Object.entries(tt).forEach((([t,o])=>{n(e+t,r+o)}))})),Object.entries(ot).forEach((([e,t])=>{Object.entries(et).forEach((([r,o])=>{n(e+r,t+o[1])})),n(`${e}ぃ`,`${t}yi`),n(`${e}ぇ`,`${t}e`)})),e["っ"]=ct(e),Object.entries(it).forEach((([e,t])=>{n(e,t)})),Ye.forEach((e=>{n(`ん${e}`,`n'${t(e)[""]}`)})),Object.freeze(JSON.parse(JSON.stringify(e)))}()),Xe}function ct(e){return Object.entries(e).reduce(((e,[t,n])=>{if(t)e[t]=ct(n);else{const r=n.charAt(0);e[t]=Object.keys(st).includes(r)?st[r]+n:n}return e}),{})}const ut=ce(((e,t)=>{let n=function(e){return e===R?at():{}}(e);return t&&(n=ve(n,t)),n}),fe);function lt(e="",t={},n){const r=he(t);return n||(n=ut(r.romanization,r.customRomajiMapping)),function(e,t,n){n||(n=ut(t.romanization,t.customRomajiMapping));const r=Object.assign({},{isDestinationRomaji:!0},t);return pe(Ve(e,lt,r),n,!t.IMEMode)}(e,r,n).map((t=>{const[n,o,i]=t;return r.upcaseKatakana&&Ke(e.slice(n,o))?i.toUpperCase():i})).join("")}function ft(e=""){return!H(e)&&oe.some((([t,n])=>D(e,t,n)))}function ht(e="",t={}){const n=he(t);if(n.passRomaji)return Ve(e,lt,n);if(Je(e,{passKanji:!0})){return Fe(Ve(e,lt,n).toLowerCase(),n)}return De(e)||ft(e)?Fe(e.toLowerCase(),n):Ve(e,lt,n)}function pt(e="",t={}){const n=he(t);if(n.passRomaji)return _e(e);if(Je(e)||De(e)||ft(e)){return _e(Fe(e.toLowerCase(),n))}return _e(e)}function dt(e=""){return!H(e)&&te.some((([t,n])=>D(e,t,n)))}const gt=e=>" "===e,mt=e=>"　"===e,vt=e=>/[０-９]/.test(e),yt=e=>/[0-9]/.test(e),bt={EN:"en",JA:"ja",EN_NUM:"englishNumeral",JA_NUM:"japaneseNumeral",EN_PUNC:"englishPunctuation",JA_PUNC:"japanesePunctuation",KANJI:"kanji",HIRAGANA:"hiragana",KATAKANA:"katakana",SPACE:"space",OTHER:"other"};function wt(e,t=!1){const{EN:n,JA:r,EN_NUM:o,JA_NUM:i,EN_PUNC:s,JA_PUNC:a,KANJI:c,HIRAGANA:u,KATAKANA:l,SPACE:f,OTHER:h}=bt;if(t)switch(!0){case vt(e):case yt(e):return h;case gt(e):return n;case ft(e):return h;case mt(e):return r;case dt(e):return h;case ie(e):return r;case He(e):return n;default:return h}else switch(!0){case mt(e):case gt(e):return f;case vt(e):return i;case yt(e):return o;case ft(e):return s;case dt(e):return a;case Ie(e):return c;case Te(e):return u;case $e(e):return l;case ie(e):return r;case He(e):return n;default:return h}}function kt(e,{compact:t=!1,detailed:n=!1}={}){if(null==e||H(e))return[];const r=[...e];let o=r.shift(),i=wt(o,t);o=n?{type:i,value:o}:o;return r.reduce(((e,r)=>{const o=wt(r,t),s=o===i;i=o;let a=r;return s&&(a=(n?e.pop().value:e.pop())+a),n?e.concat({type:o,value:a}):e.concat(a)}),[o])}const xt=e=>!["ja","zh","zs"].includes(e),Ct=T(x),jt=(e,t,n)=>{let r,o=e;if(n&&(o=o.filter((e=>!/[^\s]\s+[^\s]/.test(e)))),"en"===t)o=o.filter((e=>1===e.length||!e.includes("&")||!/(^|[^&\s])&([^&\s]|$)/.test(e)));else if("fr"===t)o=o.filter((e=>"où"===e||"Où"===e||!e.includes("ù")));else if("de"===t){const e=["ä","ö","ü"],t=["ae","oe","ue"];for(let n=0;n<=e.length;n++)o.includes((t=>t.includes(e[n])))&&!o.includes((e=>e.includes[t[n]]))&&(o=o.filter((t=>t.includes(e[n]))))}var i;return[r,o]=((e,t)=>{const n=[[],[]];for(let r=0,o=e.length;r<o;r++)n[t(e[r])?0:1].push(e[r]);return n})(o,(e=>e.includes("i̇"))),"tr"!==t&&(o=o.filter((e=>!e.includes("ı")&&!e.includes("İ")))),0===o.length&&(o=r.map((e=>e.replaceAll("i̇","i").replaceAll("İ","I")))),o.length>1&&(i=o.sort(((e,n)=>Ct(e,n,t))),o=m(i,(()=>-1))),o.length>1&&(o=m(o,((e,t,n)=>t===n?-1:e===n?1:0),(e=>e.normalize("NFD").replace(/\p{M}/u,"").replace(/[^\p{L}\p{N}]/u,"")))),o},St=(e,t,n)=>{let r=jt(e.map((e=>String(e.orig||e.lenient||""))),t,n);return{token:r,solutionBase:{reference:r[0]||"",isComplex:r.length>1}}},At={size:0},Ot=(e,t,n,r)=>{if(!e[t])return[];if(i(e[t].solutions))return e[t].solutions;let o=[];for(const i of Object.keys(e[t])){const s=Number(i),a=e[t][s],c=Ot(e,s,n,r),{token:u,solutionBase:l}=St(a,n,r);if(c.length>0)for(const e of c)o.push({locale:n,reference:l.reference+e.reference,isComplex:l.isComplex||e.isComplex,tokens:0===u.length?e.tokens:{token:u,next:e.tokens,size:e.tokens.size+1}});else s===e.length-1&&(l.locale=n,l.tokens=0===u.length?At:{token:u,next:At,size:1},o.push(l))}return e[t].solutions=o,o},Nt=(e,t)=>{const n={kana:{convert:pt,replacements:{},flags:4},hiragana:{convert:ht,replacements:{},flags:2}},a=[r];if(i(t.token_transliterations))for(const e of t.token_transliterations.flatMap((e=>(null==e?void 0:e.tokens)||[])))if(s(e)&&o(e.token)&&i(e.transliterations))for(const t of e.transliterations)n[null==t?void 0:t.type]&&(n[t.type].replacements[e.token]=t.text);for(const{convert:e,replacements:t,flags:r}of Object.values(n))a.push((({sentence:n})=>{const o=kt(n.replace(new RegExp(Object.keys(t).join("|"),"giu"),(e=>{var n;return null!==(n=t[e])&&void 0!==n?n:e})),{compact:!0,detailed:!0});return{flags:r,sentence:o.map((({type:t,value:n})=>"ja"===t?e(n):n)).join("")}}));return Object.values(d(e.flatMap((e=>a.map((t=>t(e))))),(e=>e.sentence))).map((e=>({sentence:e[0].sentence,flags:e.reduce(((e,t)=>e|t.flags),0)})))},zt=(e,t,n)=>{const r={locale:n,patterns:[]},o=xt(n);let i=e.map((e=>({flags:1,sentence:e.normalize("NFC")})));"ja"===n&&(i=Nt(i,t));const s=e=>{return(t=e,o?t.split(/([^\p{L}\p{N}]+)/u):[t]).filter((e=>""!==e));var t};for(const{sentence:e,flags:t}of i){let i=0;const a=[],c=[],u=e.matchAll(o?/([^\s[]*\[[^[]+\][^\s[]*)+/gu:/\[([^\]]+)\]/gu);for(const t of u){if(t.index>i){const n=e.substring(i,t.index);if(""!==n){const e=s(n);c.push(...e)}}let r;const u=o&&(0===c.length||!!c.at(-1).match(/\p{Sentence_Terminal}\s*$/gu));if(o){r=[""];let e=0;const o=t[0].matchAll(/\[([^[]+)]/g);for(const n of o){if(n.index>e){const o=t[0].substring(e,n.index);r=r.map((e=>e+o))}const o=n[1].split(/\//);r=o.flatMap((e=>r.map((t=>t+e)))),e=n.index+n[0].length}if(e<t[0].length){const[,n,o]=t[0].substring(e).match(/(.*?)([^\p{L}\p{N}]*)$/u);r=r.map((e=>e+n)),o.length>0&&(t[0]=t[0].slice(0,-o.length))}r.sort(((e,t)=>x(e,t,n))),r=d(r.map(s),(e=>e.length))}else r=d(t[1].split(/\//).map(s),(e=>e.length));const l=[],f=Object.entries(r);for(const[e,t]of f){const r=Number(e);if(r>1){const e=Array.from(t.keys()),i=Object.values(d(e,(e=>t[e].slice(1).join("")))).filter((e=>e.length>1)),s=Object.values(d(e,(e=>t[e].slice(0,-1).join("")))).filter((e=>e.length>1)),a=new Set;if(o&&r>=3){const n=Object.values(d(e,(e=>t[e].slice(1,-1).join("")))).filter((e=>e.length>1));for(const e of n){const n=Object.values(d(e,(e=>t[e].slice(1).join("")))).filter((e=>e.length>1)).map((e=>e.map((e=>t[e][1].match(/\s/)&&t[e][0])).filter(Boolean))),r=Object.values(d(Array.from(n.keys()),(e=>n[e].join("/")))).filter((e=>e.length>1));for(const e of r)l.push({sharedTokens:t[i[e[0]][0]].slice(1,-1),firstChoice:i[e[0]].map((e=>t[e][0])),lastChoice:e.map((e=>t[i[e][0]].at(-1)))}),e.flatMap((e=>i[e])).forEach((e=>a.add(e)))}}for(let e of i)if(e=e.filter((e=>!a.has(e))),e.length>1){const r=e.map((e=>t[e][0])).sort(((e,t)=>x(e,t,n)));l.push({sharedTokens:t[e[0]].slice(1),firstChoice:r,lastChoice:[]}),e.forEach((e=>a.add(e)))}for(let e of s)if(e=e.filter((e=>!a.has(e))),e.length>1){const r=e.map((e=>t[e].at(-1))).sort(((e,t)=>x(e,t,n)));l.push({sharedTokens:t[e[0]].slice(0,-1),firstChoice:[],lastChoice:r}),e.forEach((e=>a.add(e)))}for(const n of e)a.has(n)||l.push({sharedTokens:t[n],firstChoice:[],lastChoice:[]})}else{const n=u&&0===r&&f.every((t=>t[0]===e||t[1].some((e=>{var t;return null===(t=e[0])||void 0===t?void 0:t.match(/^\s*[\p{N}\p{Lu}]/gu)}))));l.push({sharedTokens:[],firstChoice:t.flat(),lastChoice:[],shouldTitleCaseNextNonSpaceToken:n})}}a.push({branches:l,tokenPosition:c.length}),i=t.index+t[0].length}if(i<e.length){const t=s(e.substring(i));c.push(...t)}let l=1;for(let e=a.length-1;e>=0;e--){a[e].branchSize=l,l=a[e].branches.length*l;for(const t of a[e].branches)1===t.firstChoice.length&&t.sharedTokens.unshift(t.firstChoice.pop()),1===t.lastChoice.length&&t.sharedTokens.push(t.lastChoice.pop())}r.patterns.push({flags:t,size:l,branchSets:a,sharedTokens:c})}r.size=r.patterns.reduce(((e,t)=>e+t.size),0);const a=[];for(let e=0;e<r.size;e++)a.push(Lt(r,e));return a},Et=(e,t,n)=>{let r=e.filter(o).map((e=>e.trim())).filter((e=>""!==e)).map(k);return r="ja"===n?Nt(r,t):r.map((e=>({sentence:e}))),r.map((({sentence:e,flags:t})=>{const r=k(e),o=r.split(/([\p{L}\p{N}]+)/gu).map((e=>[e]));return{locale:n,reference:r,tokens:o,flags:t,isComplex:!1}}))},Mt=(e,t,n)=>{const r=[];let o=0,s="",a=!1,c=!1;const u=e=>{i(e)?(c&&(c=!1,e=e.map((e=>e.replace(/[\p{L}\p{N}]/u,(e=>e.toLocaleUpperCase(n)))))),r.push(e),s+=e[0]):(c&&""!==e.trim()&&(c=!1,e=e.replace(/[\p{L}\p{N}]/u,(e=>e.toLocaleUpperCase(n)))),s+=e,r.push([e]))};for(const n of e.branchSets){for(let t=o;t<n.tokenPosition;t++)u(e.sharedTokens[t]);const r=n.branches[Math.floor(t/n.branchSize)];if(r.firstChoice.length>0&&(a=!0,u(r.firstChoice)),r.sharedTokens.length>0)for(const e of r.sharedTokens)u(e);r.lastChoice.length>0&&(a=!0,u(r.lastChoice)),o=n.tokenPosition,t%=n.branchSize,c=c||!!r.shouldTitleCaseNextNonSpaceToken}for(let t=o;t<e.sharedTokens.length;t++)u(e.sharedTokens[t]);return{locale:n,reference:s,tokens:r,isComplex:a,flags:e.flags}},Lt=(e,t)=>{for(const n of e.patterns){if(!(t>=n.size))return Mt(n,t,e.locale);t-=n.size}return null},Tt=Symbol("summary"),_t=T(((e,t)=>C(k(e,!0,!1).toLocaleLowerCase(t)))),Pt=T(((e,t)=>C(k(e,!0,!0).toLocaleLowerCase(t)))),Ft=(e,t,n)=>{const r=new Set,o=e.tokens.map((t=>t.map((e=>e.trim())).filter((e=>""!==e)).map((t=>{const o=((e,t,n)=>n.ignoreDiacritics?Pt(e,t):_t(e,t))(t,e.locale,n);return o.forEach((e=>r.add(e))),o})))).filter((e=>e.length>0));e.matchingData={id:t,tokens:o,words:Array.from(r)}},Ht=(e,t,n)=>{var r;const o=k((e=>{if(!e[Tt]){const t=xt(e.locale)?"":" ";e[Tt]=e.tokens.reduce(((e,n)=>e+(1===n.length?n[0]:`${t}[${t}${n.join(" / ")}${t}]${t}`)),"")}return e[Tt]})(e),!0,n.ignoreDiacritics).toLocaleLowerCase(e.locale),i=(null===(r=/^[^\p{L}\p{N}]*(.*?)[^\p{L}\p{N}]*?$/gu.exec(o))||void 0===r?void 0:r[1])||o;e.matchingData={id:t,summary:i}},Dt={charCount:0,wordCount:0,bigramMap:new Map},$t=Symbol("word_stats"),Rt=e=>({charCount:e.length,wordCount:1,bigramMap:j(e)}),Kt=e=>0===e.length?Dt:{charCount:p(e,(e=>e.charCount)),wordCount:p(e,(e=>e.wordCount)),bigramMap:v(((e,t)=>e+t),...e.map((e=>e.bigramMap)))},It=(e,t,n)=>{const r=(e=>{if(!e.matchingData)return{shared:Dt};if(!e[$t]){const{false:t=[],true:n=[]}=d(e.matchingData.tokens,(e=>e.length>1));e[$t]={shared:Kt(t.flatMap((e=>e[0].map((e=>Rt(e))))))};const r=n.map((e=>e.map((e=>Kt(e.map((e=>Rt(e))))))));if(r.length>0){const t=g(r);e[$t].paths=t.map(Kt)}}return e[$t]})(e),o=Kt(((e,t,n)=>C(k(e,!0,n.ignoreDiacritics).toLocaleLowerCase(t)))(t,e.locale,n).map(Rt)),i=o.charCount+r.shared.charCount,s=o.wordCount+r.shared.wordCount;let a=0;for(const[e,t]of o.bigramMap){const n=r.shared.bigramMap.get(e)||0;n>0&&(a+=Math.min(t,n),o.bigramMap.set(e,Math.max(0,t-n)))}return r.paths?r.paths.map((e=>{let t=0;for(const[n,r]of o.bigramMap){const o=e.bigramMap.get(n)||0;o>0&&(t+=Math.min(r,o))}const n=i+e.charCount,r=s+e.wordCount;return 2*(a+t)/(n-r)})):[2*a/(i-s)]},qt={ru:{"ё":"е"}},Jt=(e,t)=>{const n=qt[t],r=k(e).toLocaleLowerCase(t);return s(n)?r.replace(new RegExp(`(${Object.keys(n).join("|")})`,"g"),(e=>n[e])):r},Ut=(e,t)=>(e.type&t)>0,Wt=e=>e.key||`_duo-sv_-${e.type}-${e.statement}`,getParsedSolutionList=(e,t)=>{if(e.solutions.parsed)return e.solutions;let n;const{locale:r,metadata:o}=e.solutions,i=getAvailableSolutionListTypes(e);var s;i.includes(t)||(t=null!==(s=i[0])&&void 0!==s?s:null);return n=E===t?((e,t,n)=>{let r=Ot(e.map((e=>d(e.filter((e=>{return!(t=e).auto&&"typo"!==t.type;var t})),(e=>e.to)))),0,t,n);for(const e of r){let t=0,n=e.tokens;const r=new Array(e.tokens.size);for(;n.token;)r[t++]=n.token,n=n.next;e.tokens=r}return r=Object.values(d(r,(e=>e.reference))).flatMap((e=>e.length<=1?e:e.some((e=>e.isComplex))?e.filter((e=>e.isComplex)):e.slice(-1))),r})(e.solutions.graph,r,o.isWhitespaceDelimited||xt(r)):z===t?zt(e.solutions.patterns,o,r):[],{parsed:!0,locale:r,type:t,list:n}},getAvailableSolutionListTypes=e=>e.solutions.parsed&&[e.solutions.type]||[e.solutions.graph&&E,e.solutions.patterns&&z].filter(o),addSimilarityScoresToSolutionList=(e,t)=>{(e=>{if(!s(e.matchingData)){if(!e.parsed)throw new Error("Cannot add matching data to an unparsed solution list.");const t=e.locale,n={ignoreDiacritics:!1,ignoreWordOrder:!0};if(e.matchingData={matchingOptions:n,locale:t},xt(t)){const t=new Set;e.list.forEach(((e,r)=>{Ft(e,r,n);for(const n of e.matchingData.words)t.add(n)})),e.matchingData.words=Array.from(t)}else e.list.forEach(((e,t)=>Ht(e,t,n)))}})(e),""!==t&&e.matchingData.words&&e.list.forEach((n=>{n.score=((e,t,n)=>f(It(e,t,n)))(n,t,e.matchingData.matchingOptions)}))},getUiChallengeSolutionList=e=>{const t=s(e.grader)?e.grader:{},n=s(e.metadata)?{...e.metadata}:{},r=String(e.targetLanguage||t.language||n.target_language||n.language||"").trim(),a=(e,t=z)=>({parsed:!0,locale:r,type:t,list:e});if(i(e.correctSolutions)&&O.includes(e.type))return a(Et(e.correctSolutions,n,r));const c=i(e.compactTranslations)&&e.compactTranslations.length>0;if("ja"===r&&c)return{parsed:!1,locale:r,metadata:n,patterns:e.compactTranslations};const u=s(t)&&i(t.vertices)&&t.vertices.length>0;if(u||c){const o={parsed:!1,locale:r,metadata:n};return u&&(o.graph=t.vertices,n.isWhitespaceDelimited=!!t.whitespaceDelimited),c&&(o.patterns=e.compactTranslations),o}return o(e.prompt)&&""!==e.prompt&&A.includes(e.type)?a(Et([e.prompt],n,r)):i(e.correctTokens)&&N.includes(e.type)?a(((e,t,n)=>Et(e.filter(o).join(" "),t,n))(e.correctTokens,n,r)):null},Gt=e=>{var t;return`${String((null===(t=e.tab)||void 0===t?void 0:t.id)||"global")}-${String(e.frameId||"main")}`},Bt=[],Vt={},Xt=[],Zt=(e,t,n)=>i(Bt[e])?Bt[e].find((e=>Ut(e,t)&&n(e))):null,Qt=async(e,t,n,o)=>{const i=((e,t,n)=>e.map((e=>{const r=getUiChallengeSolutionList(e);if(r){const o=String(e.id||Math.floor(Math.random()*Number.MAX_SAFE_INTEGER)).trim(),i=k(String(e.prompt||""));if(""!==i&&S.includes(e.type))return{key:o,type:O.includes(e.type)?3:1,statement:i,solutions:r,fromLanguage:t,toLanguage:n};if(A.includes(e.type)&&""!==String(e.solutionTranslation||"").trim()){const s=k(String(e.solutionTranslation)),a=String(e.tts||"").trim(),c=String(e.slowTts||"").trim();return{key:o,type:4,statement:i,solutions:r,fromLanguage:t,toLanguage:n,solutionTranslation:s,ttsMediaUrl:a,slowTtsMediaUrl:c}}}})).filter(s))(t,n,o);Bt[e]=function(e,t,n=r){if(e.length<=1)return e.slice();const o=new Map;for(const r of e){const e=n(r);o.has(e)?1===t(o.get(e),r,e)&&(o.delete(e),o.set(e,r)):o.set(e,r)}return Array.from(o.values())}((Bt[e]||[]).concat(i).splice(-200),(()=>1),(e=>Wt(e)))},getChallengeParsedSolutionList=(e,t)=>{if(e.solutions.parsed)return e.solutions;const n=Wt(e),r=Xt.find((e=>e.key===n&&e.type===t));if(r)return r.list;const o=getParsedSolutionList(e,t);return o.otherTypes=getAvailableSolutionListTypes(e).filter((e=>e!==o.type)),Xt.splice(0,Math.max(0,Xt.length+1-20)),Xt.push({key:n,type:t,list:o}),o},Yt=async(e,t,n)=>{if(s(t)){let r,a=()=>!0;const c=o(t.userAnswer)?k(t.userAnswer):"";if(o(t.solutionTranslation)&&""!==t.solutionTranslation){const e=k(t.solutionTranslation);a=t=>e===t.solutionTranslation}if(r=((e,t,n)=>i(Bt[e])?Bt[e].filter((e=>Ut(e,t)&&n(e))):[])(e,4,a),0===r.length)return;let u=null;if(o(t.solutionTranslation)&&""!==t.solutionTranslation&&1===r.length)u=r.pop();else{const t=Vt[e];u=Vt[e]&&r.find((e=>{return r=t,!!(n=e).ttsMediaUrl&&n.ttsMediaUrl===r.ttsMediaUrl||!!n.slowTtsMediaUrl&&n.slowTtsMediaUrl===r.slowTtsMediaUrl;var n,r}))}if(!s(u))return;const d=getChallengeParsedSolutionList(u,t.listType||z);addSimilarityScoresToSolutionList(d,c);const m={challenge:{...r,solutions:d}};if(""!==c&&"correct"===t.result){let e;const t=u.solutions.locale||null,n=d.matchingData.matchingOptions;if("ja"!==t){if(d.list.some((e=>"score"in e))){const t=l(d.list,(e=>e.score));e=d.list.filter((e=>t===e.score)).flatMap((e=>((e,t,n)=>{if(!e.isComplex)return[e.reference];const r=e.tokens.length;if(0===r)return[];const i=It(e,t,n),s=f(i),a=[e.tokens[r-1].length,1];for(let t=r-2;t>=1;t--)a.unshift(a[0]*e.tokens[t].length);return i.map(((t,n)=>{if(t<s)return null;let o=n,i="";for(let t=0;t<r;t++)if(1===e.tokens[t].length)i+=e.tokens[t][0];else{const n=Math.floor(o/a[t]);i+=e.tokens[t][n],o%=a[t]}return i})).filter(o)})(e,c,n)))}else e=d.list.flatMap((e=>g(e.tokens.map((e=>e))).map((e=>e.join("")))));const r=e.map((e=>((e,t,n)=>{const r=P.diffChars(Jt(e,n),Jt(t,n)).flatMap((e=>{const t=[];if(e.added=!!e.added,e.removed=!!e.removed,e.added||e.removed){const n=[...e.value.matchAll(/[\p{P}\p{Z}]+/gu)].reduce(((n,r)=>(r.index>n&&t.push({added:e.added,removed:e.removed,value:e.value.substring(n,r.index),count:r.index-n}),t.push({added:e.added,removed:e.removed,ignorable:!0,value:r[0],count:r[0].length}),r.index+r[0].length)),0);n>0&&n<e.value.length&&t.push({added:e.added,removed:e.removed,value:e.value.substring(n,e.length),count:e.value.length-n})}return 0===t.length&&t.push(e),t}));if(!r.some((e=>(e.added||e.removed)&&!e.ignorable)))return null;const{result:o}=r.reduce((({result:e,left:t,right:n},r)=>{if(r.added)return r.value=n.substring(0,r.value.length),e.push(r),{result:e,left:t,right:n.substring(r.value.length)};if(r.removed)return r.value=t.substring(0,r.value.length),e.push(r),{result:e,right:n,left:t.substring(r.value.length)};const o=t.substring(0,r.value.length),i=n.substring(0,r.value.length),s=P.diffChars(o,i);return s.forEach((e=>{e.added=!!e.added,e.removed=!!e.removed,(e.added||e.removed)&&(e.ignorable=!0)})),e.push(...s),{result:e,left:t.substring(r.value.length),right:n.substring(r.value.length)}}),{result:[],left:e,right:t});return o})(e,c,t)));if(r.every((e=>i(e)))){const e=((e,t)=>{const n=h(e,t);return void 0===n?n:t(n)})(r,(e=>e.length));m.correctionDiff=h(r.filter((t=>e===t.length)),(e=>p(e,(e=>!e.ignorable&&(e.added||e.removed)&&e.value.length||0))))}}}n(m)}};var en;en=async(e,t,n,r)=>{switch(e){case"get_current_translation_challenge":await(async(e,t,n)=>{if(s(t)&&o(t.statement)&&i(Bt[e])){const r=k(t.statement),i=o(t.userAnswer)?k(t.userAnswer):"";let a=Zt(e,1,(e=>r===e.statement));if(a||(a=Zt(e,3,r.includes((e=>e.statement)))),!s(a))return;const c=getChallengeParsedSolutionList(a,t.listType||z);addSimilarityScoresToSolutionList(c,i),n({...a,solutions:c})}})(Gt(n),t,r);break;case"get_current_listening_challenge":await Yt(Gt(n),t,r);break;case"get_challenge_by_key":case"update_current_challenge_user_reference":await(async(e,t,n)=>{if(s(t)&&o(t.key)&&o(t.userReference)){const r=t.userReference.trim(),o=Zt(e,1,(e=>Wt(e)===t.key));if(s(o)){const e=getChallengeParsedSolutionList(o,t.listType||z);addSimilarityScoresToSolutionList(e,r),n({challenge:{...o,solutions:e},userReference:r})}}})(Gt(n),t,r)}},chrome.runtime.onMessage.addListener(((e,t,n)=>{if(b===e.type){let r=!1;const o=e=>{r=!0,n({type:"success",value:e})},i=e=>{r=!0,n({type:"failure",error:e})};try{Promise.resolve(en(e.action,e.value,t,o,i)).then((()=>{if(!r)throw new Error(`Could not handle action request: "${e.action}".`)})).catch((e=>{r||i(e)}))}catch(e){!r&&i(e)}return!0}})),(e=>{chrome.runtime.onMessage.addListener(((t,n)=>{w===t.type&&e(t.event,t.value,n)}))})((async(e,t,n)=>{switch(e){case"session_loaded":await(async(e,t)=>{if(s(t)){const n=s(t.sessionMetaData)?t.sessionMetaData:{},r=i(t.challenges)?t.challenges:[];await Qt(e,r,String(n.ui_language||n.from_language||t.fromLanguage||"").trim(),String(n.language||n.learning_language||t.learningLanguage||"").trim())}})(Gt(n),t);break;case"sound_played":((e,t)=>{if(o(t)){const n=t.trim();if(""!==n){const t=Zt(e,4,(e=>n===e.ttsMediaUrl||n===e.slowTtsMediaUrl));s(t)&&(Vt[e]=t)}}})(Gt(n),t)}}))}();
